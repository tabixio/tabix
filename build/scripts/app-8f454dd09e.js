"use strict";function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}();/*
 * Licensed under the Apache License, Version 2.0 Copyright 2017 Igor Strykhar,Ivan Kudinov,SMI2 LLC and other contributors
 */
!function(){var e=window.smi2=window.smi2||{};e.app={name:"SMI2",version:window.TabixVersion||"",buildDate:window.TabixBuildDate||""},angular.module(e.app.name,["ngAnimate","ui.router","LocalStorageModule","angularScreenfull","ui.ace","ui.grid","ui.grid.autoResize","ui.grid.resizeColumns","ui.grid.moveColumns","ui.grid.exporter","ui.grid.selection","angularResizable","ngSanitize","ngMaterial","funMetisMenu","ngScrollbars","ngCsv","pascalprecht.translate","cfp.hotkeys","ngHandsontable","gridster","ngCsvImport"])}(),angular.module("SMI2").run(["$templateCache",function(e){e.put("app/base/404.html",'<div class="p++"><h2 class="mt0">404 {{\'не найдено\' | translate}}</h2><md-button class="ml0 md-raised md-primary" ui-sref="dashboard"><i class="mdi mdi-arrow-left"></i> {{ \'Назад\' | translate }}</md-button></div>'),e.put("app/base/base.html",'<div class="wrapper"><header ui-view="header" class="header-view"></header><div class="content"><div ui-view="sidebar" ng-class="{\'show\': showSidebar}" class="sidebar-view" resizable="" r-directions="[\'right\']" r-width="200" r-flex="true"></div><div class="main-content"><div ui-view="main" class="viewmain" style=""></div><div class="md-sidenav-fix"><md-sidenav class="md-sidenav-right md-whiteframe-4dp" md-component-id="tableSiedenav"><md-content ng-if="currentTable" layout-padding=""><md-button class="md-icon-button right-button" ui-sref="table({tableName:currentTable, dbName:currentDatabase})"><i class="mdi mdi-arrow-expand-all"></i><md-tooltip md-direction="left">{{\'Открыть таблицу\' | translate}}</md-tooltip></md-button><div class="h100" ng-include="\'app/table/table-container.html\'" ng-controller="TableContainerController" ng-init="initContainer()"></div></md-content></md-sidenav></div></div></div></div>'),e.put("app/base/breadcrumbs.html",'<ol ng-if="$root.breadcrumbs" class="breadcrumb p+"><li class="home-item"><a ui-sref="dashboard" lx-ripple="lx-ripple" class="btn btn--xs btn--white btn--fab"><i class="mdi mdi-home"></i></a></li><li ng-repeat="nav in $root.breadcrumbs" class="breadcrumb-item"><i class="icon tc-white icon--xs mdi mdi-chevron-right"></i> <a ng-if="!$last" ui-sref="{{nav.link}}(nav.params)" class="btn btn--xs btn--white btn--raised">{{nav.text}}</a> <span ng-if="$last" class="tc-white">{{nav.text}}</span></li></ol>'),e.put("app/base/header.html",'<div class="header"><md-card class="m0 pl0"><div><div class="pull-left" style="width: 210px"><a ui-sref="dashboard"><img src="assets/images/logotabix.png" class="mr logo"></a></div><div class="pull-right top-menu"><md-button aria-label="menu" ui-sref="sql"><i class="mdi mdi-24px mdi-console"></i> SQL</md-button><md-button aria-label="menu" ui-sref="metrics"><i class="mdi mdi-24px mdi-playlist-play"></i> {{\'Метрики и список процессов\' | translate}}</md-button><md-button aria-label="menu" ng-click="help()" style="vertical-align:top"><i class="mdi mdi-24px mdi-help"></i> {{\'Справка\' | translate}}</md-button><md-menu md-position-mode="target-right target"><md-button aria-label="menu" ng-click="$mdOpenMenu($event)"><i class="mdi mdi-24px mdi-theme-light-dark" style="vertical-align:top"></i> {{\'Тема\' | translate}}</md-button><md-menu-content><md-menu-item ng-repeat="theme in themes"><md-button ng-click="setUiTheme(theme)">{{theme.title}}</md-button></md-menu-item></md-menu-content></md-menu><md-button ng-if="!vars.disable_exit" aria-label="{{\'Выход\' | translate}}" ng-click="logout()" style="vertical-align:top"><i class="mdi mdi-24px mdi-lock"></i> {{\'Выход\' | translate}}</md-button><span class="header-user-name hide-sm p+">{{user}}</span></div></div></md-card></div>'),e.put("app/base/helpDialogLogin.html",'<md-dialog aria-label="Mango (Fruit)"><form><md-toolbar><div class="md-toolbar-tools"><h2>Tabix.io {{\'Сборка\' | translate}} {{::vars.version}} [{{::vars.buildDate}}]</h2><span flex=""></span><md-button class="md-icon-button" ng-click="cancel()"><md-icon aria-label="Close dialog"></md-icon></md-button></div></md-toolbar><md-dialog-content style="max-width:800px;max-height:810px;"><md-tabs md-dynamic-height="" md-border-bottom=""><md-tab label="Requirements"><md-content class="md-padding"><p>* Work only in "Google chrome" version up 55</p><p>* Clickhouse server version up v1.1.54164</p><p>* Not readonly CH user</p><p><br></p></md-content></md-tab><md-tab label="Direct connect"><md-content class="md-padding"><p></p><p><br></p></md-content></md-tab><md-tab label="Tabix.Proxy"><md-content class="md-padding"><p></p><p><br></p></md-content></md-tab></md-tabs></md-dialog-content><md-dialog-actions layout="row"><md-button href="https://tabix.io" target="_blank" md-autofocus="">https://tabix.io</md-button><span flex=""></span><md-button ng-click="answer(\'useful\')" style="margin-right:20px;">Ok</md-button></md-dialog-actions></form></md-dialog>'),e.put("app/base/helpDialogRu.html",'<md-dialog aria-label="Mango (Fruit)"><form><md-toolbar><div class="md-toolbar-tools"><h2>Tabix.io {{\'Сборка\' | translate}} {{::vars.version}} [{{::vars.buildDate}}]</h2><span flex=""></span><md-button class="md-icon-button" ng-click="cancel()"><md-icon aria-label="Close dialog"></md-icon></md-button></div></md-toolbar><md-dialog-content style="max-width:800px;max-height:810px;"><md-tabs md-dynamic-height="" md-border-bottom=""><md-tab label="Home"><md-content class="md-padding"><p><a href="https://clickhouse.yandex/reference_ru.html" target="_blank" style="text-decoration: underline">ClickHouse Руководство</a></p><p><br></p><a href="https://tabix.io/doc/" target="_blank" style="text-decoration: underline">Tabix Руководство</a><p></p></md-content></md-tab><md-tab label="Hot keys"><md-content class="md-padding"><h1 class="md-display-2">Hot keys</h1><md-list class="fixedRows"><md-list-item class="md-2-line contact-item"><div class="md-list-item-text compact"><h3>⌘ + Enter</h3><p>Exec current query</p></div></md-list-item><md-list-item class="md-2-line contact-item"><div class="md-list-item-text compact"><h3>⌘ + Shift + Enter</h3><p>Exec all query</p></div></md-list-item><md-list-item class="md-2-line contact-item"><div class="md-list-item-text compact"><h3>⌘ + Y</h3><p>Drop current line</p></div></md-list-item><md-list-item class="md-2-line contact-item"><div class="md-list-item-text compact"><h3>⌘ + ⇧ + F</h3><p>Reformat</p></div></md-list-item><md-list-item class="md-2-line contact-item"><div class="md-list-item-text compact"><h3>⌘ + ⇧ + Plus|Minus</h3><p>свернуть все/развернуть</p></div></md-list-item><md-list-item class="md-2-line contact-item"><div class="md-list-item-text compact"><h3>⌘ + Right|Left</h3><p>переключает вкладки</p></div></md-list-item><md-list-item class="md-2-line contact-item"><div class="md-list-item-text compact"><h3>⌘ + ⌥ + Up|Down</h3><p>Copy lines Up/Down</p></div></md-list-item><md-list-item class="md-2-line contact-item"><div class="md-list-item-text compact"><h3>⌥ + Up|Down</h3><p>Move lines Up/Down</p></div></md-list-item><md-list-item class="md-2-line contact-item"><div class="md-list-item-text compact"><h3>Ctrl + K</h3><p>Remove to line end</p></div></md-list-item><md-list-item class="md-2-line contact-item"><div class="md-list-item-text compact"><h3>⌘ + Backspace</h3><p>Remove to linestart</p></div></md-list-item></md-list><a href="https://github.com/ajaxorg/ace/wiki/Default-Keyboard-Shortcuts" target="_blank" style="text-decoration: underline">Ace Editor Default Keyboard Shortcuts</a></md-content></md-tab><md-tab label="Draw Commands"><md-content class="md-padding"><h3 class="md-display-2">DrawChart</h3><p>DrawChart</p><h3 class="md-display-2">DrawMap</h3><p>DrawMap</p></md-content></md-tab></md-tabs></md-dialog-content><md-dialog-actions layout="row"><md-button href="https://tabix.io" target="_blank" md-autofocus="">https://tabix.io</md-button><span flex=""></span><md-button ng-click="answer(\'useful\')" style="margin-right:20px;">Ok</md-button></md-dialog-actions></form></md-dialog>'),e.put("app/base/sidebar.html",'<div class="sidebar" ng-app="sidebar" ng-scrollbars="" ng-scrollbars-config="vars.scrollConfig"><md-input-container md-no-float="" class="md-block"><input ng-model="vars.searchline" type="text" placeholder="{{\'Поиск\' | translate}}"><md-icon class="mdi mdi-filter-remove" ng-click="vars.searchline=\'\'" style="display:inline-block;"></md-icon></md-input-container><fun-metis-menu ng-if="vars.loaded && !vars.error" fun-metis-config="vars.metis.config" fun-metis-events="vars.metis.events" class="metismenu" id="sideBarMetismenu"><nav><ul><li class="active"><a class="has-arrow"><md-button class="text-left no-txt-transform w200"><i class="mdi mdi-server"></i> Server <span class="pull-right" style="color: silver"></span></md-button></a><ul class="sub-menu"><li ng-repeat="database in vars.databases" ng-class="currentDatabase==database.name?\'active\':\'\'"><a ng-mouseenter=""><md-button class="text-left no-txt-transform w100" ng-dblclick="clickAndSelect(database, $event)"><i class="mdi mdi-database"></i> {{database.name}} <span class="db__table-count">{{database.tables.length}}</span></md-button></a><ul class="sub-menu" ng-if="database.tables.length"><li ng-repeat="table in database.tables"><a class="has-arrow" ng-class="table.active?\'side_tableactive\':\'side_tablenoactive\'"><md-menu mousepoint-menu=""><md-button ng-mouseenter="" class="text-left no-txt-transform" ng-dblclick="openTable(table)" ng-right-click="$mdOpenMousepointMenu($event)"><i ng-if="table.classEngine" class="mdi mdi-{{table.classEngine}}"></i> <i ng-if="!table.classEngine" class="mdi mdi-table"></i> {{table.name}}</md-button><md-menu-content width="4"><md-menu-item ng-repeat="menu in table.rightMenuList | filter: {active: true}"><md-button ng-click="rightMenuProcessTable(menu, $event)"><i class="mdi mdi-{{menu.icon}}"></i> {{menu.value}}</md-button></md-menu-item></md-menu-content></md-menu></a><ul class="sub-menu"><li ng-repeat="field in table.fields" class="text-left no-txt-transform table-fields-sidebar" ng-click="clickInsertField(field)"><pre style="margin: 2px 0px 0px 2px;white-space: nowrap;" ng-class="field.active?\'side_fieldactive\':\'side_fieldnoactive\'">{{field.name}}&nbsp;&nbsp;&nbsp;&nbsp;<i style="color: silver">{{field.type}}</i></pre></li></ul></li></ul></li></ul></li></ul></nav></fun-metis-menu><div ng-if="vars.loaded && vars.error" class="mt+">No connect, or Error or Loadind! See console log</div></div>'),e.put("app/login/login.html",'<div class="wrapper"><div class="header header-view"><md-card class="m0 pl0"><div><div class="mr pull-left"><img src="assets/images/logotabix.png" class="logo"></div><div class="pull-left"><a ui-sref="dashboard" class="tc-white"></a></div><div class="pull-right"><md-button aria-label="menu" ng-click="help()" style="vertical-align:top"><i class="mdi mdi-24px mdi-help"></i> Requirements & help</md-button><md-menu md-position-mode="target-right target"><md-button aria-label="menu" class="md-icon-button" ng-click="$mdOpenMenu($event)"><i class="mdi mdi-24px mdi-theme-light-dark"></i></md-button><md-menu-content><md-menu-item ng-repeat="theme in vars.themes"><md-button ng-click="setUiTheme(theme)">{{theme.title}}</md-button></md-menu-item></md-menu-content></md-menu></div></div></md-card></div><div class="content"><div class="sidebar-view login"><md-card class="m0 h100" style="width: 200px"><div ng-repeat="base in vars.bases"><md-button class="menu-button" ng-click="vars.db = base"><span class="menu-button__title">{{base.name}}</span> <span class="menu-button__subtitle">{{base.host }}</span></md-button></div><div flex="" class="pl"><md-button class="md-raised md-primary m0 width-80" ng-click="add()">Add new</md-button></div></md-card></div><div class="main-content login"><div class="main-view"><div class="login-view"><md-tabs md-dynamic-height="" md-border-bottom="" class="login-tabs"><md-tab><md-tab-label>Direct CH</md-tab-label><md-tab-body><md-card md-theme="{{ showDarkTheme ? \'dark-grey\' : \'default\' }}" md-theme-watch=""><form class="p++" name="loginForm"><div><md-input-container class="md-block" flex-gt-sm=""><label>{{\'Название\' | translate}}</label> <input ng-model="vars.db.name" required="" placeholder="dev" ng-disabled="vars.loading"></md-input-container></div><div><md-input-container class="md-block" flex-gt-sm=""><label>{{\'Хост:порт\' | translate}}</label> <input ng-model="vars.db.host" placeholder="http://127.0.0.1:8123" required="" ng-disabled="vars.loading"></md-input-container></div><div><md-input-container class="md-block" flex-gt-sm=""><label>{{\'Логин\' | translate}}</label> <input ng-model="vars.db.login" ng-disabled="vars.loading"></md-input-container></div><div><md-input-container class="md-block" flex-gt-sm=""><label>{{\'Пароль\' | translate}}</label> <input type="password" ng-model="vars.db.password" ng-click="onKeypress($event)" ng-disabled="vars.loading"></md-input-container></div><div><md-input-container class="md-block" flex-gt-sm=""><label>{{\'Параметры\' | translate}}</label> <input ng-model="vars.db.params" placeholder="key1=value&key2=value" ng-disabled="vars.loading"></md-input-container></div><div layout="row"><div flex=""><md-button class="md-primary md-raised m0 width-100" ng-disabled="loginForm.$invalid || vars.loading" ng-click="login()">{{\'Войти\' | translate}}</md-button></div><div flex="" ng-if="vars.db.id" class="pl"><md-button class="md-raised md-warn m0 width-100" ng-disabled="vars.loading" ng-click="remove()">{{\'Удалить\' | translate}}</md-button></div></div><div layout="row"></div></form></md-card></md-tab-body></md-tab><md-tab><md-tab-label>tabiX.server</md-tab-label><md-tab-body><md-card md-theme="{{ showDarkTheme ? \'dark-grey\' : \'default\' }}" md-theme-watch=""><form class="p++" name="loginServerForm"><div><md-input-container class="md-block" flex-gt-sm=""><label>{{\'Название\' | translate}}</label> <input ng-model="vars.db.name" required="" placeholder="dev" ng-disabled="vars.loading"></md-input-container></div><div><md-input-container class="md-block" flex-gt-sm=""><label>{{\'Сервер\' | translate}}</label> <input ng-model="vars.db.tabix.server" required="" placeholder="https://tabix.dev/s1" ng-disabled="vars.loading"></md-input-container></div><div><md-input-container class="md-block" flex-gt-sm=""><label>{{\'Config Key\' | translate}}</label> <input ng-model="vars.db.tabix.confid" placeholder="empty" ng-disabled="vars.loading"></md-input-container></div><div><md-input-container class="md-block" flex-gt-sm=""><label>{{\'Логин\' | translate}}</label> <input ng-model="vars.db.tabix.login" ng-disabled="vars.loading"></md-input-container></div><div><md-input-container class="md-block" flex-gt-sm=""><label>{{\'Пароль\' | translate}}</label> <input type="password" ng-model="vars.db.tabix.password" ng-click="onKeypress($event)" ng-disabled="vars.loading"></md-input-container></div><div layout="row"><div flex=""><md-button class="md-primary md-raised m0 width-100" ng-disabled="vars.loading" ng-click="login()">{{\'Войти\' | translate}}</md-button></div><div flex="" ng-if="vars.db.id" class="pl"><md-button class="md-raised md-warn m0 width-100" ng-disabled="vars.loading" ng-click="remove()">{{\'Удалить\' | translate}}</md-button></div></div></form></md-card></md-tab-body></md-tab></md-tabs></div></div><div class="footer"><md-card class="m0 p"><div><a href="https://github.com/smi2/" target="_blank" class="pull-right"><i class="mdi mdi-github-circle mdi-24px"></i></a><p class="copyright text-center" style="line-height: 24px"><a href="https://tabix.io/" target="_blank" class="tc-white" style="text-decoration: underline">Tabix.IO</a> from <a href="https://github.com/smi2" target="_blank" style="text-decoration: underline" class="tc-white">{{\'СМИ2\' | translate}}</a> &copy; {{::vars.year}}, {{\'все права защищены\' | translate}}. {{\'Сборка\' | translate}} <b>{{::vars.version}}</b></p></div></md-card></div></div></div></div>'),e.put("app/render/WidgetsList.html",'<div class="row"><div class="col-md-12"><div gridster="gridsterOpts"><ul><li gridster-item="w" ng-repeat="w in widgets"><div class="widget-box"><div class="widget-box-content widget-draggable"><draw-widget style="display: block;" widget="w" ng-if="w.init && !w.error" isdark="vars.isDark" class="widget widget-{{w.type}}" events="events"></draw-widget><div ng-bind-html="w.error" class="grid-monospace" ng-if="w.error"></div><div ng-bind-html="w.text" class="grid-monospace" ng-if="w.text"></div><span ng-if="w.empty">{{\'нет данных\' | translate}}</span></div></div></li></ul></div></div></div>'),e.put("app/metrics/dialog.kill.html",'<md-dialog aria-label="Mango (Fruit)"><form ng-cloak=""><md-toolbar><div class="md-toolbar-tools"><h2>Kill query</h2><span flex=""></span><md-button class="md-icon-button" ng-click="cancel()"><md-icon aria-label="Close dialog"></md-icon></md-button></div></md-toolbar><md-dialog-content><div class="md-dialog-content"><md-list flex=""><md-subheader class="md-no-sticky"></md-subheader><md-list-item class="md-3-line" ng-repeat="q in queryesToKill" ng-click="kill(q)"><div class="md-list-item-text" layout="column"><h3>{{ q.elapsed }}</h3><b>{{ q.query }}</b><p>{{ q.bytes_read }}</p><p>{{ q.hash }}</p></div></md-list-item></md-list></div></md-dialog-content><md-dialog-actions layout="row"><span flex=""></span><md-button ng-click="cancel()">Cancel</md-button></md-dialog-actions></form></md-dialog>'),e.put("app/metrics/metrics.html",'<md-tabs class="md-tabs-fix" md-stretch-tabs="yes" md-border-bottom="" md-autoselect="" layout-fill="" md-selected="vars.selectedTabResultIndex" style="width: 100%;height: 100%"><md-tab md-on-select="initProcessesTab()" layout-fill=""><md-tab-label>{{\'Список процессов\' | translate}} <i class="mdi mdi-18px mdi-palette-advanced"></i></md-tab-label><md-tab-body><div flex="" layout-fill="" ng-include="\'app/metrics/processes.html\'" ng-if="vars.active.Processes"></div></md-tab-body></md-tab><md-tab md-on-select="initOverviewTab()" ng-click="initOverviewTab()" layout-fill=""><md-tab-label>{{\'Обзор\' | translate}} <i class="mdi mdi-18px mdi-table-large"></i></md-tab-label><md-tab-body><div ng-include="\'app/metrics/overview.html\'" ng-if="vars.active.Overview"></div></md-tab-body></md-tab><md-tab md-on-select="initChartTab()" layout-fill=""><md-tab-label>{{\'Метрики\' | translate}} <i class="mdi mdi-18px mdi-chart-bar"></i></md-tab-label><md-tab-body><div flex="" layout-fill="" ng-include="\'app/metrics/metricschart.html\'" ng-if="vars.active.Chart"></div></md-tab-body></md-tab></md-tabs>'),e.put("app/metrics/metricschart.html",'<div ng-controller="MetricschartController as render" style="width: 100%;height: 100%"><h1 class="md-title">{{\'Метрики\' | translate}}</h1><md-card-content><div layout="row"><md-input-container class="md-block" flex-gt-sm=""><label>{{\'Частота обновления\' | translate}}</label><md-select ng-model="vars.interval" ng-change="setInterval()"><md-option ng-repeat="interval in [-1, 1, 5, 10, 20, 30]" ng-value="interval">{{interval == -1 ? (\'Обновление отключено\'|translate) : interval +\' \'+(\'сек\'|translate)}}</md-option></md-select></md-input-container><md-input-container class="md-block" flex-gt-sm=""><label>{{\'Максимально точек\' | translate}}</label><md-select ng-model="maxlength" ng-change="setMaxlength()"><md-option ng-repeat="interval in [50, 100, 500, 1500,3600,5000,10000]" ng-value="interval">{{interval}}</md-option></md-select></md-input-container><md-input-container class="md-block" flex-gt-sm=""><md-switch class="md-primary" name="special" ng-model="vars.logEvents">system.events</md-switch></md-input-container><md-input-container class="md-block" flex-gt-sm="" ng-click="load()"><md-button class="md-raised md-primary">{{\'Обновить\' | translate}}</md-button></md-input-container><md-input-container class="md-block" flex-gt-sm="" ng-click="flush()"><md-button class="md-raised">{{\'Очистить\' | translate}}</md-button></md-input-container></div></md-card-content><md-card-content><div style="width: 100%;height: 100%"><div id="metrcisChart" style="width: 100%;height: 100%"></div></div></md-card-content></div>'),e.put("app/metrics/overview.html",'<h1 class="md-title">{{\'Обзор\' | translate}}</h1><div ng-controller="OverviewController as render"><div class="row"><div class="col-md-12"><div gridster="gridsterOpts"><ul><li gridster-item="w" ng-repeat="w in widgets"><div class="widget-box"><div class="widget-box-content widget-draggable"><draw-widget style="display: block;" widget="w" ng-if="w.init && !w.error" isdark="vars.isDark" class="widget widget-{{w.type}}" events="events"></draw-widget><div ng-bind-html="w.error" class="font-monospace" ng-if="w.error"></div><div ng-bind-html="w.text" class="font-monospace" ng-if="w.text"></div><span ng-if="w.empty">{{\'нет данных\' | translate}}</span></div></div></li></ul></div></div></div></div>'),e.put("app/metrics/processes.html",'<div ng-controller="ProcessesController as render" style="width: 100%;height: 100%"><h1 class="md-title">{{\'Список процессов\' | translate}}</h1><md-card-content><div layout="row"><md-input-container class="md-block" flex-gt-sm=""><label>{{\'Частота обновления\' | translate}}</label><md-select ng-model="vars.interval" ng-change="setInterval()"><md-option ng-repeat="interval in [-1, 0.2 , 0.5, 1, 5, 10, 20, 30]" ng-value="interval">{{interval == -1 ? (\'Обновление отключено\'|translate) : interval +\' \'+(\'сек\'|translate)}}</md-option></md-select></md-input-container><md-input-container class="md-block" flex-gt-sm=""><md-switch class="md-primary" name="special" ng-model="table.wordWrap">{{\'Перенос строк\' | translate}}</md-switch></md-input-container><md-input-container class="md-block" flex-gt-sm=""><md-switch class="md-primary" name="special" ng-model="vars.logMode">{{\'Логирование\' | translate}}</md-switch></md-input-container><md-input-container class="md-block" flex-gt-sm=""><md-switch class="md-primary" name="special" ng-model="vars.clusterMode">Cluster</md-switch></md-input-container><md-input-container class="md-block" flex-gt-sm="" ng-click="load()"><md-button class="md-raised md-primary">{{\'Обновить\' | translate}}</md-button></md-input-container><md-input-container class="md-block" flex-gt-sm="" ng-click="flush()"><md-button class="md-raised">{{\'Очистить\' | translate}}</md-button></md-input-container><md-input-container class="md-block" flex-gt-sm="" ng-click="dialogKill()"><md-button class="md-raised md-warn">KILL Query</md-button></md-input-container></div><div layout="row"><md-progress-circular ng-if="vars.loading" class="md-accent" md-diameter="40"></md-progress-circular><hot-table ng-class="{\'handsontable-dark\': vars.isDark}" hot-id="hotTableProcesses" word-wrap="table.wordWrap" settings="table.settings" datarows="table.data" style="width: 100%;height: 100%;" col-headers="table.colHeaders" manual-column-resize="true" class="font-monospace"></hot-table></div></md-card-content></div><md-card-content></md-card-content>'),e.put("app/sql/renderResult.html",'<div ng-controller="RenderCtrl as render"><md-tab ng-repeat="resultContainer in tab.results" md-dynamic1-height="" md-border-bottom="" class="h100"><md-tab-label>{{::resultContainer.time}} <i class="mdi mdi-18px ml+" ng-class="resultContainer.pinned ? \'mdi-pin\' : \'mdi-pin-off\'" ng-click="resultContainer.pinned = !resultContainer.pinned; $event.stopPropagation()"></i> <i class="mdi mdi-close" ng-click="removeResult(tab, resultContainer, $event)"></i></md-tab-label><md-tab-body><div style="position: absolute; top: 4px; right: 4px; z-index: 2"><md-menu md-position-mode="target" ng-repeat="tableData in resultContainer.widgets.tables" ng-if="tableData.data.progressQuery"><md-button aria-label="menu" class="md-icon-button" ng-click="$mdOpenMenu($event)"><md-tooltip>{{tableData.data.progressQuery}}</md-tooltip><i class="mdi mdi-file-excel"></i></md-button><md-menu-content><md-menu-item><md-button ng-csv="getExportData(tableData)" quote-strings=\'"\' filename="{{tab.name}}-{{result.time}}.csv" csv-header="getExportHeaders(tableData)">{{\'CSV с заголовком\' | translate}}</md-button></md-menu-item><md-menu-item><md-button ng-csv="getExportData(tableData)" quote-strings=\'"\' filename="{{tab.name}}-{{result.time}}.csv">{{\'CSV без заголовка\' | translate}}</md-button></md-menu-item><md-menu-item><md-button ng-csv="getExportData(tableData)" quote-strings="" filename="{{tab.name}}-{{result.time}}.txt" field-separator="\\t" csv-header="getExportHeaders(tableData)">{{\'Табулированный текст с заголовками\' | translate}}</md-button></md-menu-item><md-menu-item><md-button ng-csv="getExportData(tableData)" quote-strings="" filename="{{tab.name}}-{{result.time}}.txt" field-separator="\\t" csv-header="getExportHeaders(tableData)">{{\'Табулированный текст без заголовков\' | translate}}</md-button></md-menu-item></md-menu-content></md-menu><md-button aria-label="menu" class="md-icon-button"><i class="mdi mdi-18px mdi-upload" ng-click="showDialogUpload(resultContainer.widgets)"></i><md-tooltip>Upload CSV</md-tooltip></md-button><md-button aria-label="menu" class="md-icon-button"><i class="mdi mdi-18px" ng-class="vars.staticGrid ? \'mdi-pin\' : \'mdi-pin-off\'" ng-click="switchStaticGrid()"></i><md-tooltip>{{\'Привязка\' | translate}}</md-tooltip></md-button></div><div ng-if="!tabsRender" ng-init="initNoTabs()"><div ng-init="widgets = resultContainer.widgets.tables" ng-include="\'app/render/WidgetsList.html\'" ng-if="vars.active.table"></div><div ng-init="widgets = resultContainer.widgets.draw" ng-include="\'app/render/WidgetsList.html\'" ng-if="vars.active.draw"></div></div><md-tabs ng-if="tabsRender" md-dynamic-height="" md-border-bottom="" md-autoselect="" md-selected="tab.selectedTabResultIndex"><md-tab md-on-select="initTableTab()" ng-click="vars.active.table=true"><md-tab-label>Table <i class="mdi mdi-18px mdi-table-large"></i></md-tab-label><md-tab-body><div ng-init="widgets = resultContainer.widgets.tables" ng-include="\'app/render/WidgetsList.html\'" ng-if="vars.active.table"></div></md-tab-body></md-tab><md-tab md-on-select="vars.active.draw=true"><md-tab-label>Draw <i class="mdi mdi-18px mdi-chart-bar"></i></md-tab-label><md-tab-body><div ng-init="widgets = resultContainer.widgets.draw" ng-include="\'app/render/WidgetsList.html\'" ng-if="vars.active.draw"></div></md-tab-body></md-tab><md-tab md-on-select="vars.active.pivot=true"><md-tab-label>Pivot <i class="mdi mdi-18px mdi-palette-advanced"></i></md-tab-label><md-tab-body><div ng-init="widgets = resultContainer.widgets.pivot" ng-include="\'app/render/WidgetsList.html\'" ng-if="vars.active.pivot"></div></md-tab-body></md-tab><md-tab md-on-select="vars.active.stats=true"><md-tab-label>Stats <i class="mdi mdi-18px mdi-school"></i></md-tab-label><md-tab-body><div ng-init="widgets = resultContainer.widgets.stats" ng-include="\'app/render/WidgetsList.html\'" ng-if="vars.active.stats"></div></md-tab-body></md-tab></md-tabs></md-tab-body></md-tab></div>'),e.put("app/sql/showDialogUpload.html",'<style>\n    ng-csv-import, .ng-csv-import {\n        display: inline-block;\n        position: relative;\n        padding: 2px;\n        margin: 0;\n        vertical-align: middle;\n    }\n    s\n</style><md-dialog aria-label="Mango (Fruit)"><form ng-cloak=""><md-toolbar><div class="md-toolbar-tools"><h2>Upload CSV to View</h2><span flex=""></span><md-button class="md-icon-button" ng-click="cancel()"><md-icon aria-label="Close dialog"></md-icon></md-button></div></md-toolbar><md-dialog-content><div class="md-dialog-content" style="width: 300px;height: 300px"><div style="border: 1px dotted silver" class="ng-csv-import"><ng-csv-import content="vars.UploadCsv.content" material="" md-button-class="md-icon-button mdi mdi-file-excel" header="vars.UploadCsv.header" header-visible="vars.UploadCsv.headerVisible" separator="vars.UploadCsv.separator" encoding-visible="vars.UploadCsv.encodingVisible" separator-visible="vars.UploadCsv.separatorVisible" result="vars.UploadCsv.result" callback="callback" mdbuttontitle="Upload" accept="vars.UploadCsv.accept"></ng-csv-import></div></div></md-dialog-content></form></md-dialog>'),e.put("app/sql/sql.html",'<div style="position: absolute; top: 4px; right: 4px; z-index: 2"><md-button aria-label="menu" class="md-icon-button" ng-click="toggleSidenav(\'right\')"><i class="mdi mdi-settings"></i><md-tooltip>{{\'Настройки редактора\' | translate}}</md-tooltip></md-button></div><div ngsf-fullscreen="fullscreenCtrl" class="fullscreen md-tabs-fix" ng-class="vars.uiTheme.name"><md-tabs md-dynamic-height="" md-border-bottom="" md-selected="vars.selectedTab" class="sql-tabs"><md-tab ng-repeat="tab in vars.tabs" ng-click="vars.currentTab = tab"><md-tab-label>{{tab.name + (tab.changed ? \' *\' : \'\')}} <i class="mdi mdi-pencil ml+" ng-click="changeTabName(tab, $event)" style="cursor: pointer"></i> <i class="mdi mdi-close" ng-click="removeTab(tab, $event)" style="cursor: pointer"></i></md-tab-label><md-tab-body><div style="display: table; width: 100%;"><div style="min-height: 100px; position: relative; display: table-cell;"><div resizable="" r-directions="[\'bottom\']" r-height="300" style=""><md-menu mousepoint-menu=""><div ng-model="tab.sql" ng-right-click="$mdOpenMousepointMenu($event)" ui-ace="{ useWrapMode : true, mode: \'clickhouse\', onLoad: aceLoaded, advanced: { enableBasicAutocompletion: true } }" style="width: 100%; height: 100%;" ng-mouseenter=""></div><md-menu-content id="menu" width="4"><md-menu-item ng-repeat="menu in rightAceMenuList | filter: {active: true}"><md-button ng-click="rightMenuProcess(menu, $event)"><i class="mdi mdi-{{menu.icon}}"></i> {{menu.value}}</md-button></md-menu-item><md-menu-divider></md-menu-divider></md-menu-content></md-menu></div><md-button class="md-raised1 md-primary" ng-disabled="tab.loading" ng-click="execute(\'all\', tab)">{{tab.buttonTitle}}</md-button><md-button class="md-icon-button" ng-click="fullscreenCtrl.toggleFullscreen()" aria-label="fullscreen"><i class="mdi mdi-fullscreen"></i><md-tooltip>{{\'На весь экран\' | translate}}</md-tooltip></md-button><md-button class="md-icon-button" ng-click="save(tab, $event)" show-if-fullscreen="false" aria-label="save"><i class="mdi mdi-content-save"></i><md-tooltip>{{\'Сохранить\' | translate}}</md-tooltip></md-button><md-menu md-position-mode="target-right target" ng-if="vars.sqlHistory.length" show-if-fullscreen="false"><md-button aria-label="menu" class="md-icon-button" ng-click="$mdOpenMenu($event)"><i class="mdi mdi-history"></i></md-button><md-menu-content width="4"><md-menu-item ng-repeat="item in vars.sqlHistory track by $index" ng-click="load(item)"><md-button>{{item.name}}<md-tooltip>{{\'История зарпросов\' | translate}}</md-tooltip><div class="pull-right"><i class="mdi mdi-close ml+" ng-click="removeHistory(item, $event)"></i></div></md-button></md-menu-item></md-menu-content></md-menu><md-button class="md-icon-button" ng-click="toggleSidenav(\'log\')" show-if-fullscreen="false" aria-label="log"><i class="mdi mdi-view-headline"></i><md-tooltip>{{\'Лог запросов\' | translate}}</md-tooltip></md-button><md-input-container><md-select ng-model="vars.db" placeholder="Select database"><md-optgroup label="Database"><md-option ng-value="dbb" ng-repeat="dbb in vars.databasesList track by $index" ng-click="selectDatabase(dbb)">USE {{dbb}}</md-option></md-optgroup></md-select></md-input-container><small class="pull-right" ng-if="vars.LastStatistics" style="color: silver;padding-top: 20px">{{vars.LastStatistics.elapsed| number:2}} sec.| {{vars.LastStatistics.rows_read| number}} rows.| {{vars.LastStatistics.bytes_read|filesize}}</small><div ng-if="tab.loading" style="display: table; width: 100%;"><md-progress-linear md-mode="indeterminate">{{tab.progress.query}}</md-progress-linear><i style="font-size: 70%">..... {{tab.progress.query}}</i></div></div></div><md-tabs md-dynamic-height="" md-border-bottom="" ng-if="tab.results.length" md-selected="tab.selectedResultTab"><span ng-include="\'app/sql/renderResult.html\'"></span></md-tabs></md-tab-body></md-tab><md-tab ng-click="addTab()"><md-tab-label><i class="mdi mdi-plus-circle"></i></md-tab-label></md-tab></md-tabs></div><md-sidenav class="md-sidenav-right md-whiteframe-4dp" md-component-id="right"><div class="p+"><h4 class="mt0 mb+++">{{\'Настройки редактора\' | translate}}</h4><md-input-container class="width-100"><label for="inp1">{{\'Размер шрифта\' | translate}}</label> <input type="text" id="inp1" ng-model="vars.fontSize"></md-input-container><md-input-container class="width-100"><label for="inp2">{{\'Максимум строк\' | translate}}</label> <input type="text" id="inp2" ng-model="vars.limitRows"></md-input-container><md-input-container class="width-100 mt mb++"><label>{{\'Формат результатов\' | translate}}</label><md-select ng-model="vars.format"><md-option ng-repeat="format in vars.formats" ng-value="format" ng-click="vars.format = format">{{format.name}}</md-option></md-select></md-input-container><md-input-container class="width-100 mb++"><label>{{\'Тема редактора\' | translate}}</label><md-select ng-model="vars.theme"><md-option ng-repeat="theme in vars.themes" ng-value="theme" ng-click="setTheme(theme)">{{theme}}</md-option></md-select></md-input-container><md-input-container class="width-100 mt mb+"><label>{{\'Тема интерфейса\' | translate}}</label><md-select ng-model="vars.uiTheme"><md-option ng-repeat="theme in vars.uiThemes" ng-value="theme" ng-click="setUiTheme(theme)">{{theme.title}}</md-option></md-select></md-input-container><md-input-container class="width-100 mt"><md-checkbox ng-model="vars.saveTabs" aria-label="saveTabs">{{\'Сохранять сессию\' | translate}}</md-checkbox></md-input-container><md-input-container class="width-100 mt"><md-checkbox ng-model="vars.enableLiveAutocompletion" aria-label="LiveAutocompletion">Live Autocompletion</md-checkbox></md-input-container><md-input-container class="width-100 mt"><md-checkbox ng-click="setDisableAutoHelp()" ng-model="vars.disableAutohelp" aria-label="LiveAutocompletion">Disable auto-help</md-checkbox></md-input-container><md-input-container class="width-100 mt"><md-checkbox ng-model="vars.disableHotKeyCmdLeft" aria-label="Disable hotKey left+right">Disable hotKey left+right</md-checkbox></md-input-container><md-input-container class="width-100 mt mb+"><label>{{\'Разделитель запросов\' | translate }}</label><md-select ng-model="vars.delimiter"><md-option ng-repeat="delimiter in vars.delimiters" ng-value="delimiter.delimiter" ng-click="vars.delimiter = delimiter">{{delimiter.name}}</md-option></md-select></md-input-container><md-button ng-click="toggleSidenav(\'right\')" class="md-primary ml0 mt+++" style="line-height: inherit;">{{\'Закрыть\' | translate}}</md-button></div></md-sidenav><md-sidenav class="md-sidenav-right md-whiteframe-4dp" md-component-id="log"><div class="p+"><h4 class="mt0"><md-button class="md-icon-button pull-right" ng-click="toggleSidenav(\'log\')" aria-label="close" style="margin-top: -10px; margin-right: -10px"><i class="mdi mdi-close"></i><md-tooltip>{{\'Сохранить\' | translate}}</md-tooltip></md-button>{{\'Лог запросов\' | translate}}</h4></div><div><md-input-container><label>{{\'Искать на сервере\' | translate}}</label> <input ng-model="vars.searchQueryOnServer"></md-input-container><md-button md-no-ink="" class="md-primary" ng-click="searchSqlLogServer()">Search</md-button></div><div><hr><div ng-repeat="sql in vars.sqlLogServer" md-ink-ripple="" style="position: relative; cursor: pointer; border-bottom: 1px rgba(120, 120, 120, 0.2) solid;" class="p pl+" ng-click="setSql(sql)"><pre class="p0 m0" style="font-size:10px;max-height: 88px; line-height: 16px; overflow: hidden; text-overflow: ellipsis">{{::sql}}</pre></div></div><div ng-repeat="sql in vars.sqlLog" md-ink-ripple="" style="position: relative; cursor: pointer; border-bottom: 1px rgba(120, 120, 120, 0.2) solid;" class="p pl+" ng-click="setSql(sql)"><pre class="p0 m0" style="max-height: 48px; line-height: 16px; overflow: hidden; text-overflow: ellipsis">{{::sql}}</pre></div><small class="p+" ng-if="vars.sqlLog.length === 0">{{\'История запросов пуста\' | translate}}</small></md-sidenav>'),
e.put("app/table/table-container.html",'<div style="position: absolute;top: 0px;bottom: 59px;left: 16px;right: 16px;z-index: 1" class="md-tabs-fix"><h3>{{vars.currentDatabase}} <i class="mdi mdi-chevron-right"></i> {{vars.currentTable}}</h3><md-tabs md-dynamic1-height="" md-border-bottom="" class="h100"><md-tab><md-tab-label><i class="mdi mdi-table-column-plus-after mr-"></i>{{\'Структура\' | translate}}</md-tab-label><md-tab-body><table class="data-table" style="font-size: 80%"><thead><tr class="text-left"><th style="width: 40px"></th><th style="width: 40%">{{\'Название\' | translate}}</th><th style="width: 10%">{{\'Тип\' | translate}}</th><th style="width: 10%">{{\'Default тип\' | translate}}</th><th style="width: 10%">{{\'Значение\' | translate}}</th><th style="width: 10%">{{\'Размер\' | translate}}</th><th style="width: 10%">Compress</th></tr></thead><tbody><tr class="text-left" ng-repeat="field in vars.columns.data"><td class="tc-grey-400">{{$index + 1}}</td><td ng-repeat="key in [\'name\', \'type\', \'default_type\', \'default_expression\',\'size\',\'ratio\'] track by $index">{{field[key]}}</td></tr></tbody></table></md-tab-body></md-tab><md-tab><md-tab-label><i class="mdi mdi-information mr-"></i>{{\'Информация\' | translate}}</md-tab-label><md-tab-body><div class="data-table-container" style="overflow:hidden;"><table class="data-table"><tbody><tr class="data-table-row"><td class="tc-grey-400" style="width: 40px">1</td><td style="width: 200px">{{\'Размер\' | translate}}</td><td>{{vars.statistics.size}}</td></tr><tr class="data-table-row"><td class="tc-grey-400">2</td><td>{{\'Размер, байт\' | translate}}</td><td>{{vars.statistics.sizeBytes}}</td></tr><tr class="data-table-row"><td class="tc-grey-400">3</td><td>{{\'Первая запись\' | translate}}</td><td>{{vars.statistics.minDate}}</td></tr><tr class="data-table-row"><td class="tc-grey-400">4</td><td>{{\'Последняя запись\' | translate}}</td><td>{{vars.statistics.maxDate}}</td></tr></tbody></table><br><b>SHOW CREATE TABLE</b><br><pre>{{vars.createtable}}</pre></div></md-tab-body></md-tab><md-tab md-active="true"><md-tab-label><i class="mdi mdi-table-large mr-"></i>{{\'Данные\' | translate}}</md-tab-label><md-tab-body><div style="display:table"></div><div class="pl+ pt+ pb+ pr" style="font-size: .75rem;max-height:100%"><div class="float-right" style="margin-top: -12px"><md-button class="md-icon-button" aria-label="load prev" ng-click="loadPrev()" ng-disabled="vars.offset === 0"><i class="mdi mdi-arrow-left"></i></md-button><md-button class="md-icon-button" aria-label="load next" ng-click="loadNext()"><i class="mdi mdi-arrow-right"></i></md-button></div>{{\'Данные\' | translate}} <span class="tc-grey-400">{{\'с\' | translate}} {{vars.offset}} {{\'по\' | translate}} {{vars.offset + vars.limit}}</span></div><div class="card__actions p+" style="position:absolute; top:46px; bottom:0;left:0;right:0; overflow:hidden;"><span ng-if="vars.data === null&&!vars.loading" class="fs-caption">{{\'нет данных\' | translate}}</span><md-progress-circular ng-if="vars.loading" class="md-accent" md-diameter="40"></md-progress-circular><hot-table ng-class="{\'handsontable-dark\': vars.isDark}" hot-id="hotTableContain" settings="table.settings" datarows="table.data" style="width: 99%;height: 99%" col-headers="table.colHeaders" manual-column-resize="true"></hot-table></div></md-tab-body></md-tab></md-tabs></div>'),e.put("app/table/table.html",'<div ng-controller="TableContainerController" ng-include="\'app/table/table-container.html\'" ng-init="initOnGo()"></div>')}]),function(e,t){function r(e,t){var r=t.dbName,a=t.tableName;e.vars={dbName:r,tableName:a}}e.module(t.app.name).controller("TableController",r),r.$inject=["$scope","$stateParams"]}(angular,smi2),function(e,t){function r(t,r,a,n,i,o,s,l){t.vars={columns:{},ugrid:{},sortColumn:!1,isDark:n.isDark(),createtable:{},data:null,grid:null,limit:100,offset:0,statistics:{},loading:!0,isRawStatistics:!1,rawstatistics:"",scrollConfig:{autoHideScrollbar:!1,theme:n.isDark()?"light":"dark",scrollButtons:{enable:!1},scrollInertia:100,advanced:{updateOnContentResize:!0}}},t.initContainer=function(){r.$watch("currentTable",function(e){e&&(t.vars.currentTable=r.currentTable,t.vars.currentDatabase=r.currentDatabase,t.init())})},t.onAfterInit=function(){},t.updateHandTable=function(){l.getInstance("hotTableContain").render()},t.initOnGo=function(){t.$parent.vars&&(s.get("tableSiedenav")&&o("tableSiedenav").close(),t.vars.currentTable=t.$parent.vars.tableName,t.vars.currentDatabase=t.$parent.vars.dbName,t.init())},t.initTableSettings=function(){t.table={colHeaders:{},data:{},settings:{manualColumnMove:!0,manualColumnResize:!0,autoWrapRow:!1,wordWrap:!1,colWidths:70,stretchH:"all",preventOverflow:"horizontal",persistentState:!0,columnSorting:!0,sortIndicator:!0,manualRowResize:!0,viewportColumnRenderingOffset:"auto",autoColumnSize:{samplingRatio:23}}}},t.load=function(){t.vars.data=-1,a.query("\n            select * from "+t.vars.currentDatabase+"."+t.vars.currentTable+" limit "+t.vars.offset+", "+t.vars.limit+"\n                ").then(function(e){var r=a.dataToHandsontable(e);t.table.colHeaders=r.colHeaders,t.table.settings.columns=r.columns,t.table.settings.manualColumnResize=r.columns,t.table.data=r.data,t.table.settings.width="99.9"+Math.floor(100*Math.random())+"%",t.table.settings.height="99.9"+Math.floor(100*Math.random())+"%",t.updateHandTable(),t.vars.loading=!1},function(e){t.vars.loading=!1,console.error("Ошибка "+e)})},t.calcRawSize=function(){t.vars.isRawStatistics=!0,a.query("SELECT any(ignore(*)) FROM "+t.vars.currentDatabase+"."+t.vars.currentTable+" SAMPLE 1 / 10000 ").then(function(e){t.vars.rawstatistics=e.statistics},function(e){t.vars.rawstatistics=e.data})},t.init=function(){t.vars.loading=!0,t.initTableSettings(),t.vars.createtable="N/A",a.query("SHOW CREATE TABLE "+t.vars.currentDatabase+"."+t.vars.currentTable).then(function(e){t.vars.createtable=window.sqlFormatter.format(e.data[0].statement)}),a.query("SELECT 	table, 	formatReadableSize(sum(bytes)) as size, 	sum(bytes) as sizeBytes, 	min(min_date) as minDate, 	max(max_date) as maxDate FROM  	system.parts WHERE 	database = '"+t.vars.currentDatabase+"' AND 	( 		table = '"+t.vars.currentTable+"' OR 		table = '"+t.vars.currentTable+"_sharded'    ) GROUP BY     table ").then(function(e){return t.vars.statistics=e&&e.data.length&&e.data[0]||{}}),a.query("SELECT * FROM system.columns WHERE database='"+t.vars.currentDatabase+"' AND table='"+t.vars.currentTable+"'").then(function(r){a.query("describe table "+t.vars.currentDatabase+"."+t.vars.currentTable).then(function(a){_.map(a.data,function(t){var a=_.find(r.data,{name:t.name});return _.merge(t,a),t.size="-",t.ratio="-",!e.isUndefined(t.default_kind)&&e.isUndefined(t.default_type)&&(t.default_type=t.default_kind),t.data_compressed_bytes&&(t.size=numbro(t.data_compressed_bytes).format("0.0 b")+" / "+numbro(t.data_uncompressed_bytes).format("0.0 b"),t.ratio=numbro(parseInt(t.data_uncompressed_bytes)/parseInt(t.data_compressed_bytes)).format("0.0")),t}),t.vars.columns=a,t.vars.sortColumn=!1;var n=0;a.data.forEach(function(e){3>n&&("Date"==e.type&&(t.vars.sortColumn=e.name),"DateTime"==e.type&&(t.vars.sortColumn=e.name)),n+=1}),t.load()})})},t.loadNext=function(){t.vars.offset+=t.vars.limit,t.load()},t.loadPrev=function(){t.vars.offset>0&&(t.vars.offset-=t.vars.limit,t.load())}}e.module(t.app.name).controller("TableContainerController",r),r.$inject=["$scope","$rootScope","API","ThemeService","$stateParams","$mdSidenav","$mdComponentRegistry","hotRegisterer"]}(angular,smi2),/*
 * Licensed under the Apache License, Version 2.0 Copyright 2017 Igor Strykhar,Ivan Kudinov,SMI2 LLC and other contributors
 */
window.global_keywords_fields="",window.global_keywords_tables="",window.global_keywords_fieldsList="",window.global_keywords_dictList="",window.global_builtinFunctions=[],window.global_delimiter=";;",window.global_lang="ru",function(e,t){function r(t,r,a,n,i,o,s,l,c,d,u,m,b){var h="sqlHistory2",p="sqlLog",g="saveTabs",f="DISABLE_HOTKEY_LEFTRIGHT",v="DISABLE_AUTOHELP",y="liveAutocompletion",w="sessionData",x=30;t.vars={sqlHistory:n.get(h)||[],dictionaries:[],isDictionariesLoad:!1,tabs:[],enableLiveAutocompletion:n.get(y)||!1,disableAutohelp:n.get(v)||!1,disableHotKeyCmdLeft:n.get(f)||!0,saveTabs:n.get(g)||!1,uiTheme:c.themeObject,uiThemes:c.list,LastStatistics:!1,delimiters:[{name:u("translate")(";; Двойной"),delimiter:";;"},{name:u("translate")("; Одинарный"),delimiter:";"}],databasesList:[],searchQueryOnServer:"",currentTab:{},selectedTab:0,sqlLog:n.get(p)||[],sqlLogServer:[],formats:[{name:u("translate")("Таблица"),sql:" format JSON",render:"html"},{name:"JSON compact",sql:" format JSONCompact"}],db:null,limitRows:n.get("editorLimitRows")||500,fontSize:n.get("editorFontSize")||16,theme:n.get("editorTheme")||"cobalt"},t.vars.delimiter=n.get("delimiter")||";;",t.vars.format=t.vars.formats[0],t.vars.themes=["ambiance","eclipse","mono_industrial","tomorrow_night_blue","chaos","github","monokai","tomorrow_night_bright","chrome","idle_fingers","pastel_on_dark","tomorrow_night_eighties","clouds","iplastic","solarized_dark","tomorrow_night","clouds_midnight","katzenmilch","solarized_light","twilight","cobalt","kr_theme","sqlserver","vibrant_ink","crimson_editor","kuroir","terminal","xcode","dawn","merbivore","textmate","dreamweaver","merbivore_soft","tomorrow"],r.breadcrumbs=[{text:"SQL",link:"sql"}],a.onbeforeunload=function(e){if(""!==t.vars.currentTab.sql&&"localhost"!=location.hostname){var r=u("translate")("Хотите покинуть страницу?");return"undefined"==typeof e&&(e=window.event),e&&(e.returnValue=r),r}};var k=t.$on("$stateChangeStart",function(e){var r=u("translate")("Хотите покинуть страницу?");e.defaultPrevented||""===t.vars.currentTab||confirm(r)||e.preventDefault()}),S=function(){if(t.vars.saveTabs){var e=t.vars.tabs.map(function(e){return{name:e.name,sql:e.sql,buttonTitle:e.buttonTitle,format:e.format,delimiter:e.delimiter,results:[],editor:null,selectedResultTab:0}});n.set(w,e)}};t.executeQuery=function(r,a,n){var o="";t.vars.currentTab.loading=!0,t.vars.limitRows&&(o+="max_result_rows="+t.vars.limitRows+"&result_overflow_mode=throw");var s=r.sql.replace(/(\r\n|\n|\r)$/gm,"").substr(0,130);t.vars.currentTab.progress.query=s;var d="";r.qid&&(d=" /*TABIX_QUERY_ID_"+r.qid+"*/ "),i.query(d+r.sql,r.format,!0,o).then(function(i){var o=i;e.isObject(i)||(i={data:o,meta:null,rows:null,statistics:null}),i.error=!1,i.query=r,i.countAllQuery=a.length;var l={time:moment().format("HH:mm:ss")};e.isObject(i.statistics)&&Object.assign(l,i.statistics),l.query=s,t.vars.currentTab.statistics.push(l),t.vars.LastStatistics=l;var c="ch",d=new DataProvider(i,c);d.progressQuery=s,n.widgets.tables.push(new WidgetTable(d)),n.widgets.pivot.push(new WidgetPivot(d)),"drawCommand"in r&&r.drawCommand.length?(d.countAll=r.drawCommand.length,r.drawCommand.forEach(function(e){n.widgets.draw.push(new WidgetDraw(d,e))})):n.widgets.draw.push(new WidgetDraw(d,!1)),n.data.push(r),r.index+1<a.length?t.executeQuery(a[r.index+1],a,n):t.finalizeResult(n)},function(a){l.show(l.simple().content("ERROR").theme(c.theme).position("bottom right")),t.vars.currentTab.loading=!1,t.vars.currentTab.progress=!1;var i={meta:null,rows:null,error:"Some error - N/A",query:r,statistics:null};a&&a.data?i.error=e.toJson(a.data).replace(/^"/,"").replace(/"$/,""):i.error="Status:"+a.status+"\nText:"+a.statusText;var o="ch";console.warn("ERROR",i);var s=new DataProvider(i,o);n.data.push(r),n.widgets.tables.push(new WidgetTable(s)),t.finalizeResult(n)})},t.renderResult=function(t){return t.echarts=!1,t.pivot=!1,t.charts=!1,t.selectedTabIndex=0,"string"==typeof t.error?t.result='<pre class="fs-caption tc-red-700">'+t.error+"</pre>":e.isObject(t.data)?(t.result=i.dataToHtml(t),t.createtable=i.dataToCreateTable(t),t.pivot=!0,t.charts=!0):e.isString(t.data)?t.result='<pre class="fs-caption">'+t.data+"</pre>":t.result='<pre class="fs-caption">'+e.toJson(t.data,!0)+"</pre>",t},t.finalizeResult=function(e){if(t.vars.currentTab.loading=!1,t.vars.currentTab.progress=!1,e.data.find(function(e){return e.keyword&&-1!=["DROP","CREATE","ALTER"].indexOf(e.keyword.toUpperCase())})&&(t.selectDatabase(t.vars.db),r.$emit("handleBroadcastDatabases",{})),t.vars.currentTab.statistics[0]){var a=DataProvider.convertArrayToDataProvider(t.vars.currentTab.statistics,"statistics");a.sort="time",a.sortOrder="desc",e.widgets.stats.push(new WidgetTable(a,!1))}},t.execute=function(r,a){console.groupCollapsed("Execute query"),t.vars.LastStatistics=!1;var o=""===a.sql?a.editor.getValue():a.sql,s=0,d=a.editor,m=[],b=d.getSelectedText();e.isUndefined(a.selectedTabResultIndex)&&(a.selectedTabResultIndex=0);var h={data:[],time:u("date")(new Date,"HH:mm:ss"),pinned:!1,widgets:{tables:[],pivot:[],draw:[],stats:[]}};if(""!==b&&null!==b&&(o=b),console.info("[EDITOR TEXT]> ",o),""===o||null===o)return void l.show(l.simple().content(u("translate")("Не введен SQL")).theme(c.theme).position("bottom right"));a.results=a.results.reduce(function(e,t){return t.pinned&&e.push(t),e},[]),a.results.unshift(h),-1==t.vars.sqlLog.indexOf(o)&&(t.vars.sqlLog.unshift(o),t.vars.sqlLog.length>x&&t.vars.sqlLog.splice(0,x),n.set(p,t.vars.sqlLog)),S();var g=window.global_delimiter;g||(g=";;"),d.session.$mode.splitByTokens(o,"constant.character.escape",g).forEach(function(t){if(!("current"==r&&s>0)){var a=[],n=t.sql;if(!(n.length<5)){if("current"==r&&!b){var o=d.selection.getCursor();if(console.log("---------------"),console.info(t.sql),console.log("Exec current position :",o),console.log("Item range :",t.range.start,t.range.end),console.log("Item  :",t),!o||e.isUndefined(o))return;var l=t.range.compare(o.row,o.column);if(console.log("Range compare = ",l),0!==l)return}if(d.session.$mode.findTokens(n,"invalid.illegal",!0)){var c=d.session.$mode.splitByTokens(n,"invalid.illegal",!0);console.log("Find DRAW COMMAND",c),n=c[0].sql,c.forEach(function(t){if(e.isDefined(t.keyword)&&t.keyword){var r=/DRAW_(\w+)/gim,n=r.exec(t.keyword);n&&n[1]&&a.push({drawtype:n[1].toLowerCase(),code:t.sql})}})}console.info("[SQL]>",n),a&&console.info("[DRAW]>",a);var u=null,h=!1,p=!1,g=null,f=d.session.$mode.findTokens(n,"storage",!0),v=(d.session.$mode.fetchTokens(n),d.session.$mode.findTokens(n,"keyword",!0));f.hasOwnProperty("value")?(u=!1,p=f.value):(u=" FORMAT JSON ",h=!0),v.hasOwnProperty("value")&&(g=v.value),"select"!==g&&(u=!1,h=!1),m.push({sql:n,index:s,format:u,setedformat:h,keyword:g,storage:p,drawCommand:a,itemRange:t.range,qid:i.makeQueryId()}),s++}}}),console.groupEnd(),m.length&&(t.vars.currentTab.progress={},t.vars.currentTab.statistics||(t.vars.currentTab.statistics=[]),t.executeQuery(m[0],m,h))},t.setTheme=function(e){t.vars.theme=e,t.vars.tabs.forEach(function(t){return t.editor.setTheme("ace/theme/"+e)}),n.set("editorTheme",e)},t.selectDatabase=function(r){if(r){t.vars.db=r;var a={};i.setDatabase(r),i.query("SELECT * FROM system.columns",null).then(function(n){t.vars.databasesList=[];var i=[],o={},s=[],l={},c={},d=[];window.global_keywords_fieldsList=[],n.meta.forEach(function(e){d.push(e.name)}),n.data.forEach(function(n){!e.isUndefined(n.default_kind)&&e.isUndefined(n.default_type)&&(n.default_type=n.default_kind),l[n.database+"."+n.table]=1,_.isString(a[n.database])||(t.vars.databasesList.push(n.database),a[n.database]="y"),n.database==r&&(window.global_keywords_fieldsList.push(n),d.forEach(function(e){"table"==e&&(c.hasOwnProperty(n[e])||(c[n[e]]=1,s.push(n[e]))),"name"==e&&(o.hasOwnProperty(n[e])||(o[n[e]]=1,i.push(n[e])))}))}),window.global_keywords_fields=i,window.global_keywords_tables=r,Object.keys(l).forEach(function(e){window.global_keywords_tables+="|"+e}),t.vars.tabs.forEach(function(e){e.editor&&(e.editor.session.setMode({path:"ace/mode/clickhouse",v:Date.now()}),e.editor.session.bgTokenizer.start(0))})})}},t.addDictionariesWord=function(e){var r=t.vars.currentTab.editor,a=r.getCursorPosition();a.column+=e.length,r.clearSelection(),r.insert(e),t.vars.currentTab.sql=r.getValue(),d(function(){r.focus(),r.moveCursorToPosition(a)})},t.loadDictionaries=function(){t.vars.isDictionariesLoad||(console.log("loadDictionaries"),window.global_lang=b.use(),t.vars.dictionaries=[],window.global_keywords_dictList=[],i.query("select name,key,attribute.names,attribute.types from system.dictionaries ARRAY JOIN attribute ORDER BY name,attribute.names",null).then(function(e){e.data.forEach(function(e){var r=e.name;r=r.replace(/^.*\./gm,""),"news"!=r&&(r=r.replace(/s$/gm,"")),r=r?r.toLowerCase()+"_id":"ID";var a="dictGet"+e["attribute.types"]+"('"+e.name+"','"+e["attribute.names"]+"',to"+e.key+"( "+r+" ) ) AS "+e["attribute.names"]+",";window.global_keywords_dictList.push({dic:a,title:"dic_"+e.name+"."+e["attribute.names"]}),t.vars.dictionaries.push({dic:a,title:e.name+"."+e["attribute.names"]+" as "+e["attribute.types"]})})}),t.vars.isDictionariesLoad=!0)};for(var T=function(e){t.vars.tabs.length>=e&&(t.vars.currentTab=t.vars.tabs[e],t.vars.selectedTab=e,d(function(){t.vars.currentTab.editor.focus()}))},D=function(){t.vars.selectedTab>0&&T(t.vars.selectedTab-1)},C=function(){t.vars.selectedTab<t.vars.tabs.length-1&&T(t.vars.selectedTab+1)},I=function(){e.isObject(window.sqlFormatter)&&d(function(){t.vars.currentTab.editor.setValue(window.sqlFormatter.format(t.vars.currentTab.sql))})},E=function(e){m.add({combo:"ctrl+shift+"+(e+1),callback:function(){return T(e)}})},A=0;9>A;A++)E(A);m.add({combo:t.vars.disableHotKeyCmdLeft?"ctrl+shift+alt+right":"ctrl+right",callback:C}),m.add({combo:t.vars.disableHotKeyCmdLeft?"ctrl+shift+alt+left":"ctrl+left",callback:D}),m.add({combo:"ctrl+shift+f",callback:I}),t.aceLoaded=function(e){var r=t.vars.tabs.find(function(e){return!e.editor})||t.vars.currentTab;r.editor=e,e.$blockScrolling=1/0,e.setOptions({fontSize:t.vars.fontSize+"px",enableBasicAutocompletion:!0,behavioursEnabled:!0,wrapBehavioursEnabled:!0,highlightSelectedWord:!0,showGutter:!0,enableLiveAutocompletion:t.vars.enableLiveAutocompletion,liveAutocompletionDelay:500,liveAutocompletionThreshold:1}),e.setTheme("ace/theme/"+t.vars.theme),e.session.setMode({path:"ace/mode/clickhouse",v:Date.now()}),e.session.bgTokenizer.start(0),e.commands.addCommand({name:"runCurrentCommand",bindKey:{win:"Ctrl-Enter",mac:"Command-Enter"},exec:function(){t.execute("current",r)}}),e.commands.addCommand({name:"removeLiness",bindKey:{win:"Ctrl-Y",mac:"Cmd-Y"},exec:function(e){e.removeLines()}}),e.commands.addCommand({name:"collapseAll",bindKey:{win:"Ctrl-Shift--",mac:"Command+Shift+-"},exec:function(e){e.session.$mode.collapseAll(e.session)}}),e.commands.addCommand({name:"unfold",bindKey:{win:"Ctrl-Shift-+",mac:"Command+Shift+="},exec:function(e){e.session.unfold()}}),e.commands.addCommand({name:"runAllCommand",bindKey:{win:"Shift-Ctrl-Enter",mac:"Shift-Command-Enter"},exec:function(){t.execute("all",r)}});for(var a=function(t){e.commands.addCommand({name:"selecttab"+t,bindKey:{win:"Ctrl-Shift-"+(t+1),mac:"Command-Shift-"+(t+1)},exec:function(){return T(t)}})},n=0;9>n;n++)a(n);e.commands.addCommand({name:"selectnexttab",bindKey:{win:t.vars.disableHotKeyCmdLeft?"Shift-Alt-Ctrl-Right":"Ctrl-Right",mac:t.vars.disableHotKeyCmdLeft?"Shift-Alt-Command-Right":"Command-Right"},exec:C}),e.commands.addCommand({name:"selectprevtab",bindKey:{win:t.vars.disableHotKeyCmdLeft?"Shift-Alt-Ctrl-Left":"Ctrl-Left",mac:t.vars.disableHotKeyCmdLeft?"Shift-Alt-Command-Left":"Command-Left"},exec:D}),e.commands.addCommand({name:"formatcode",bindKey:{win:"Ctrl-Shift-F",mac:"Command-Shift-F"},exec:I}),e.clearSelection(),e.focus(),e.selection.moveTo(0,0),e.on("changeSelection",function(){d(function(){r.buttonTitle=""!==e.getSelectedText()?u("translate")("Выполнить выделенное ⌘ + ⏎"):u("translate")("Выполнить все ⇧ + ⌘ + ⏎"),r.originalSql&&(r.changed=r.originalSql!=r.sql)})}),t.loadDictionaries()},r.$watch("currentDatabase",t.selectDatabase),t.$watch("vars.limitRows",function(e){return n.set("editorLimitRows",e)}),t.$watch("vars.delimiter",function(e){e.name&&e.delimiter&&(e=e.delimiter),n.set("delimiter",e),window.global_delimiter=e,t.vars.tabs.forEach(function(e){e.editor&&(e.editor.session.setMode({path:"ace/mode/clickhouse",v:Date.now()}),e.editor.session.bgTokenizer.start(0))})}),t.$watch("vars.fontSize",function(e){e&&(t.vars.tabs.forEach(function(t){return t.editor&&t.editor.setOptions({fontSize:e+"px"})}),n.set("editorFontSize",e))}),t.save=function(e,r){return s.show(s.prompt().title(u("translate")("Сохранить SQL как")).placeholder(u("translate")("название")).initialValue(e.name).targetEvent(r).ok(u("translate")("Сохранить")).cancel(u("translate")("Отмена"))).then(function(r){var a=t.vars.sqlHistory.findIndex(function(t){return t.name==e.name});-1!=a?(t.vars.sqlHistory[a].sql=e.sql,t.vars.sqlHistory[a].name=r):t.vars.sqlHistory.push({sql:e.sql,name:r}),e.originalSql=e.sql,e.name=r,n.set(h,t.vars.sqlHistory),S()})},t.load=function(e){t.vars.currentTab.sql=e.sql,t.vars.currentTab.originalSql=e.sql,t.vars.currentTab.name=e.name},t.getExportData=function(t){return t.data.data.map(function(t){return Object.keys(t).map(function(r){return e.isArray(t[r])?t[r].join(", "):t[r]})})},t.getExportHeaders=function(e){return e.data.meta.map(function(e){return e.name})},t.addTab=function(){t.vars.currentTab={name:"new SQL",sql:"",buttonTitle:u("translate")("Выполнить ⌘ + ⏎"),format:{},editor:null,results:[],selectedResultTab:0},t.vars.tabs.push(t.vars.currentTab),S()},t.removeTab=function(e,r){r.stopPropagation();var a=function(){t.vars.tabs.splice(t.vars.tabs.indexOf(e),1),t.vars.tabs.length==t.vars.selectedTab&&t.vars.selectedTab--};e.changed?s.show(s.confirm().title(u("translate")("SQL изменен. Сохранить перед закрытием?")).targetEvent(r).ok(u("translate")("Да")).cancel(u("translate")("Нет"))).then(function(){var r=t.vars.sqlHistory.findIndex(function(t){return t.name==e.name});-1!=r&&(t.vars.sqlHistory[r].sql=e.sql,t.vars.sqlHistory[r].name=e.name),n.set(h,t.vars.sqlHistory),a()},a):a()},t.removeResult=function(e,t,r){r.stopPropagation(),e.results.splice(e.results.indexOf(t),1)},r.$on("handleBroadcastInsertInActive",function(e,r){r.value&&t.addDictionariesWord(r.value)}),t.toggleSidenav=function(e){o(e).toggle()},t.removeHistory=function(e,r){r.preventDefault();var a=t.vars.sqlHistory.indexOf(e);-1!=a&&s.show(s.confirm().title("Удалить "+e.name+"?").targetEvent(r).ok("Да").cancel("Нет")).then(function(){t.vars.sqlHistory.splice(a,1),n.set(h,t.vars.sqlHistory)})},t.$watch("vars.saveTabs",function(e,t){n.set(g,e),t===!1&&e===!0&&S()}),t.searchSqlLogServer=function(){t.vars.sqlLogServer=[];var e=t.vars.searchQueryOnServer,r="\n            SELECT query FROM ( SELECT query FROM system.query_log \nWHERE query like '%TABIX_QUERY_ID%' AND query not like '%system.query_log%' and exception=''  AND query LIKE '%"+e+"%'\nORDER BY event_time desc  ) GROUP BY query";e&&(console.info("Search on server query like : "+r),i.query(r).then(function(e){t.vars.sqlLogServer=_.map(e.data,"query")}))},t.setDisableAutoHelp=function(){var e=t.vars.disableAutohelp;n.set(v,e),console.info("SET>window.global_chFunctionsHelp = {};",e)},t.$watch("vars.disableHotKeyCmdLeft",function(e){n.set(f,e)}),t.$watch("vars.enableLiveAutocompletion",function(e){n.set(y,e),t.vars.tabs.forEach(function(t){return t.editor&&t.editor.setOptions({enableLiveAutocompletion:e})})}),t.setUiTheme=function(e){return c.set(e.name)},t.setSql=function(e){t.vars.currentTab.sql=e,t.toggleSidenav("log"),d(function(){return t.vars.currentTab.editor.focus()},500)},t.changeTabName=function(e,r){r.stopPropagation(),s.show(s.prompt().title(u("translate")("Название вкладки")).placeholder(u("translate")("название")).initialValue(e.name).targetEvent(r).ok(u("translate")("Применить")).cancel(u("translate")("Отмена"))).then(function(r){var a=t.vars.sqlHistory.findIndex(function(t){return t.name==e.name});-1!=a&&(e.originalSql=e.sql,t.vars.sqlHistory[a].name=r,n.set(h,t.vars.sqlHistory)),e.name=r,S()})},t.vars.saveTabs?(t.vars.tabs=n.get(w),t.vars.tabs.length>0?d(function(){return t.vars.currentTab=t.vars.tabs[0]},500):t.addTab()):(n.set(w,[]),t.addTab()),r.currentDatabase&&t.selectDatabase(r.currentDatabase),i.query("select name,is_aggregate from system.functions",null).then(function(e){e.data.forEach(function(e){if(window.global_builtinFunctions.push({name:e.name,isaggr:e.is_aggregate,score:101,comb:!1,origin:e.name}),e.is_aggregate){var t={name:e.name+"If",isaggr:e.is_aggregate,score:3,comb:"If",origin:e.name};window.global_builtinFunctions.push(t),t={name:e.name+"Array",isaggr:e.is_aggregate,score:2,comb:"Array",origin:e.name},window.global_builtinFunctions.push(t),t={name:e.name+"State",isaggr:e.is_aggregate,score:1,comb:"State",origin:e.name},window.global_builtinFunctions.push(t)}})}),t.$on("$destroy",function(){i.setDatabase(r.currentDatabase),k(),a.onbeforeunload=null}),t.rightAceMenuList=[{active:!0,value:"AutoFormat",icon:"format-size"},{active:!0,value:"Expand",icon:"arrow-expand"},{active:!0,value:"Collapse",icon:"arrow-compress"},{active:!0,value:"Collapse All",icon:"arrow-compress"}],t.showDialogUpload=function(t,r){function a(e,t){e.vars={UploadCsv:{content:null,header:!0,headerVisible:!0,separator:",",separatorVisible:!0,result:null,encoding:"ISO-8859-1",encodingVisible:!0,uploadButtonLabel:"Upload",callback:function(e){console.log("callback"),t.hide()}}},e.$watch("vars.UploadCsv.result",function(e){e&&t.hide(e)}),e.hide=function(){t.hide()},e.cancel=function(){t.cancel()}}a.$inject=["$scope","$mdDialog"],s.show({controller:a,templateUrl:"app/sql/showDialogUpload.html",parent:e.element(document.body),targetEvent:r,clickOutsideToClose:!0}).then(function(e){if(e&&t&&t.tables){var r=DataProvider.convertArrayToDataProvider(e,"csv");t.tables.push(new WidgetTable(r))}},function(){})},t.rightMenuProcess=function(e){var r=t.vars.currentTab.editor.session;t.vars.currentTab.editor.resize(),"AutoFormat"==e.value?I():"Expand"==e.value?r.unfold():"Collapse All"==e.value?r.$mode.collapseAll(r):"Collapse"==e.value&&r.foldAll(),t.vars.currentTab.editor.focus()}}e.module(t.app.name).controller("SqlController",r),r.$inject=["$scope","$rootScope","$window","localStorageService","API","$mdSidenav","$mdDialog","$mdToast","ThemeService","$timeout","$filter","hotkeys","$translate"]}(angular,smi2),/*
 * Licensed under the Apache License, Version 2.0 Copyright 2017 Igor Strykhar,Ivan Kudinov,SMI2 LLC and other contributors
 */
function(e,t,r){function a(e,t,r,a,n,i,o,s,l,c){e.tabsRender=!0,e.vars={rsw:0,uiTheme:l.themeObject,isChartReady:!1,staticGrid:!0,stackType:"false",isDark:l.isDark(),active:{table:!1,pivot:!1,draw:!1}},e.gridsterOpts={columns:6,pushing:!0,floating:!0,swapping:!0,width:"auto",colWidth:"auto",rowHeight:"match",margins:[4,4],outerMargin:!0,sparse:!1,isMobile:!1,mobileBreakPoint:600,mobileModeEnabled:!0,minColumns:1,minRows:0,maxRows:100,defaultSizeX:1,defaultSizeY:1,minSizeX:0,maxSizeX:null,minSizeY:0,maxSizeY:null,resizable:{enabled:!e.vars.staticGrid,handles:["n","e","s","w","ne","se","sw","nw"],start:function(e,t,r){},resize:function(e,t,r){r.scheduledResize()},stop:function(e,t,r){c(function(){r.scheduledResize()},400)}},draggable:{enabled:!e.vars.staticGrid,handle:".widget-draggable",start:function(e,t,r){},drag:function(e,t,r){},stop:function(e,t,r){}}},e.switchStaticGrid=function(){e.vars.staticGrid=!e.vars.staticGrid,e.gridsterOpts.draggable.enabled=!e.vars.staticGrid,e.gridsterOpts.resizable.enabled=!e.vars.staticGrid},e.initNoTabs=function(){e.vars.active.table=!0,e.vars.active.draw=!0,e.vars.active.pivot=!0},e.initTableTab=function(){e.vars.active.table=!0},e.initDrawTab=function(){e.vars.active.draw=!0},e.initPivotTab=function(){e.vars.active.pivot=!0}}e.module(t.app.name).controller("RenderCtrl",a),a.$inject=["$scope","$rootScope","$window","localStorageService","API","$mdSidenav","$mdDialog","$mdToast","ThemeService","$timeout"]}(angular,smi2,window.$),function(e,t){function r(t,r){var a=t.get("themeName")||"dark",n=[{isDark:!1,name:"default",title:r("translate")("Светлая тема")},{isDark:!0,name:"dark",title:r("translate")("Темная тема")}],i=n.find(function(e){return e.name==a})||n[0];return i.isDark&&e.element("body").addClass("dark"),{isDark:function(){return i.isDark},theme:i.name,themeObject:i,set:function(e){e!=a&&(t.set("themeName",e),location.href=location.href)},list:n}}e.module(t.app.name).service("ThemeService",r),r.$inject=["localStorageService","$filter"]}(angular,smi2),function(e,t){function r(e,t){return{responseError:function(r){return 401==r.status&&t.get("$state").go("login"),e.reject(r)}}}e.module(t.app.name).service("HttpInterceptor",r),r.$inject=["$q","$injector"]}(angular,smi2),/*
 * Licensed under the Apache License, Version 2.0 Copyright 2017 Igor Strykhar,Ivan Kudinov,SMI2 LLC and other contributors
 */
function(e,t){function r(t,r,a,n,i){var o=this,s="currentBaseConfig",l=null,c={},d=a.get(s);d&&d.host&&(c=d),this.setConnection=function(t){a.set(s,t),c=e.copy(t)},this.clear=function(){l=null,c={},a.set(s,{})},this.getPassword=function(){return c.password},this.getLogin=function(){return c.login},this.makeQueryId=function(){for(var e="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=0;8>r;r++)e+=t.charAt(Math.floor(Math.random()*t.length));return e},this.isTabixServer=function(){return c.tabix&&c.tabix.server?!0:!1},this.tabixQuery=function(e){return console.info("[request]>",e),t(req).then(function(e){return defer.resolve(e.data)},function(e){return defer.reject(e)}),defer.promise},this._tabixRequest=function(t,r){var a={version:1,auth:{login:c.tabix.login,password:c.tabix.password,confid:c.tabix.confid}};t=Object.assign(a,t);var n=c.tabix.server+"/"+r;return{method:"POST",data:t,url:n,transformResponse:function(t,r,a){try{return JSON.parse(t)}catch(n){return t?t:"\nStatus:"+a+"\nHeaders:"+e.toJson(r())}}}},this.query=function(a,n,i,s){var d=r.defer(),u="",m="http://localhost/",b=!1;if(n!==!1?(n=n||" FoRmAt JSON","null"==n&&(n=""),u=a+"\n\n"+n):u=a,o.isTabixServer())b=o._tabixRequest({query:u},"query");else{var h="";c.host.indexOf("://")>0||0==c.host.indexOf("/")||(h="http://"),m=h+c.host+"/?add_http_cors_header=1&log_queries=1",c.login&&(m+="&user="+c.login),c.password&&(m+="&password="+c.password),i&&(m+="&database="+l),s&&(m+="&"+s),c.params&&(m+="&"+c.params),b={method:"POST",data:u,headers:{"Content-Type":"application/x-www-form-urlencoded"},url:m,cache:!1,eventHandlers:{},transformResponse:function(t,r,a){try{return JSON.parse(t)}catch(n){return t?t:"\nStatus:"+a+"\nHeaders:"+e.toJson(r())}}}}return t(b).then(function(e){return d.resolve(e.data)},function(e){return d.reject(e)}),d.promise},this.getConnectionInfo=function(){return c},this.setDatabase=function(e){return l=e},this.getDatabase=function(){return l},this.dataToCreateTable=function(e){var t="\nCREATE TABLE x (\n",r=[];return e.meta.forEach(function(e){return r.push("	"+e.name+" "+e.type)}),t+r.join(",\n")+"\n ) ENGINE = Log \n;;\n"},this.dataToHtml=function(e){var t='<table class="sql-table '+i.theme+'"><tr>',r=[];return e.meta.forEach(function(e){t+="<th>"+n(e.name)+'\n                            <div class="sql-table__subheader">'+n(e.type)+"</div>\n                        </th>",r.push(e.name)}),e.data.forEach(function(e){t+="<tr>",r.forEach(function(r){t+="<td>"+n(e[r])+"</td>"}),t+="</tr>"}),t+="</table>"},this.dataToHandsontable=function(e){var t=[],r=[];return e.meta.forEach(function(e){t.push(e.name);var a={};switch(a.type="text",a.width=100,e.type){case"Date":a.width=90,a.type="date",a.dateFormat="MM/DD/YYYY";break;case"DateTime":a.width=150,a.type="time",a.timeFormat="HH:mm:ss";break;case"Int32":a.width=80,a.type="numeric";break;case"Float64":a.width=80,a.type="numeric",a.format="0,0.0000";break;case"UInt32":a.width=80,a.type="numeric";break;case"String":a.width=180}a.data=e.name,r.push(a)}),{colHeaders:t,columns:r,data:e.data,currentRowClassName:"currentRow",currentColClassName:"currentCol"}}}e.module(t.app.name).service("API",r),r.$inject=["$http","$q","localStorageService","$sanitize","ThemeService"]}(angular,smi2),function(e,t){function r(t,r,a,n,i,o,s){var l="proc.interval",c="proc.key";t.vars={queryesToKill:{},clusterMode:!0,logMode:!0,loading:!1,logData:{},cols:[],isClusterLoad:!1,clusterList:!1,isDark:a.isDark(),sort:/^[a-z0-9_]+$/.test(i.get(c))?i.get(c):null,interval:i.get(l)||-1,scrollConfig:{autoHideScrollbar:!1,theme:a.isDark()?"light":"dark",scrollButtons:{enable:!1},scrollInertia:100,advanced:{updateOnContentResize:!0}}},t.updateHandTable=function(){s.getInstance("hotTableProcesses").render()},t.table={wordWrap:!1,data:{},settings:{manualColumnMove:!0,manualColumnResize:!0,autoWrapRow:!0,rowHeaders:!0,colWidths:70,dropdownMenu:!0,stretchH:"all",fillHandle:!1,preventOverflow:"horizontal",columnSorting:!0,sortIndicator:!0,manualRowResize:!0,viewportColumnRenderingOffset:"auto",autoColumnSize:{samplingRatio:23}}};var d=null;t.initClusterConfig=function(){var e="SELECT host_address,port FROM system.clusters GROUP BY host_address,port LIMIT 10";t.vars.clusterList=[],r.query(e).then(function(e){e.data.forEach(function(e){t.vars.clusterList.push(e.host_address+":"+e.port)}),t.vars.isClusterLoad=!0,console.log("Cluster nodes list",t.vars.clusterList.join(","))},function(e){t.vars.isClusterLoad=!0,console.error("Error "+e)})},t.flush=function(){t.vars.logData={},t.table.data=[]},t.load=function(){var e="SELECT  now() as dt, query,  1 as count,  formatReadableSize(read_bytes) as bytes_read, \n                formatReadableSize(written_bytes) as written_bytes,  formatReadableSize(memory_usage) as memory_usage,\n                read_rows,written_rows, round(elapsed,4) as elapsed ,  * ,   cityHash64(query) as hash,  hostName()";t.vars.isClusterLoad&&t.vars.clusterList&&t.vars.clusterMode?e=e+" FROM remote('"+t.vars.clusterList.join(",")+"',system.processes, '"+r.getLogin()+"','"+r.getPassword()+"') ":e+=" FROM system.processes ",t.vars.logMode&&(e+=" /* 12XQWE3X1X2XASDF */ WHERE query not like '%12XQWE3X1X2XASDF%'"),r.query(e).then(function(e){var a=r.dataToHandsontable(e);if(t.table.colHeaders=a.colHeaders,t.table.settings.manualColumnResize=a.columns,t.table.settings.colWidths=a.colWidths,t.vars.logMode){a.data.forEach(function(e){if(t.vars.logData[e.hash]){var r=t.vars.logData[e.hash].count;t.vars.logData[e.hash].query_id!=e.query_id&&(r+=1),e.count=r,t.vars.logData[e.hash]=e}else e.count=1,t.vars.logData[e.hash]=e});var n=$.map(t.vars.logData,function(e,t){return[e]});t.table.data=n}else t.table.data=a.data;t.vars.data=!0,t.vars.loading=!1,t.updateHandTable()},function(e){t.vars.loading=!1,console.error("Error "+e)})},t.setInterval=function(){i.set(l,t.vars.interval),d&&(n.cancel(d),d=null),t.vars.interval>-1&&(d=n(t.load,1e3*t.vars.interval))},t.$on("$destroy",function(){t.vars.interval=-1,n.cancel(d),t.setInterval()}),t.initClusterConfig(),t.load(),t.vars.interval>-1&&t.setInterval(),t.dialogKill=function(a){var n="SELECT now() as dt,query,1 as count,\n                \n                formatReadableSize(read_bytes) as read_bytes, \n                formatReadableSize(written_bytes) as written_bytes, \n                formatReadableSize(memory_usage) as memory_usage,\n                read_rows,written_rows,\n                \n                query_id as hash,\n                round(elapsed,4) as elapsed \n            FROM system.processes /* 12XQWE3X1X2XASDF */ WHERE query not like '%12XQWE3X1X2XASDF%' ORDER BY elapsed DESC";r.query(n).then(function(n){o.show({controller:["$scope",function(e){e.queryesToKill=n.data,e.kill=function(e){var t="KILL QUERY WHERE query_id='"+e.hash+"' SYNC",n=o.confirm().title(t+" ?").textContent(e.query).ariaLabel("Lucky day").targetEvent(a).ok("Please do it!").cancel("Sounds like a scam");o.show(n).then(function(){r.query(t,!1).then(function(e){o.show(o.alert().clickOutsideToClose(!0).title("Result: "+t).textContent(e).ariaLabel("Alert").ok("Ok!").targetEvent(a))},function(e){o.show(o.alert().clickOutsideToClose(!0).title("Error: "+t).textContent(e.data).ariaLabel("Error on Kill").ok("Ok!").targetEvent(a))})},function(){})},e.cancel=function(){o.cancel()}}],templateUrl:"app/metrics/dialog.kill.html",parent:e.element(document.body),targetEvent:a,clickOutsideToClose:!0}).then(function(e){t.status='You said the information was "'+e+'".'},function(){t.status="You cancelled the dialog."})})}}e.module(t.app.name).controller("ProcessesController",r),r.$inject=["$scope","API","ThemeService","$interval","localStorageService","$mdDialog","hotRegisterer"]}(angular,smi2),/*
 * Copyright (C) 2017 IgorStrykhar in SMI2
 * All rights reserved.
 */
function(e,t,r){function a(e,t,r,a,n,i,o,s,l,c){e.widgets=[],e.gridsterOpts={columns:6,pushing:!0,floating:!0,swapping:!0,width:"auto",colWidth:"auto",rowHeight:"match",margins:[4,4],outerMargin:!0,sparse:!1,isMobile:!1,mobileBreakPoint:600,mobileModeEnabled:!0,minColumns:1,minRows:0,maxRows:100,defaultSizeX:1,defaultSizeY:1,minSizeX:0,maxSizeX:null,minSizeY:0,maxSizeY:null,resizable:{enabled:!e.vars.staticGrid,handles:["n","e","s","w","ne","se","sw","nw"],start:function(e,t,r){},resize:function(e,t,r){r.scheduledResize()},stop:function(e,t,r){c(function(){r.scheduledResize()},400)}},draggable:{enabled:!e.vars.staticGrid,handle:".widget-draggable",start:function(e,t,r){},drag:function(e,t,r){},stop:function(e,t,r){}}},e.vars={uiTheme:l.themeObject,isDark:l.isDark()},e.initTab=function(){console.info("initPivotTab")},e.init=function(){console.info("Init OverviewController"),n.query("SELECT * FROM system.build_options").then(function(t){e.widgets.push(new WidgetTable(new DataProvider(t),1,3))}),n.query("SELECT database,table,name, data_compressed_bytes, data_uncompressed_bytes FROM system.columns").then(function(t){var r={path:"database.table.name.data_compressed_bytes",title:"columns data_compressed_bytes",tooltip:"Size",valueformat:"0.00 b"},a={drawtype:"TREEMAP",code:r};e.widgets.push(new WidgetDraw(new DataProvider(t),a,3,3))}),n.query("select toStartOfFiveMinute(modification_time) as dt,\n            sum(bytes) as bytes from system.parts group by dt order by dt LIMIT 30000").then(function(t){var r={autoAxis:!0,markLine:!0,title:"system.parts bytes"},a={drawtype:"CHART",code:r};e.widgets.push(new WidgetDraw(new DataProvider(t),a,3,3))}),n.query("select concat(database,'.',table) as table,sum(bytes) as bytes from system.parts\n            group by table order by bytes desc LIMIT 3000").then(function(t){var r={title:"system.parts bytes"},a={drawtype:"BAR",code:r};e.widgets.push(new WidgetDraw(new DataProvider(t),a,3,1))}),n.query("SELECT * FROM system.clusters").then(function(t){e.widgets.push(new WidgetTable(new DataProvider(t),1,3))})},e.init()}e.module(t.app.name).controller("OverviewController",a),a.$inject=["$scope","$rootScope","$window","localStorageService","API","$mdSidenav","$mdDialog","$mdToast","ThemeService","$timeout"]}(angular,smi2,window.$),function(e,t){function r(t,r,a,n,i,o,s){var l="proc.metrica",c="proc.metrica_max";t.data=[],t.metrcisChart=!1,t.maxlength=i.get(c)||50,t.chartData={},t.orderKeys={},t.preState={},t.EChartOptions={},t.vars={logEvents:!1,initChart:!1,isDark:a.isDark(),interval:i.get(l)||-1,scrollConfig:{autoHideScrollbar:!1,theme:a.isDark()?"light":"dark",scrollButtons:{enable:!1},scrollInertia:100,advanced:{updateOnContentResize:!0}}},e.element(s).bind("resize",function(){t.metrcisChart&&t.vars.initChart&&t.metrcisChart.resize()}),t.initChart=function(e){if(t.vars.initChart){for(var r in e)if("time"!=r){t.chartData[r].length>t.maxlength&&t.chartData[r].shift();var n=parseInt(e[r]);n-parseInt(t.preState[r]);t.chartData[r].push([e.time,n])}return t.metrcisChart.setOption(t.EChartOptions),void(t.preState=e)}if(e.time){t.preState=e;var i=[],o=[],s=[],l=[],c=[],d=0,u=0;for(var m in e)if("time"!=m){t.orderKeys[m]=d;var b=parseInt(e[m]);t.chartData[m]=[],t.chartData[m].push([e.time,b]),i.push({show:!0,borderWidth:0,shadowBlur:2}),o.push({show:!1,type:"time",splitLine:{show:!1},gridIndex:d}),s.push({type:"value",show:!1,scale:!0,splitLine:{show:!1},name:"value",boundaryGap:[0,"100%"],min:"dataMin",max:"dataMax",gridIndex:d}),c.push({textAlign:"center",text:m,textStyle:{fontSize:10,fontWeight:"normal"}}),l.push({name:m,type:"line",data:t.chartData[m],xAxisIndex:d,yAxisIndex:u,showSymbol:!1,hoverAnimation:!1}),d+=1,u+=1}var h=Math.ceil(Math.sqrt(d));i.forEach(function(e,t){e.left=t%h/h*100+.5+"%",e.top=Math.floor(t/h)/h*100+.5+"%",e.width=1/h*100-2+"%",e.height=1/h*100-2+"%",c[t].left=parseFloat(e.left)+parseFloat(e.width)/2+"%",c[t].top=parseFloat(e.top)+"%"});var p={version:3,title:c.concat([{text:"Metrics",top:"bottom",left:"center"}]),toolbox:{show:!0,feature:{saveAsImage:{show:!0}}},width:"100%",group:"group",grid:i,xAxis:o,yAxis:s,series:l,tooltip:{showDelay:0,backgroundColor:"#2c343c",trigger:"axis",formatter:function(e){e=e[0];var t=new Date(e.value[0]),r=e.value[1],a=r;return e.seriesName.toLowerCase().includes("bytes")?r=numbro(r).format("0.0000b"):r>1e4&&(r=numbro(r).format("0.0000a")),e.seriesName+"<br><br>"+moment(t).format("h:mm:ss")+" <br><b>"+r+"</b><br>"+(a!=r?"<br><b>"+a+"</b><br>":"")},axisPointer:{animation:!1}}};t.vars.initChart=!0,t.EChartOptions=Object.assign(p,t.EChartOptions);var g="macarons";a.isDark()&&(g="dark"),t.metrcisChart=echarts.init(document.querySelector("#metrcisChart"),g),t.metrcisChart.setOption(t.EChartOptions),t.metrcisChart.resize()}};var d=null;t.$watch("vars.logEvents",function(){t.flushChart()},!0),t.flushChart=function(){t.vars.initChart&&(t.chartData={},t.metrcisChart.dispose(),t.EChartOptions={},t.vars.initChart=!1,t.load())},t.flush=function(){for(var e in t.chartData)for(var r=t.chartData[e].length,a=0;r-2>a;a++)t.chartData[e].shift();t.metrcisChart.setOption(t.EChartOptions),t.metrcisChart.resize(),t.load()},t.load=function(){t.vars.loading=!0;var e=" SELECT metric,toInt64(value) as value,'metrics' as type FROM system.metrics ORDER BY metric ";e+=" UNION ALL SELECT metric,toInt64(value) as value,'async' as type FROM system.asynchronous_metrics ORDER BY metric ",t.vars.logEvents&&(e+=" UNION ALL  SELECT event as metric, toInt64( value) as value,'events' as type FROM system.events ORDER BY metric"),r.query(e).then(function(e){t.vars.loading=!1;var r={time:Date.now()};e.data.forEach(function(e){var t="";"events"==e.type&&(t=" "),r[e.metric+t]=e.value}),t.initChart(r)},function(e){t.vars.loading=!1,console.error("Ошибка "+e)})},t.setMaxlength=function(){i.set(c,t.maxlength)},t.setInterval=function(){i.set(l,t.vars.interval),d&&(n.cancel(d),d=null),t.vars.interval>-1&&(d=n(t.load,1e3*t.vars.interval))},t.$on("$destroy",function(){t.vars.interval=-1,n.cancel(d),t.setInterval()}),t.load(),t.vars.interval>-1&&t.setInterval()}e.module(t.app.name).controller("MetricschartController",r),r.$inject=["$scope","API","ThemeService","$interval","localStorageService","$mdDialog","$window"]}(angular,smi2),function(e,t){function r(e,t,r,a,n,i,o){e.vars={uiTheme:r.themeObject,isDark:r.isDark(),selectedTabResultIndex:0,active:{Overview:!1,Chart:!1,Processes:!1}},e.initProcessesTab=function(t){e.vars.active.Processes=!0},e.initChartTab=function(t){e.vars.active.Chart=!0},e.initOverviewTab=function(t){e.vars.active.Overview=!0}}e.module(t.app.name).controller("MetricsController",r),r.$inject=["$scope","API","ThemeService","$interval","localStorageService","$mdDialog","$window"]}(angular,smi2),function(e,t){function r(r,a,n,i,o,s,l){var c="basesConfig";r.vars={bases:n.get(c)||[],db:{},loading:!1,version:t.app.version,themes:s.list},r.login=function(){if(r.vars.loading=!0,r.vars.db.id){for(var e=0;e<r.vars.bases.length;e++)if(r.vars.bases[e].id==r.vars.db.id){r.vars.bases[e]=r.vars.db;break}}else r.vars.db.id=(new Date).getTime(),r.vars.bases.push(r.vars.db);n.set(c,r.vars.bases),i.setConnection(r.vars.db),i.query("SELECT 'login success'").then(function(){return a.go("sql")},function(){r.vars.loading=!1,o.show(o.simple().content("Login or connect error, check host:port,login & password").theme(s.theme).position("bottom right"))})},r.help=function(r){function a(e,r){e.vars={version:t.app.version,buildDate:t.app.buildDate},e.hide=function(){r.hide()},e.cancel=function(){r.cancel()},e.answer=function(e){r.hide(e)}}a.$inject=["$scope","$mdDialog"],l.show({controller:a,templateUrl:"app/base/helpDialogLogin.html",parent:e.element(document.body),targetEvent:r,clickOutsideToClose:!0})},r.add=function(){r.vars.bases.push(r.vars.db)},r.remove=function(){var e=r.vars.bases.findIndex(function(e){return e.id==r.vars.db.id});r.vars.bases.splice(e),n.set(c,r.vars.bases),r.vars.db={}},r.setUiTheme=function(e){return s.set(e.name)}}e.module(t.app.name).controller("LoginController",r),r.$inject=["$scope","$state","localStorageService","API","$mdToast","ThemeService","$mdDialog"]}(angular,smi2),function(e,t){e.module(t.app.name).filter("filesize",function(){var e=["bytes","KB","MB","GB","TB","PB"];return function(t,r){if(isNaN(parseFloat(t))||!isFinite(t))return"?";for(var a=0;t>=1024;)t/=1024,a++;return t.toFixed(+r)+" "+e[a]}})}(angular,smi2),angular.module("ng-echartsx",[]).directive("ngEchartsx",[function(){return{link:function(e,t,r,a){function n(){var r=e.config&&e.config.theme?e.config.theme:"default",a=echarts.init(t[0],r);e.config&&e.config.dataLoaded===!1&&a.showLoading(),e.config&&e.config.dataLoaded&&(a.setOption(e.option),console.log("chart.resize();"),a.resize(),a.hideLoading()),e.config&&e.config.event&&angular.isArray(e.config.event)&&angular.forEach(e.config.event,function(e,t){for(var r in e)a.on(r,e[r])})}e.$watch(function(){return e.config},function(e){e&&n()},!0),e.$watch(function(){return e.option},function(e){e&&n()},!0)},scope:{option:"=ecOption",config:"=ecConfig"},restrict:"EA"}}]),angular.module("iu",[]).directive("iuChart",function(){return{restrict:"EA",template:"<div></div>",replace:!0,scope:{iuChart:"="},link:function(e,t,r,a){function n(){l=t.find("div")[0]||t[0],b.height?l.height(b.height):l.clientHeight||l.height(t.height()||t.parent().height()||220),d=b.theme?echarts.init(l,b.theme):echarts.init(l),d.setOption(b),angular.isFunction(b.onRegisterApi)&&(i(),b.onRegisterApi(c)),angular.isDefined(e.iuChart.version)&&(m=e.$watch("iuChart.version",function(e,t){e!==t&&d.setOption(b,!0)})),e.$on("$destroy",function(){m&&m(),d.dispose(),d=null}),$(window).resize(function(){d.resize()})}function i(){c={set:function(e){d.setOption(e,!0)},getInstance:function(){return d},addData:function(e){d.addData(e)},connect:function(e,t){e&&t?d.connect([e.getInstance(),t.getInstance()]):d.connect([e.getInstance()])},disConnect:function(e){d.disConnect(e.getInstance())},setTheme:function(e){},showLoading:function(e){},hideLoading:function(){},getImage:function(e){return d.getImage(e||"png")},resize:function(){d.resize()},refresh:function(){d.refresh()},restore:function(){d.restore()},clear:function(){d.clear()},registeEvents:function(e,t,r){this.events={CLICK:-1!==t.indexOf(1),DBLCLICK:-1!==t.indexOf(2),DATA_ZOOM:-1!==t.indexOf(3),LEGEND_SELECTED:-1!==t.indexOf(4),LEGEND_HOVERLINK:-1!==t.indexOf(5),HOVER:-1!==t.indexOf(6),MAP_SELECTED:-1!==t.indexOf(7),PIE_SELECTED:-1!==t.indexOf(8)},o(e,r)},unRegisteEvents:function(e,t){}}}function o(e,t){return u=s(),e.$on(u,function(r){var a=Array.prototype.slice.call(arguments);a.splice(0,1),t.apply(e,a)})}function s(){return"xxxxxxxx-xxxx-8xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,r="x"===e?t:3&t|8;return r.toString(16)})}var l,c,d,u,m,b=e.iuChart;n()}}}),function(){function e(e,t,r,a){return function(n,i,o){function s(e){d=e.width||parseInt(o.width)||p||320,u=e.height||parseInt(o.height)||g||240,b.style.width=d+"px",b.style.height=u+"px"}function l(e,t,a){t=angular.extend({showXAxis:!0,showYAxis:!0,showLegend:!0},t);var n=angular.extend({orient:"top",axisLine:{show:!1}},angular.isObject(t.xAxis)?t.xAxis:{}),i=angular.extend({type:"value",orient:"right",scale:!1,axisLine:{show:!1},axisLabel:{formatter:function(e){return r.formatKMBT(e)}}},angular.isObject(t.yAxis)?t.yAxis:{}),o={title:r.getTitle(e,t,a),tooltip:r.getTooltip(e,t,a),legend:r.getLegend(e,t,a),toolbox:angular.extend({show:!1},angular.isObject(t.toolbox)?t.toolbox:{}),xAxis:[angular.extend(n,r.getAxisTicks(e,t,a))],yAxis:[i],graphic:t.graphic&&(angular.isObject(t.graphic)||angular.isArray(t.graphic))?t.graphic:[],series:r.getSeries(e,t,a)};return t.showXAxis||angular.forEach(o.xAxis,function(e){e.axisLine={show:!1},e.axisLabel={show:!1},e.axisTick={show:!1}}),t.showYAxis||angular.forEach(o.yAxis,function(e){e.axisLine={show:!1},e.axisLabel={show:!1},e.axisTick={show:!1}}),t.showLegend&&"gauge"!==a&&"map"!==a||delete o.legend,r.isAxisChart(a)||(delete o.xAxis,delete o.yAxis),t.dataZoom&&(o.dataZoom=angular.extend({show:!0,realtime:!0},t.dataZoom)),t.dataRange&&(o.dataRange=angular.extend({},t.dataRange)),t.polar&&(o.polar=t.polar),t.grid&&(o.grid=t.grid),o}function c(){if(n.data&&n.config){var r;if(s(n.config),m||(m=echarts.init(b,t.get(n.config.theme||"macarons"))),n.config.event&&(Array.isArray(n.config.event)||(n.config.event=[n.config.event]),Array.isArray(n.config.event)&&n.config.event.forEach(function(e){f[e.type]||(f[e.type]=!0,m.on(e.type,function(t){e.fn(t)}))})),angular.isString(n.data)){if(v)return;v=!0,m.showLoading({text:n.config.loading||"奋力加载中...",textStyle:y}),e.get(n.data).success(function(e){v=!1,m.hideLoading(),e.data?(r=l(e.data,n.config,a),n.config.forceClear&&m.clear(),r.series.length?(m.setOption(r),m.resize()):m.showLoading({text:n.config.errorMsg||"没有数据",textStyle:y})):m.showLoading({text:n.config.emptyMsg||"数据加载失败",textStyle:y})}).error(function(e){v=!1,m.showLoading({text:n.config.emptyMsg||"数据加载失败",textStyle:y})})}else r=l(n.data,n.config,a),n.config.forceClear&&m.clear(),r.series.length?(m.setOption(r),m.resize()):m.showLoading({text:n.config.errorMsg||"没有数据",textStyle:y});n.chartObj=m}}n.config=n.config||{};var d,u,m,b=i.find("div")[0],h=i.parent()[0],p=h.clientWidth,g=h.clientHeight,f={},v=!1,y={color:"red",fontSize:36,fontWeight:900,fontFamily:"Microsoft Yahei, Arial"};n.$watch(function(){return n.config},function(e){e&&c()},!0),n.$watch(function(){return n.data},function(e){e&&c()},!0)}}for(var t=angular.module("angular-echarts",["angular-echarts.theme","angular-echarts.util"]),r=["line","bar","area","pie","donut","gauge","map","radar"],a=0,n=r.length;n>a;a++)!function(r){t.directive(r+"Chart",["$http","theme","util",function(t,a,n){return{restrict:"EA",template:"<div></div>",scope:{config:"=config",data:"=data",chartObj:"=chartObj"},link:e(t,a,n,r)}}])}(r[a]);angular.module("angular-echarts.util",[]).factory("util",function(){function e(e){return["pie","donut"].indexOf(e)>-1}function t(e){return["map"].indexOf(e)>-1}function r(e){return["line","bar","area"].indexOf(e)>-1}function a(e,t,r){var a=[];return e[0]&&angular.forEach(e[0].datapoints,function(e){a.push(e.x)}),{type:"category",boundaryGap:"bar"===r,data:a}}function n(a,n,i){var o=[];return angular.forEach(a,function(a){var s=[];angular.forEach(a.datapoints,function(e){s.push(e.y)});var l={type:i||"line",name:a.name,data:s};"area"===i&&(l.type="line",l.itemStyle={normal:{areaStyle:{type:"default"}}}),"gauge"===i&&(l=angular.extend(l,{splitNumber:10,axisLine:{lineStyle:{color:[[.2,"#228b22"],[.8,"#48b"],[1,"#ff4500"]],width:8}},axisTick:{splitNumber:10,length:12,lineStyle:{color:"auto"}},axisLabel:{textStyle:{color:"auto"}},splitLine:{show:!0,length:30,lineStyle:{color:"auto"}},pointer:{width:5},title:{show:!0,offsetCenter:[0,"-40%"],textStyle:{fontWeight:"bolder"}},detail:{formatter:"{value}%",textStyle:{color:"auto",fontWeight:"bolder"}}},n.gauge||{})),r(i)||(l.data=[],angular.forEach(a.datapoints,function(e){l.data.push({value:e.y,name:e.x})})),e(i)&&(l.type="pie",l.center=n.center||["40%","50%"],l.radius=n.radius||"60%","donut"===i?(l.radius=n.radius||["50%","70%"],l=angular.extend(l,{itemStyle:{normal:{label:{show:!1},labelLine:{show:!1}},emphasis:{label:{show:!0,position:"center",textStyle:{fontSize:"50",fontWeight:"bold"}}}}},n.donut||{})):"pie"===i&&(l=angular.extend(l,{itemStyle:{normal:{label:{position:"inner",formatter:function(e){return(+e.percent).toFixed()+"%"}},labelLine:{show:!1}},emphasis:{label:{show:!0,formatter:"{b}\n{d}%"}}}},n.pie||{}))),t(i)&&(l.type="map",l=angular.extend(l,{},n.map||{})),n.stack&&(l.stack="total"),"radar"===i&&(l.data=a.data),o.push(l)}),o}function i(t,r,a){var n={data:[]};return e(a)?(t[0]&&angular.forEach(t[0].datapoints,function(e){n.data.push(e.x)}),n.orient="verticle",n.x="right",n.y="center"):(angular.forEach(t,function(e){n.data.push(e.name)}),n.orient="horizontal"),angular.extend(n,r.legend||{})}function o(e,t,r){var a={};switch(r){case"line":case"area":a.trigger="axis";break;case"pie":case"donut":case"bar":case"map":case"gauge":a.trigger="item"}return"pie"===r&&(a.formatter="{a} <br/>{b}: {c} ({d}%)"),"map"===r&&(a.formatter="{b}"),angular.extend(a,angular.isObject(t.tooltip)?t.tooltip:{})}function s(t,r,a){return angular.isObject(r.title)?r.title:e(a)?null:{text:r.title,subtext:r.subtitle||"",x:50}}function l(e,t){return t||(t=function(e){return Math.round(100*e)/100}),e=Math.abs(e),e>=1e12?t(e/1e12)+"T":e>=1e9?t(e/1e9)+"B":e>=1e6?t(e/1e6)+"M":e>=1e3?t(e/1e3)+"K":1>e&&e>0?t(e):0===e?"":t(e)}return{isPieChart:e,isAxisChart:r,getAxisTicks:a,getSeries:n,getLegend:i,getTooltip:o,getTitle:s,formatKMBT:l}}),angular.module("angular-echarts.theme",[]).factory("theme",["infographic","macarons","shine","dark","blue","green","red",function(e,t,r,a,n,i,o,s){var l={infographic:e,macarons:t,shine:r,dark:a,blue:n,green:i,red:o,grey:s};return{get:function(e){return l[e]?l[e]:{}}}}]),angular.module("angular-echarts.theme").factory("blue",function(){return{color:["#1790cf","#1bb2d8","#99d2dd","#88b0bb","#1c7099","#038cc4","#75abd0","#afd6dd"],title:{itemGap:8,textStyle:{fontWeight:"normal",color:"#1790cf"}},dataRange:{color:["#1178ad","#72bbd0"]},toolbox:{color:["#1790cf","#1790cf","#1790cf","#1790cf"]},tooltip:{backgroundColor:"rgba(0,0,0,0.5)",axisPointer:{type:"line",lineStyle:{color:"#1790cf",type:"dashed"},crossStyle:{color:"#1790cf"},shadowStyle:{color:"rgba(200,200,200,0.3)"}}},dataZoom:{dataBackgroundColor:"#eee",fillerColor:"rgba(144,197,237,0.2)",handleColor:"#1790cf"},grid:{borderWidth:0},categoryAxis:{axisLine:{lineStyle:{color:"#1790cf"}},splitLine:{lineStyle:{color:["#eee"]}}},valueAxis:{axisLine:{lineStyle:{color:"#1790cf"}},splitArea:{show:!0,areaStyle:{color:["rgba(250,250,250,0.1)","rgba(200,200,200,0.1)"]}},splitLine:{lineStyle:{color:["#eee"]}}},timeline:{lineStyle:{color:"#1790cf"},controlStyle:{normal:{color:"#1790cf"},emphasis:{color:"#1790cf"}}},k:{itemStyle:{normal:{color:"#1bb2d8",color0:"#99d2dd",lineStyle:{width:1,color:"#1c7099",color0:"#88b0bb"}}}},map:{itemStyle:{normal:{areaStyle:{color:"#ddd"},label:{textStyle:{color:"#c12e34"}}},emphasis:{areaStyle:{color:"#99d2dd"},label:{textStyle:{color:"#c12e34"}}}}},force:{itemStyle:{normal:{linkStyle:{strokeColor:"#1790cf"}}}},chord:{padding:4,itemStyle:{normal:{lineStyle:{width:1,color:"rgba(128, 128, 128, 0.5)"},chordStyle:{lineStyle:{width:1,color:"rgba(128, 128, 128, 0.5)"}}},emphasis:{lineStyle:{width:1,color:"rgba(128, 128, 128, 0.5)"},chordStyle:{lineStyle:{width:1,color:"rgba(128, 128, 128, 0.5)"}}}}},gauge:{startAngle:225,endAngle:-45,axisLine:{show:!0,lineStyle:{color:[[.2,"#1bb2d8"],[.8,"#1790cf"],[1,"#1c7099"]],width:8}},axisTick:{splitNumber:10,length:12,lineStyle:{color:"auto"}},axisLabel:{textStyle:{color:"auto"}},splitLine:{length:18,lineStyle:{color:"auto"}},pointer:{length:"90%",color:"auto"},title:{textStyle:{color:"#333"}},detail:{textStyle:{color:"auto"}}},textStyle:{fontFamily:"微软雅黑, Arial, Verdana, sans-serif"}}}),angular.module("angular-echarts.theme").factory("dark",function(){return{backgroundColor:"#1b1b1b",color:["#FE8463","#9BCA63","#FAD860","#60C0DD","#0084C6","#D7504B","#C6E579","#26C0C0","#F0805A","#F4E001","#B5C334"],title:{itemGap:8,textStyle:{fontWeight:"normal",color:"#fff"}},legend:{itemGap:8,textStyle:{color:"#ccc"}},dataRange:{itemWidth:15,color:["#FFF808","#21BCF9"],textStyle:{color:"#ccc"}},toolbox:{color:["#fff","#fff","#fff","#fff"],effectiveColor:"#FE8463",disableColor:"#666",itemGap:8},tooltip:{backgroundColor:"rgba(250,250,250,0.8)",axisPointer:{type:"line",lineStyle:{color:"#aaa"},crossStyle:{color:"#aaa"},shadowStyle:{color:"rgba(200,200,200,0.2)"}},textStyle:{color:"#333"}},dataZoom:{dataBackgroundColor:"#555",fillerColor:"rgba(200,200,200,0.2)",handleColor:"#eee"},grid:{borderWidth:0},categoryAxis:{axisLine:{show:!1},axisTick:{show:!1},axisLabel:{textStyle:{color:"#ccc"}},splitLine:{show:!1}},valueAxis:{axisLine:{show:!1},axisTick:{show:!1},axisLabel:{textStyle:{color:"#ccc"}},splitLine:{lineStyle:{color:["#aaa"],type:"dashed"}},splitArea:{show:!1}},polar:{name:{textStyle:{color:"#ccc"}},axisLine:{lineStyle:{color:"#ddd"}},splitArea:{show:!0,areaStyle:{color:["rgba(250,250,250,0.2)","rgba(200,200,200,0.2)"]}},splitLine:{lineStyle:{color:"#ddd"}}},timeline:{label:{textStyle:{color:"#ccc"}},lineStyle:{color:"#aaa"},controlStyle:{normal:{color:"#fff"},emphasis:{color:"#FE8463"}},symbolSize:3},line:{smooth:!0},k:{itemStyle:{normal:{color:"#FE8463",color0:"#9BCA63",lineStyle:{width:1,color:"#FE8463",color0:"#9BCA63"}}}},radar:{symbol:"emptyCircle",symbolSize:3},pie:{itemStyle:{normal:{borderWidth:1,borderColor:"rgba(255, 255, 255, 0.5)"},emphasis:{borderWidth:1,borderColor:"rgba(255, 255, 255, 1)"}}},map:{itemStyle:{normal:{borderColor:"rgba(255, 255, 255, 0.5)",areaStyle:{color:"#ddd"},label:{textStyle:{color:"#ccc"}}},emphasis:{areaStyle:{color:"#FE8463"},label:{textStyle:{color:"ccc"}}}}},force:{itemStyle:{normal:{linkStyle:{strokeColor:"#fff"}}}},chord:{padding:4,itemStyle:{normal:{lineStyle:{width:1,color:"rgba(228, 228, 228, 0.2)"},chordStyle:{lineStyle:{width:1,color:"rgba(228, 228, 228, 0.2)"}}},emphasis:{lineStyle:{width:1,color:"rgba(228, 228, 228, 0.9)"},chordStyle:{lineStyle:{width:1,color:"rgba(228, 228, 228, 0.9)"}}}}},gauge:{startAngle:225,endAngle:-45,axisLine:{show:!0,lineStyle:{color:[[.2,"#9BCA63"],[.8,"#60C0DD"],[1,"#D7504B"]],width:3,shadowColor:"#fff",shadowBlur:10}},axisTick:{length:15,lineStyle:{color:"auto",shadowColor:"#fff",shadowBlur:10}},axisLabel:{textStyle:{fontWeight:"bolder",color:"#fff",shadowColor:"#fff",shadowBlur:10}},splitLine:{length:25,lineStyle:{width:3,color:"#fff",shadowColor:"#fff",shadowBlur:10}},pointer:{shadowColor:"#fff",shadowBlur:5},title:{textStyle:{fontWeight:"bolder",fontSize:20,fontStyle:"italic",color:"#fff",shadowColor:"#fff",shadowBlur:10}},detail:{shadowColor:"#fff",shadowBlur:5,offsetCenter:[0,"50%"],textStyle:{fontWeight:"bolder",color:"#fff"}}},funnel:{itemStyle:{normal:{borderColor:"rgba(255, 255, 255, 0.5)",borderWidth:1},emphasis:{borderColor:"rgba(255, 255, 255, 1)",borderWidth:1}}},textStyle:{fontFamily:"微软雅黑, Arial, Verdana, sans-serif"}}}),angular.module("angular-echarts.theme").factory("green",function(){return{color:["#408829","#68a54a","#a9cba2","#86b379","#397b29","#8abb6f","#759c6a","#bfd3b7"],title:{itemGap:8,textStyle:{fontWeight:"normal",color:"#408829"}},dataRange:{color:["#1f610a","#97b58d"]},toolbox:{color:["#408829","#408829","#408829","#408829"]},tooltip:{backgroundColor:"rgba(0,0,0,0.5)",axisPointer:{type:"line",lineStyle:{color:"#408829",type:"dashed"},crossStyle:{color:"#408829"},shadowStyle:{color:"rgba(200,200,200,0.3)"}}},dataZoom:{dataBackgroundColor:"#eee",fillerColor:"rgba(64,136,41,0.2)",handleColor:"#408829"},grid:{borderWidth:0},categoryAxis:{axisLine:{lineStyle:{color:"#408829"}},splitLine:{lineStyle:{color:["#eee"]}}},valueAxis:{axisLine:{lineStyle:{color:"#408829"}},splitArea:{show:!0,areaStyle:{color:["rgba(250,250,250,0.1)","rgba(200,200,200,0.1)"]}},splitLine:{lineStyle:{color:["#eee"]}}},timeline:{lineStyle:{color:"#408829"},controlStyle:{normal:{color:"#408829"},emphasis:{color:"#408829"}}},k:{itemStyle:{normal:{color:"#68a54a",color0:"#a9cba2",lineStyle:{width:1,color:"#408829",color0:"#86b379"}}}},map:{itemStyle:{normal:{areaStyle:{color:"#ddd"},label:{textStyle:{color:"#c12e34"}}},emphasis:{areaStyle:{color:"#99d2dd"},label:{textStyle:{color:"#c12e34"}}}}},force:{itemStyle:{normal:{linkStyle:{strokeColor:"#408829"}}}},chord:{padding:4,itemStyle:{normal:{lineStyle:{width:1,color:"rgba(128, 128, 128, 0.5)"},chordStyle:{lineStyle:{width:1,color:"rgba(128, 128, 128, 0.5)"}}},emphasis:{lineStyle:{width:1,color:"rgba(128, 128, 128, 0.5)"},chordStyle:{lineStyle:{width:1,color:"rgba(128, 128, 128, 0.5)"}}}}},gauge:{startAngle:225,endAngle:-45,axisLine:{show:!0,lineStyle:{color:[[.2,"#86b379"],[.8,"#68a54a"],[1,"#408829"]],width:8}},axisTick:{splitNumber:10,length:12,lineStyle:{color:"auto"}},axisLabel:{textStyle:{color:"auto"}},splitLine:{length:18,lineStyle:{color:"auto"}},pointer:{length:"90%",color:"auto"},title:{textStyle:{color:"#333"}},detail:{textStyle:{color:"auto"}}},textStyle:{fontFamily:"微软雅黑, Arial, Verdana, sans-serif"}}}),angular.module("angular-echarts.theme").factory("infographic",function(){return{color:["#C1232B","#B5C334","#FCCE10","#E87C25","#27727B","#FE8463","#9BCA63","#FAD860","#F3A43B","#60C0DD","#D7504B","#C6E579","#F4E001","#F0805A","#26C0C0"],title:{itemGap:8,textStyle:{fontWeight:"normal",color:"#27727B"}},legend:{itemGap:8},dataRange:{x:"right",y:"center",itemWidth:5,itemHeight:25,color:["#C1232B","#FCCE10"]},toolbox:{color:["#C1232B","#B5C334","#FCCE10","#E87C25","#27727B","#FE8463","#9BCA63","#FAD860","#F3A43B","#60C0DD"],effectiveColor:"#ff4500",itemGap:8},tooltip:{backgroundColor:"rgba(50,50,50,0.5)",axisPointer:{type:"line",lineStyle:{color:"#27727B",type:"dashed"},crossStyle:{color:"#27727B"},shadowStyle:{color:"rgba(200,200,200,0.3)"}}},dataZoom:{dataBackgroundColor:"rgba(181,195,52,0.3)",fillerColor:"rgba(181,195,52,0.2)",handleColor:"#27727B"},grid:{borderWidth:0},categoryAxis:{axisLine:{lineStyle:{color:"#27727B"}},splitLine:{show:!1}},valueAxis:{axisLine:{show:!1},splitArea:{show:!1},splitLine:{lineStyle:{color:["#ccc"],type:"dashed"}}},polar:{axisLine:{lineStyle:{color:"#ddd"}},splitArea:{show:!0,areaStyle:{color:["rgba(250,250,250,0.2)","rgba(200,200,200,0.2)"]}},splitLine:{lineStyle:{color:"#ddd"}}},timeline:{lineStyle:{color:"#27727B"},controlStyle:{normal:{color:"#27727B"},emphasis:{color:"#27727B"}},symbol:"emptyCircle",symbolSize:3},bar:{itemStyle:{normal:{borderRadius:0},emphasis:{borderRadius:0}}},line:{itemStyle:{normal:{borderWidth:2,borderColor:"#fff",lineStyle:{width:3}},emphasis:{borderWidth:0}},symbol:"circle",symbolSize:3.5},k:{itemStyle:{normal:{color:"#C1232B",color0:"#B5C334",lineStyle:{width:1,color:"#C1232B",color0:"#B5C334"}}}},scatter:{itemdStyle:{normal:{borderWidth:1,borderColor:"rgba(200,200,200,0.5)"},emphasis:{borderWidth:0}},symbol:"star4",symbolSize:4},radar:{symbol:"emptyCircle",symbolSize:3},map:{itemStyle:{normal:{areaStyle:{color:"#ddd"},label:{textStyle:{color:"#C1232B"}}},emphasis:{areaStyle:{color:"#fe994e"},label:{textStyle:{color:"rgb(100,0,0)"}}}}},force:{itemStyle:{normal:{linkStyle:{strokeColor:"#27727B"}}}},chord:{padding:4,itemStyle:{normal:{lineStyle:{width:1,color:"rgba(128, 128, 128, 0.5)"},chordStyle:{lineStyle:{width:1,color:"rgba(128, 128, 128, 0.5)"}}},emphasis:{lineStyle:{width:1,color:"rgba(128, 128, 128, 0.5)"},chordStyle:{lineStyle:{width:1,color:"rgba(128, 128, 128, 0.5)"}}}}},gauge:{center:["50%","80%"],radius:"100%",startAngle:180,endAngle:0,axisLine:{show:!0,lineStyle:{color:[[.2,"#B5C334"],[.8,"#27727B"],[1,"#C1232B"]],width:"40%"}},axisTick:{splitNumber:2,length:5,lineStyle:{color:"#fff"}},axisLabel:{textStyle:{color:"#fff",fontWeight:"bolder"}},splitLine:{length:"5%",lineStyle:{color:"#fff"}},pointer:{width:"40%",length:"80%",color:"#fff"},title:{offsetCenter:[0,-20],textStyle:{color:"auto",fontSize:20}},detail:{offsetCenter:[0,0],textStyle:{color:"auto",fontSize:40}}},textStyle:{fontFamily:"微软雅黑, Arial, Verdana, sans-serif"}}}),angular.module("angular-echarts.theme").factory("macarons",function(){return{color:["#2ec7c9","#b6a2de","#5ab1ef","#ffb980","#d87a80","#8d98b3","#e5cf0d","#97b552","#95706d","#dc69aa","#07a2a4","#9a7fd1","#588dd5","#f5994e","#c05050","#59678c","#c9ab00","#7eb00a","#6f5553","#c14089"],title:{itemGap:8,textStyle:{fontWeight:"normal",color:"#008acd"}},legend:{itemGap:8},dataRange:{itemWidth:15,color:["#2ec7c9","#b6a2de"]},toolbox:{color:["#1e90ff","#1e90ff","#1e90ff","#1e90ff"],effectiveColor:"#ff4500",itemGap:8},tooltip:{backgroundColor:"rgba(50,50,50,0.5)",axisPointer:{type:"line",lineStyle:{color:"#008acd",type:"dashed",width:1},crossStyle:{color:"#008acd",width:1},shadowStyle:{color:"rgba(200,200,200,0.2)"}}},dataZoom:{dataBackgroundColor:"#efefff",fillerColor:"rgba(182,162,222,0.2)",handleColor:"#008acd"},grid:{borderColor:"#eee"},categoryAxis:{axisLine:{lineStyle:{color:"#008acd",width:1}},axisLabel:{skipFirst:!0,margin:3,textStyle:{color:"#999999"}},axisTick:{show:!1,lineStyle:{color:"#008acd",width:1}},splitLine:{lineStyle:{color:["#eee"]}}},valueAxis:{axisLine:{lineStyle:{color:"#008acd",width:1}},axisLabel:{skipFirst:!0,margin:3,textStyle:{color:"#999999"}},axisTick:{show:!1,lineStyle:{color:"#008acd",width:1}},splitArea:{show:!0,areaStyle:{color:["rgba(250,250,250,0.1)","rgba(200,200,200,0.1)"]}},splitLine:{lineStyle:{color:["#eee"]}}},polar:{axisLine:{lineStyle:{color:"#ddd"}},splitArea:{show:!0,areaStyle:{color:["rgba(250,250,250,0.2)","rgba(200,200,200,0.2)"]}},splitLine:{lineStyle:{color:"#ddd"}}},timeline:{lineStyle:{color:"#008acd"},controlStyle:{normal:{color:"#008acd"},emphasis:{color:"#008acd"}},symbol:"emptyCircle",symbolSize:3},bar:{itemStyle:{normal:{borderRadius:5},emphasis:{borderRadius:5}}},line:{smooth:!1,symbol:"circle",symbolSize:3},k:{itemStyle:{normal:{color:"#d87a80",color0:"#2ec7c9",lineStyle:{width:1,color:"#d87a80",color0:"#2ec7c9"}}}},scatter:{symbol:"circle",symbolSize:4},radar:{symbol:"emptyCircle",symbolSize:3},map:{itemStyle:{normal:{areaStyle:{color:"#ddd"},label:{textStyle:{color:"#d87a80"}}},emphasis:{areaStyle:{color:"#fe994e"},label:{textStyle:{color:"rgb(100,0,0)"}}}}},force:{itemStyle:{normal:{linkStyle:{strokeColor:"#1e90ff"}}}},chord:{padding:4,itemStyle:{normal:{lineStyle:{width:1,color:"rgba(128, 128, 128, 0.5)"},chordStyle:{lineStyle:{width:1,color:"rgba(128, 128, 128, 0.5)"}}},emphasis:{lineStyle:{width:1,color:"rgba(128, 128, 128, 0.5)"},chordStyle:{lineStyle:{width:1,color:"rgba(128, 128, 128, 0.5)"}}}}},gauge:{startAngle:225,endAngle:-45,axisLine:{show:!0,lineStyle:{color:[[.2,"#2ec7c9"],[.8,"#5ab1ef"],[1,"#d87a80"]],width:10}},axisTick:{splitNumber:10,length:15,lineStyle:{color:"auto"}},axisLabel:{textStyle:{color:"auto"}},splitLine:{length:22,lineStyle:{color:"auto"}},pointer:{width:5,color:"auto"},title:{textStyle:{color:"#333"}},detail:{textStyle:{color:"auto"}}},textStyle:{fontFamily:"微软雅黑, Arial, Verdana, sans-serif"}}}),angular.module("angular-echarts.theme").factory("red",function(){return{color:["#d8361b","#f16b4c","#f7b4a9","#d26666","#99311c","#c42703","#d07e75"],title:{itemGap:8,textStyle:{fontWeight:"normal",color:"#d8361b"}},dataRange:{color:["#bd0707","#ffd2d2"]},toolbox:{color:["#d8361b","#d8361b","#d8361b","#d8361b"]},tooltip:{backgroundColor:"rgba(0,0,0,0.5)",axisPointer:{type:"line",lineStyle:{color:"#d8361b",type:"dashed"},crossStyle:{color:"#d8361b"},shadowStyle:{color:"rgba(200,200,200,0.3)"}}},dataZoom:{dataBackgroundColor:"#eee",fillerColor:"rgba(216,54,27,0.2)",handleColor:"#d8361b"},grid:{borderWidth:0},categoryAxis:{axisLine:{lineStyle:{color:"#d8361b"}},splitLine:{lineStyle:{color:["#eee"]}}},valueAxis:{axisLine:{lineStyle:{color:"#d8361b"}},splitArea:{show:!0,areaStyle:{color:["rgba(250,250,250,0.1)","rgba(200,200,200,0.1)"]}},splitLine:{lineStyle:{color:["#eee"]}}},timeline:{lineStyle:{color:"#d8361b"},controlStyle:{normal:{color:"#d8361b"},emphasis:{color:"#d8361b"}}},k:{itemStyle:{normal:{color:"#f16b4c",color0:"#f7b4a9",lineStyle:{width:1,color:"#d8361b",color0:"#d26666"}}}},map:{itemStyle:{normal:{areaStyle:{color:"#ddd"},label:{textStyle:{color:"#c12e34"}}},emphasis:{areaStyle:{color:"#99d2dd"},label:{textStyle:{color:"#c12e34"}}}}},force:{itemStyle:{normal:{linkStyle:{strokeColor:"#d8361b"}}}},chord:{padding:4,itemStyle:{normal:{lineStyle:{width:1,color:"rgba(128, 128, 128, 0.5)"},chordStyle:{lineStyle:{width:1,color:"rgba(128, 128, 128, 0.5)"}}},emphasis:{lineStyle:{width:1,color:"rgba(128, 128, 128, 0.5)"},chordStyle:{lineStyle:{width:1,color:"rgba(128, 128, 128, 0.5)"}}}}},gauge:{startAngle:225,endAngle:-45,axisLine:{show:!0,lineStyle:{color:[[.2,"#f16b4c"],[.8,"#d8361b"],[1,"#99311c"]],width:8}},axisTick:{splitNumber:10,length:12,lineStyle:{color:"auto"}},axisLabel:{
textStyle:{color:"auto"}},splitLine:{length:18,lineStyle:{color:"auto"}},pointer:{length:"90%",color:"auto"},title:{textStyle:{color:"#333"}},detail:{textStyle:{color:"auto"}}},textStyle:{fontFamily:"微软雅黑, Arial, Verdana, sans-serif"}}}),angular.module("angular-echarts.theme").factory("shine",function(){return{color:["#c12e34","#e6b600","#0098d9","#2b821d","#005eaa","#339ca8","#cda819","#32a487"],title:{itemGap:8,textStyle:{fontWeight:"normal"}},legend:{itemGap:8},dataRange:{itemWidth:15,color:["#1790cf","#a2d4e6"]},toolbox:{color:["#06467c","#00613c","#872d2f","#c47630"],itemGap:8},tooltip:{backgroundColor:"rgba(0,0,0,0.6)"},dataZoom:{dataBackgroundColor:"#dedede",fillerColor:"rgba(154,217,247,0.2)",handleColor:"#005eaa"},grid:{borderWidth:0},categoryAxis:{axisLine:{show:!1},axisTick:{show:!1}},valueAxis:{axisLine:{show:!1},axisTick:{show:!1},splitArea:{show:!0,areaStyle:{color:["rgba(250,250,250,0.2)","rgba(200,200,200,0.2)"]}}},timeline:{lineStyle:{color:"#005eaa"},controlStyle:{normal:{color:"#005eaa"},emphasis:{color:"#005eaa"}}},k:{itemStyle:{normal:{color:"#c12e34",color0:"#2b821d",lineStyle:{width:1,color:"#c12e34",color0:"#2b821d"}}}},map:{itemStyle:{normal:{areaStyle:{color:"#ddd"},label:{textStyle:{color:"#c12e34"}}},emphasis:{areaStyle:{color:"#e6b600"},label:{textStyle:{color:"#c12e34"}}}}},force:{itemStyle:{normal:{linkStyle:{strokeColor:"#005eaa"}}}},chord:{padding:4,itemStyle:{normal:{lineStyle:{width:1,color:"rgba(128, 128, 128, 0.5)"},chordStyle:{lineStyle:{width:1,color:"rgba(128, 128, 128, 0.5)"}}},emphasis:{lineStyle:{width:1,color:"rgba(128, 128, 128, 0.5)"},chordStyle:{lineStyle:{width:1,color:"rgba(128, 128, 128, 0.5)"}}}}},gauge:{startAngle:225,endAngle:-45,axisLine:{show:!0,lineStyle:{color:[[.2,"#2b821d"],[.8,"#005eaa"],[1,"#c12e34"]],width:5}},axisTick:{splitNumber:10,length:8,lineStyle:{color:"auto"}},axisLabel:{textStyle:{color:"auto"}},splitLine:{length:12,lineStyle:{color:"auto"}},pointer:{length:"90%",width:3,color:"auto"},title:{textStyle:{color:"#333"}},detail:{textStyle:{color:"auto"}}},textStyle:{fontFamily:"微软雅黑, Arial, Verdana, sans-serif"}}})}();var Widget=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!1;_classCallCheck(this,e),this._scheduledResize=!1,this.data=t,this.drawCommnads=r,this._draw=!1,r&&this.drawCommnads.drawtype?this.drawType=this.drawCommnads.drawtype.toUpperCase():this.drawType=!1,this.error=this.data.error,this.text=this.data.text,this.name="Widget",this.sizeX=3,this.sizeY=1,this.element=!1,this.init=!1,this.type=!1,this.isDark=angular.element("*[ng-app]").injector().get("ThemeService").isDark()}return _createClass(e,[{key:"onDrag",value:function(){}},{key:"onResize",value:function(){}},{key:"scheduledResize",value:function(){if(!this._scheduledResize){this._scheduledResize=!0;var e=this;setTimeout(function(){e._scheduledResize=!1,e.onResize()},900)}}},{key:"toString",value:function(){return"("+this.name+", "+this.y+")"}}]),e}(),WidgetTable=function(e){function t(e,r,a,n){_classCallCheck(this,t);var i=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r));if(i.type="table",i.table={},i.sort=!1,i.hotId="hotIdTable"+Math.floor(1e7*Math.random()),i.error)return i.sizeY=1,i.sizeX=6,i.init=!1,_possibleConstructorReturn(i);if(i.text)return i.sizeY=2,i.sizeX=6,i.init=!1,_possibleConstructorReturn(i);i.hotRegisterer=!1;var o=new HandsTable(i);i.table={settings:o.makeSettings()};var s=o.countColumns(),l=1;return s>2&&(l=2),s>5&&(l=3),s>10&&(l=4),s>15&&(l=6),"statistics"==i.data.sourceType&&(l=6),i.sizeX=l,i.sizeY=1,i.data.rows>60&&(i.sizeY=2),i.data.rows>250&&(i.sizeY=3),i.data.rows>500&&(i.sizeY=4),1==i.data.countAll&&(i.sizeX=6,i.sizeY=4),_.isNumber(a)&&(i.sizeX=a),_.isNumber(n)&&(i.sizeY=n),i.init=!0,i}return t.$inject=["DataProvider","draw","sizeX","sizeY"],_inherits(t,e),_createClass(t,[{key:"preProcessor",value:function(){}},{key:"onDrag",value:function(){this.onResize()}},{key:"getInstanceHandsontable",value:function(){return this.hotRegisterer&&this.init&&this.element&&this.hotId?this.hotRegisterer.getInstance(this.hotId):void 0}},{key:"onResize",value:function(){if(this.table){var e=this.getInstanceHandsontable();e&&(e.updateSettings({}),e.render())}}}]),t}(Widget);angular.module(smi2.app.name).service("WidgetTable",WidgetTable);/*
 * Licensed under the Apache License, Version 2.0 Copyright 2017 Igor Strykhar,Ivan Kudinov,SMI2 LLC and other contributors
 */
var WidgetPivot=function(e){function t(e,r){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r));return a.type="pivot",a.error||a.text?_possibleConstructorReturn(a):(a.init=!0,a.renderers=$.extend($.pivotUtilities.renderers,$.pivotUtilities.c3_renderers,$.pivotUtilities.d3_renderers,$.pivotUtilities.export_renderers,$.pivotUtilities.subtotal_renderers),a.pivot={config:{dataClass:$.pivotUtilities.SubtotalPivotData,renderer:a.renderers}},1==a.data.countAll&&(a.sizeX=6,a.sizeY=3),a)}return t.$inject=["DataProvider","draw"],_inherits(t,e),t}(Widget);angular.module(smi2.app.name).service("WidgetPivot",WidgetPivot);/*
 * Licensed under the Apache License, Version 2.0 Copyright 2017 Igor Strykhar,Ivan Kudinov,SMI2 LLC and other contributors
 */
var WidgetDraw=function(e){function t(e,r,a,n){_classCallCheck(this,t);var i=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r));return i.type="draw",i.error||i.text?_possibleConstructorReturn(i):(i.library=!1,i.sizeY=2,i._list={HEATMAP:DrawEchartsHeatmap,CALENDAR:DrawEchartsCalendar,RAW:DrawEchartsMap,BAR:DrawEchartsBar,RIVER:DrawEchartsRiver,MAP:DrawEchartsMap,GMAPS:DrawGoogleMap,TREEMAP:DrawEchartsTreemap,SANKEYS:DrawEchartsSunkeys,CHART:DrawEchartsChart,GRIDCHART:DrawEchartsGridChart,TEXT:DrawText,D3:DrawD3,C3:DrawC3},i.init=i.getChartClass(),"TEXT"==i.drawType&&(i.sizeX=0,i.sizeY=0),_.isNumber(a)&&(i.sizeX=a),_.isNumber(n)&&(i.sizeY=n),1==i.data.countAll&&(i.sizeX=6,i.sizeY=2),i)}return t.$inject=["DataProvider","draw","sizeX","sizeY"],_inherits(t,e),_createClass(t,[{key:"onResize",value:function(){this._draw&&this._draw.onResize()}},{key:"getChartClass",value:function(){return this.drawType||(this.drawType="CHART",console.error("Un support DrawType:null")),this._list[this.drawType]?!0:(console.error("Un support DrawType:"+this.drawType),!1)}},{key:"draw",get:function(){return this.drawType&&!this._draw&&(this._draw=new this._list[this.drawType](this,this.drawType)),this._draw}}]),t}(Widget);angular.module(smi2.app.name).service("WidgetDraw",WidgetDraw);var HandsTable=function(){function e(t){_classCallCheck(this,e),this.WidgetTable=t,this.isDarkTheme=t.isDark,window.isDarkTheme=this.isDarkTheme,this.meta=t.data.meta}return e.$inject=["WidgetTable"],_createClass(e,[{key:"_handsRenderer",value:function(e,t,r,a,n,i,o){"numeric"==o.type?null==i?(arguments[5]="NULL",t.style.color="silver",Handsontable.renderers.TextRenderer.apply(this,arguments)):Handsontable.renderers.NumericRenderer.apply(this,arguments):"date"==o.type||"time"==o.type?(moment(new Date(i)).isValid()&&o.renderDateFormat&&(i=moment(i).format(o.renderDateFormat)),arguments[5]=i,Handsontable.renderers.TextRenderer.apply(this,arguments)):Handsontable.renderers.TextRenderer.apply(this,arguments),o.backgroundColor&&(t.style.backgroundColor=o.backgroundColor),o.color&&(t.style.color=o.color)}},{key:"countColumns",value:function(){return this.meta.length}},{key:"makeColumns",value:function(){var e=this,t=[],r=[],a={},n=0;return this.meta.forEach(function(i){a[i.name]=n,n++,t.push(i.name);var o={};switch(o.type="text",o.width=100,o.typeOriginal=i.type,o.isDark=e.isDarkTheme,i.type.includes("Int")&&(o.width=80,o.type="numeric"),i.type){case"Date":o.width=90,o.type="date",o.dateFormat="YYYY-MM-DD";break;case"DateTime":o.width=150,o.type="time",o.timeFormat="YYYY-MM-DD HH:mm:ss";break;case"Float32":o.width=80,o.type="numeric",o.format="0.[0000000]";break;case"Float64":o.width=80,o.type="numeric",o.format="0.[0000000]";break;case"String":o.width=180}o.renderer=e._handsRenderer,o.data=i.name,r.push(o)}),{colHeaders:t,columns:r,colPositions:a}}},{key:"makeSettings",value:function(){var t=this.makeColumns(),r={dropdownMenu:!0,manualColumnMove:!0,manualColumnResize:!0,rowHeaders:!0,colWidths:100,fillHandle:!1,persistentState:!0,customBorders:!0,isDark:this.isDarkTheme,filters:!0,columnSorting:!0,sortIndicator:!0,manualRowResize:!0,wordWrap:!1,autoColumnSize:{samplingRatio:23},preventOverflow:"horizontal",visibleRows:120,columns:t.columns,colHeaders:t.colHeaders,contextMenu:{items:{columnformat:{name:"Column format",submenu:{items:[{name:"Reset",key:"columnformat:1",callback:function(t,r,a){e.makeFormat(this,"Reset")}},{name:"Money",key:"columnformat:2",callback:function(t,r,a){e.makeFormat(this,"Money")},disabled:function(){return!e.isFormatColl(this,"numeric")}},{name:"Human",key:"columnformat:3",callback:function(t,r,a){e.makeFormat(this,"Human")},disabled:function(){return!e.isFormatColl(this,"numeric")}},{name:"Bytes",key:"columnformat:4",callback:function(t,r,a){e.makeFormat(this,"Bytes")},disabled:function(){return!e.isFormatColl(this,"numeric")}},{name:"Percentages",key:"columnformat:5",callback:function(t,r,a){e.makeFormat(this,"Percentages")},disabled:function(){return!e.isFormatColl(this,"numeric")}},{name:"Time only",key:"columnformat:6",callback:function(t,r,a){e.makeFormat(this,"Time")},disabled:function(){return!e.isFormatColl(this,"Time")}},{name:"Date only",key:"columnformat:7",callback:function(t,r,a){e.makeFormat(this,"Date")},disabled:function(){return!e.isFormatColl(this,"Date")}},{name:"Date loc.",key:"columnformat:8",callback:function(t,r,a){e.makeFormat(this,"DateLoc")},disabled:function(){return!e.isFormatColl(this,"Date")}},{name:"Float",key:"columnformat:9",callback:function(t,r,a){e.makeFormat(this,"Float")},disabled:function(){return!e.isFormatColl(this,"numeric")}},{name:"Heatmaps",key:"columnformat:10",callback:function(t,r,a){e.makeHeatmaps(this,"Heatmaps")},disabled:function(){return!e.isFormatColl(this,"numeric")}},{name:"Negative & Positive",key:"columnformat:11",callback:function(t,r,a){e.makeHeatmaps(this,"NegaPosi")},disabled:function(){return!e.isFormatColl(this,"numeric")}}]}},style:{name:"Style",submenu:{items:[{name:"Normal",callback:function(t,r,a){e.makeStyle(this,"Normal")},key:"style:normal"},{name:"Bold",callback:function(t,r){e.makeStyle(this,"Bold")},key:"style:makebold"},{name:"Red color",callback:function(t,r){e.makeStyle(this,"Red")},key:"style:red"},{name:"Green color",callback:function(t,r){e.makeStyle(this,"Green")},key:"style:green"},{name:"Yellow color",callback:function(t,r){e.makeStyle(this,"Yellow")},key:"style:green"},{name:"Orange color",callback:function(t,r){e.makeStyle(this,"Orange")},key:"style:green"}]}},hsep1:"---------",copyTo:{name:"To Clipboard",submenu:{items:[{name:"Redmine Markdown",callback:function(t,r,a){console.info("copyToClipboard"),e.copyToClipboard(this,"Redmine")},key:"copyTo:1"},{name:"Redmine Markdown (full)",callback:function(t,r,a){console.info("copyToClipboard"),e.copyToClipboard(this,"Redmine",!0)},key:"copyTo:2"},{name:"WHERE col1 IN (val,val),col2 IN ...",callback:function(t,r,a){console.info("makeWhereIn"),e.makeWhereIn(this)},key:"copyTo:3"},{name:"Create TABLE...",callback:function(t,r,a){e.makeCreateTable(this)},key:"copyTo:4"}]}},hsep2:"---------",undo:{},make_read_only:{},alignment:{},hsep3:"---------"}},currentRowClassName:this.isDarkTheme?"currentRowDark":"currentRowWhite",currentColClassName:"currentCol"};return this.WidgetTable.data.sort&&this.WidgetTable.data.sortOrder&&(r.columnSorting={column:t.colPositions[this.WidgetTable.data.sort],sortOrder:"desc"==this.WidgetTable.data.sortOrder.toLowerCase()?!1:!0}),r}}],[{key:"isDark",value:function(){return window.isDarkTheme}},{key:"makeHeatmaps",value:function(e,t){console.info("isDark",window.isDarkTheme),console.warn(e.getCellMeta(0,0,"isDark"));for(var r=e.getSelectedRange(),a=Math.min(r.from.col,r.to.col),n=Math.max(r.from.col,r.to.col),i="#a900e5",o="#3668ff",s=chroma.scale([i,o]),l=a;n>=l;l++){var c=e.countRows(),d=e.getDataAtCol(l),u=Math.min.apply(null,d),m=Math.max.apply(null,d);if(null!==u&&null!==m)for(var b=0;c>=b;b++){var h=parseFloat(e.getDataAtCell(b,l));if("Heatmaps"==t){var p=(h-u)/(m-u),g=s(p).hex(),f=e.getCellMeta(b,l);f&&e.setCellMeta(b,l,"backgroundColor",g)}if("NegaPosi"==t){var v=!1;0>h&&(v="#e27137"),h>0&&(v="#31b3e5");var y=e.getCellMeta(b,l);y&&v&&e.setCellMeta(b,l,"color",v)}}else console.warn("Can`t find Min&Max in column",l)}e.render()}},{key:"getSelected",value:function(e,t,r){var a=e.getSelectedRange(),n=!1;if(!a&&t||r)return{isSelection:!1,fromRow:0,toRow:e.countRows(),toCol:e.countCols(),fromCol:0};if(!a)return{isSelection:!1,fromRow:-1,toRow:-1,toCol:-1,fromCol:-1};var i=Math.min(a.from.col,a.to.col),o=Math.max(a.from.col,a.to.col),s=Math.min(a.from.row,a.to.row),l=Math.max(a.from.row,a.to.row);return{isSelection:n,fromRow:s,toRow:l,toCol:o,fromCol:i}}},{key:"makeFormat",value:function(t,r){for(var a=e.getSelected(t,!0),n=t.getSettings().columns,i=a.fromCol;i<=a.toCol;i++)switch(console.log("makeFormat for coll ="+i,r),r){case"Reset":n[i].format=!1,n[i].renderDateFormat=!1;break;case"Money":n[i].format="$0,0.00";break;case"Human":n[i].format="5a";break;case"Bytes":n[i].format="0.0b";break;case"Percentages":n[i].format="(0.00 %)";break;case"Time":n[i].renderDateFormat="HH:mm:ss";break;case"Date":n[i].renderDateFormat="YYYY-MM-DD";break;case"DateTime":n[i].renderDateFormat="YYYY-MM-DD HH:mm:ss";break;case"DateLoc":n[i].renderDateFormat="LLLL";break;case"Float":n[i].format="0.[0000000]"}t.updateSettings({columns:n}),t.render()}},{key:"isFormatColl",value:function(e,t){t=t.toLowerCase();for(var r=e.getSelectedRange(),a=Math.min(r.from.col,r.to.col),n=Math.max(r.from.col,r.to.col),i=e.getSettings().columns,o=a;n>=o;o++)if(!i[o].type.toLowerCase().includes(t))return!1;return!0}},{key:"pushToClipboardText",value:function(e){var t=document.createElement("textarea");t.style.width=0,t.style.height=0,t.style.border=0,t.style.position="absolute",t.style.top=0,document.body.append(t),t.value=e,t.focus(),t.select();try{document.execCommand("copy")}catch(r){console.log("Oops, unable to copy")}document.body.removeChild(t)}},{key:"makeCreateTable",value:function(t){for(var r=e.getSelected(t,!0),a="\nCREATE TABLE x (\n",n=[],i=t.getSettings().columns,o=r.fromCol;o<=r.toCol;o++){var s=i[o].typeOriginal;n.push("	"+t.colToProp(o)+" "+s)}a=a+n.join(",\n")+"\n)\nENGINE = TinyLog\n;;\n",console.log(a),e.pushToClipboardText(a)}},{key:"makeWhereIn",value:function(t){for(var r=e.getSelected(t,!0),a=[],n=t.getSettings().columns,i=r.fromCol;i<=r.toCol;i++){for(var o=[],s=r.fromRow;s<=r.toRow;s++)o.push(t.getDataAtCell(s,i));var l=o.filter(function(e,t,r){return r.indexOf(e)===t}),c=n[i].type.toLowerCase();c.includes("numeric")?a.push(t.colToProp(i)+" IN ( "+l.join(" , ")+") "):a.push(t.colToProp(i)+" IN ( '"+l.join("' , '")+"') ")}a="\n"+a.join("\n	AND\n")+"\n\n",console.log(a),e.pushToClipboardText(a)}},{key:"copyToClipboard",value:function(t,r,a){for(var n=e.getSelected(t,!0,a),i="",o=[],s=n.fromCol;s<=n.toCol;s++)o.push(t.colToProp(s));i=i+" | "+o.join(" | ")+" |\n",o=[];for(var l=n.fromRow;l<=n.toRow;l++){for(var c=n.fromCol;c<=n.toCol;c++)o.push(t.getDataAtCell(l,c));i=i+" | "+o.join(" | ")+" |\n",o=[]}e.pushToClipboardText(i)}},{key:"makeStyle",value:function(t,r){console.log("makeStyle",r);for(var a=e.getSelected(t,!0),n=a.fromRow;n<=a.toRow;n++)for(var i=a.fromCol;i<=a.toCol;i++){var o=t.getCellMeta(n,i),s="htCell"+r;(!o.className||o.className&&o.className.indexOf(s)<0)&&t.setCellMeta(n,i,"className",s)}t.render()}}]),e}();angular.module(smi2.app.name).service("HandsTable",HandsTable);var DrawBasicChart=function(){function DrawBasicChart(e){_classCallCheck(this,DrawBasicChart),this.widget=e,this.chart=!1,this.init=!1,this.options={},this.widget.height=1,this.widget.width=1,this.errorMessage="",this.drawCodeObject={type:!1};try{this.drawCodeObject=this.initDrawCodeObject()}catch(t){console.error("error eval ",t)}console.info("isExecutableCode()",this.isExecutableCode())}return _createClass(DrawBasicChart,[{key:"setError",value:function(e){this.errorMessage=e;var t="",r="";_.isUndefined(this.help)||(t=this.help),_.isUndefined(this.helpLink)||(r=this.helpLink),this.widget.error="Draw error message:"+e+"\n\n"+t+"\n\n"+(r?'<a target="_blank" href="'+r+'">'+r+"</a>":"")}},{key:"isDark",value:function(){return this.widget.isDark}},{key:"getError",value:function(){return this.errorMessage}},{key:"isExecutableCode",value:function(){return this.drawCodeObject&&this.drawCodeObject.type?this.drawCodeObject.exec:!1}},{key:"executableCode",value:function(){var e={};return this.isExecutableCode()&&(console.log(this.drawCodeObject.code),e=this.drawCodeObject.code.call(window,this.widget.data)),console.warn("ResultFunction",e),e}},{key:"initChartByJsCode",value:function(){if(this.isExecutableCode()){var e=this.executableCode();return this.options=Object.assign(this.options,e),!0}return!1}},{key:"data",value:function(){return this.widget.data.data}},{key:"meta",value:function(){return this.widget.data.meta}},{key:"isNumericColumn",value:function(e){var t=this.getColumnPosition(e);if(!_.isUndefined(t)){var r=this.meta()[t].type;return r?(r=r.toLowerCase(),r.includes("int")||r.includes("float")?!0:!1):!1}}},{key:"isStringColumn",value:function(e){var t=this.getColumnPosition(e);if(!_.isUndefined(t)){var r=this.meta()[t].type;return r?(r=r.toLowerCase(),r.includes("string")||r.includes("enum")?!0:!1):!1}}},{key:"getColumnPosition",value:function(e){return parseInt(_.findKey(this.meta(),{name:e}))}},{key:"haveColumn",value:function(e){if(_.isNaN(e)||_.isNull(e)||_.isUndefined(e))return!1;var t=this.getColumnPosition(e);return _.isNaN(t)||_.isNull(t)||_.isUndefined(t)?!1:!0}},{key:"getColumnByType",value:function(e){var t=_.findIndex(this.meta(),{type:e});return 0>t?!1:this.getColumns(t)}},{key:"getDateTimeColumn",value:function(){return this.getColumnByType("DateTime")}},{key:"getDateColumn",value:function(){return this.getColumnByType("Date")}},{key:"getColumns",value:function(e){var t=_.map(this.meta(),"name");return _.isUndefined(e)?t:t[e]}},{key:"getFirstColumn",value:function(){return this.getColumns(0)}},{key:"getDrawCommandObject",value:function(){return this.drawCodeObject&&this.drawCodeObject.type?this.drawCodeObject.code:!1}},{key:"initDrawCodeObject",value:function initDrawCodeObject(){var drawCommand=this.widget.drawCommnads;if(!drawCommand)return[];var codeDrawText=!1;if(drawCommand&&drawCommand.code&&(codeDrawText=drawCommand.code),!codeDrawText)return[];var draw={code:!1,type:!1};if(_.isObject(codeDrawText))return draw={isok:!0,code:codeDrawText,type:"undefined"==typeof codeDrawText?"undefined":_typeof(codeDrawText),exec:!1};if("text"==drawCommand.drawtype.toLowerCase()){var obj=codeDrawText.trim();return draw={isok:!0,code:obj,type:"undefined"==typeof obj?"undefined":_typeof(obj),exec:!1}}try{var code="("+codeDrawText+")",_obj=eval(code),type="undefined"==typeof _obj?"undefined":_typeof(_obj);draw={isok:!0,code:_obj,type:type,exec:!!(_obj&&_obj.constructor&&_obj.call&&_obj.apply)}}catch(E){console.error("error eval ",codeDrawText,E)}return draw}}]),DrawBasicChart}(),DrawText=function(e){function t(e,r){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.type=r.toUpperCase(),a.library="text",a.widget.sizeX=0,a.widget.sizeY=0,a}return _inherits(t,e),_createClass(t,[{key:"preProcessor",value:function(){var e=this.getDrawCommandObject();this.init=this.applyText(e)}},{key:"applyText",value:function(e){return this.isDark()&&(this.widget.element[0].style.background="#404a59"),e?this.widget.element[0].innerHTML=Mustache.render(e,this.widget.data):this.widget.element[0].innerHTML="<pre>"+JSON.stringify(this.widget.data,null,"	")+"</pre>",!0}},{key:"onResize",value:function(){}}]),t}(DrawBasicChart),DrawGoogleMap=function(e){function t(e,r){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.type=r.toUpperCase(),a.library="gmaps",a._map=!1,a.mapOptions={zoom:4},a}return _inherits(t,e),_createClass(t,[{key:"onResize",value:function(){this._map&&google.maps.event.trigger(this._map,"resize")}},{key:"preProcessor",value:function(){this.loadGoogleMapJS(this)}},{key:"afterLoadMapProcessor",value:function(){if(this.initChartByJsCode()?this.init=!0:this.init=this.create(),this.getError())return console.error(this.getError()),this.chart.before("<p>"+this.getError()+"</p>"),!1;var e=this.getDrawCommandObject();e.raw&&(this.options=_.merge(this.options,e.raw)),this.isDark(),console.info("preProcessor",this.init,this.options)}},{key:"loadGoogleMapJS",value:function(e){if(window._sendGoogleMapLoad)return void this.afterLoadMapProcessor();window._sendGoogleMapLoad=!0,window._isGoogleMapLoaded=!1,console.info("YA_MAP>Start load map : api-maps.yandex.ru");var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCRQH39oyrPnfPPgADuOp0eSRsDHRUMyyY",t.charset="utf-8",t.onload=t.onreadystatechange=function(){t.readyState&&"complete"!==t.readyState&&"loaded"!==t.readyState||(t.onload=t.onreadystatechange=null,e.afterLoadMapProcessor(),window._isGoogleMapLoaded=!0)};var r=document.getElementsByTagName("script")[0];r.parentNode.insertBefore(t,r)}},{key:"getDarkStyle",value:function(){return[{featureType:"all",elementType:"labels.text.fill",stylers:[{color:"#ffffff"}]},{featureType:"all",elementType:"labels.text.stroke",stylers:[{color:"#000000"},{lightness:13}]},{featureType:"administrative",elementType:"geometry.fill",stylers:[{color:"#000000"}]},{featureType:"administrative",elementType:"geometry.stroke",stylers:[{color:"#144b53"},{lightness:14},{weight:1.4}]},{featureType:"landscape",elementType:"all",stylers:[{color:"#08304b"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#0c4152"},{lightness:5}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#000000"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#0b434f"},{lightness:25}]},{featureType:"road.arterial",elementType:"geometry.fill",stylers:[{color:"#000000"}]},{featureType:"road.arterial",elementType:"geometry.stroke",stylers:[{color:"#0b3d51"},{lightness:16}]},{featureType:"road.local",elementType:"geometry",stylers:[{color:"#000000"}]},{featureType:"transit",elementType:"all",stylers:[{color:"#146474"}]},{featureType:"water",elementType:"all",stylers:[{color:"#021019"}]}]}},{key:"getLightStyle",value:function(){return[{featureType:"landscape",stylers:[{hue:"#FFBB00"},{saturation:43.400000000000006},{lightness:37.599999999999994},{gamma:1}]},{featureType:"road.highway",stylers:[{hue:"#FFC200"},{saturation:-61.8},{lightness:45.599999999999994},{gamma:1}]},{featureType:"road.arterial",stylers:[{hue:"#FF0300"},{saturation:-100},{lightness:51.19999999999999},{gamma:1}]},{featureType:"road.local",stylers:[{hue:"#FF0300"},{saturation:-100},{lightness:52},{gamma:1}]},{featureType:"water",stylers:[{hue:"#0078FF"},{saturation:-13.200000000000003},{lightness:2.4000000000000057},{gamma:1}]},{featureType:"poi",stylers:[{hue:"#00FF6A"},{saturation:-1.0989010989011234},{lightness:11.200000000000017},{gamma:1}]}]}},{key:"create",value:function(){console.warn("CREATE"),this._map=new google.maps.Map(this.widget.element[0],this.mapOptions);var e=this.getLightStyle();this.isDark()&&(e=this.getDarkStyle()),this._map.setOptions({styles:e});var t=this,r=this.getDrawCommandObject(),a={longitude:"longitude",latitude:"latitude",count:"count",title:"title"},n=new google.maps.LatLngBounds,i=0;r&&(a=Object.assign(a,r)),this.data().forEach(function(e,r){var o=parseInt(e[a.count]);o>i&&(i=o);var s={lat:e[a.latitude],lng:e[a.longitude]},l=!1;e[a.title]&&(l=new google.maps.InfoWindow({content:'<div id="content" class="gmapInfo">'+e[a.title]+"</div>"})),n.extend(s);var c=new google.maps.Marker({position:s,map:t._map,title:"Value:"+o});l&&c.addListener("click",function(){l.open(this._map,c)})}),this._map.fitBounds(n),this._map.panToBounds(n)}}]),t}(DrawBasicChart),DrawEcharts=function(e){function t(e,r){_classCallCheck(this,t);var a=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.help="",a.type=r.toUpperCase(),a.library="echarts",a.preference={gridchart:!1,bar:!1},a.options={version:3,textStyle:{fontFamily:"Menlo"},toolbox:{show:!0,feature:{dataZoom:{yAxisIndex:"none",title:"data Zoom"},dataView:{readOnly:!1,title:"data View"},magicType:{type:["line","bar","stack","tiled"],title:{line:"line",bar:"bar",stack:"stack",tiled:"tiled"}},restore:{title:"Restore"},saveAsImage:{title:"Save as Image"}}}},a}return _inherits(t,e),_createClass(t,[{key:"onResize",value:function(){this.chart&&this.init&&(this.chart.setOption(this.options),this.chart.resize())}},{key:"preProcessor",value:function(){if(this.initChartByJsCode())this.init=!0;else try{this.init=this.create()}catch(e){this.setError(this.getError()+"\n\n\n"+e.name+":"+e.message+"\n"+e.stack)}if(this.getError())return console.error(this.getError()),!1;var t=this.getDrawCommandObject();t.raw&&(this.options=_.merge(this.options,t.raw)),this.isDark()&&(this.options.backgroundColor="#404a59"),console.info("preProcessor",this.init,this.options)}},{key:"getParameterPath",value:function(){var e=this.getDrawCommandObject(),t={path:""};e&&(t=Object.assign(t,e));var r="";if(_.isString(e)?r=e:t.path&&(r=t.path),!r)return!1;for(var a=_.split(r,"."),n=0;n<a.length;n++)if(!this.haveColumn(a[n]))return this.setError("Not set column in path :"+a[n]),!1;return a}},{key:"applyDataZoom",value:function(){this.options.dataZoom=[{type:"inside",show:!0,realtime:!0},{show:!0,realtime:!0}]}},{key:"applyLegend",value:function(){this.options.legend={data:_.map(this.options.series,"name"),x:"left"}}},{key:"applyTitle",value:function(e){this.options.title={orient:"vertical",padding:25,left:"center",text:e}}},{key:"applyGrid",value:function(){var e=[];this.options.grid=e}}]),t}(DrawBasicChart),DrawEchartsCalendar=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"create",value:function(){var e=this.getDrawCommandObject(),t={date:"",title:"Calendar",value:""};if(e&&(t=Object.assign(t,e)),!(t.date&&t.value&&this.haveColumn(t.date)&&this.haveColumn(t.value))){var r=this.getColumns().length,a=this.getDateColumn(),n=!1;if(a)for(var i=this.getColumnPosition(a),o=i+1;r>o;o+=1){var s=this.getColumns(o);if(!n&&this.isNumericColumn(s)){n=s;break}}t.date=a,t.value=n}if(!this.haveColumn(t.date)||!this.haveColumn(t.value))return this.setError("Not set date | value cols"),!1;var l=0,c=Number.MAX_VALUE,d=_.map(this.data(),function(e){var r=parseFloat(e[t.value]);return r&&r>l&&(l=r),r&&c>r&&(c=r),[e[t.date],r]});d=_.groupBy(d,function(e){var t=(""+e[0]).substring(0,4);return t});var u={tooltip:{position:"top"},calendar:[],series:[],visualMap:{min:c,max:l,calculable:!0,orient:"horizontal",left:"center",top:"top"}},m=60,b=0;return _.forEach(d,function(e,t){u.calendar.push({top:m,range:t,right:0,cellSize:["auto",20]}),u.series.push({type:"heatmap",coordinateSystem:"calendar",data:e,calendarIndex:b}),b+=1,m+=200}),this.options=Object.assign(u,this.options),!0}}]),t}(DrawEcharts),DrawEchartsTreemap=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"getLevelOption",value:function(){return[{itemStyle:{normal:{borderWidth:0,gapWidth:5}}},{itemStyle:{normal:{gapWidth:1}}},{colorSaturation:[.35,.5],itemStyle:{normal:{gapWidth:1,borderColorSaturation:.6}}}]}},{key:"buildTreeData",value:function(e,t){var r=[],a=this;return _.forEach(e,function(e,n){var i=t[n],o={};if(o.value=i.__value,_.isObject(e)){var s=a.buildTreeData(e,i);_.isArray(s)&&s.length&&(o.children=s)}o.name=n,r.push(o)}),r}},{key:"create",value:function(){var e=this.getDrawCommandObject(),t={path:"",title:"TreeMap",tooltip:"Usage",valueformat:!1};e&&(t=Object.assign(t,e));var r="";t.path&&(r=t.path),_.isString(e)&&(r=e);var a=_.split(r,"."),n=a.length;if(!n)return this.setError("Not set path"),!1;for(var i=0;n>i;i+=1)if(!this.haveColumn(a[i]))return this.setError("bad path, no column:"+a[i]),!1;if(!this.isNumericColumn(a[n-1]))return this.setError("bad column:"+a[n-1]+" must be number"),!1;var o={},s={};this.data().forEach(function(e){for(var t=e[a[n-1]],r=[],i=0;n-1>i;i+=1){r.push(e[a[i]]);var l=_.get(o,r.join("_"),0);_.set(o,r.join(".")+".__value",parseFloat(l)+parseFloat(t))}_.set(s,r.join("."),t)});var l=this.buildTreeData(s,o),c={tooltip:{trigger:"item"}},d=echarts.format;return c.series=[{type:"treemap",name:t.title,label:{show:!0,formatter:"{b}"},tooltip:{formatter:function(e){for(var r=e.value,a=[],n=e.treePathInfo,i=1;i<n.length;i++)a.push(n[i].name);var o=t.valueformat;return o||(o="0,0.0"),['<div class="tooltip-title">'+d.encodeHTML(a.join("."))+"</div>",t.tooltip+" : "+numbro(r).format(o)].join("")}},itemStyle:{normal:{borderColor:"#fff"}},levels:this.getLevelOption(),data:l}],this.options=Object.assign(c,this.options),!0}}]),t}(DrawEcharts),DrawEchartsSunkeys=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"create",value:function(){this.helpLink="https://tabix.io/doc/draw/Draw_Sankeys/",this.help="Default config : {path:''} or {value:'',source:'',target:''}, if empty path or not set, try auto create path, then find columns [String] : [Integer|Float] : [String] ";var e=this.getDrawCommandObject(),t={path:"",value:"value",source:"source",target:"target"};e&&(t=Object.assign(t,e));var r="";_.isString(e)?r=e:t.path?r=t.path:this.haveColumn(t.source)&&this.haveColumn(t.value)&&this.haveColumn(t.target)&&(r=t.source+"."+t.value+"."+t.target);var a=[];if(r)a=_.split(r,".");else{var n=!1,i=this.getColumns();for(var o in i){var s=i[o];this.isNumericColumn(s)&&n&&(a.push(s),n=!1),this.isStringColumn(s)&&!n&&(a.push(s),n=!0)}}if(console.log("patharr>",a),!a.length)return this.setError("The value of the variable 'path' - empty"),!1;if(!(1&a.length))return this.setError("The value of the variable 'path' must be odd"),!1;var l=[],c=[];this.data().forEach(function(e){for(var t=0;t<a.length;t+=2){var r=a[t],n=a[t+1],i=a[t+2];if(_.isUndefined(n)||_.isUndefined(i))break;c[e[r]]=1,c[e[i]]=1,l.push({source:e[r],target:e[i],value:e[n]})}});var d=[];for(var u in c)d.push({name:u});var m={tooltip:{trigger:"item",triggerOn:"mousemove"},series:[{type:"sankey",data:d,animationThreshold:300,animationDuration:300,links:l,itemStyle:{normal:{borderWidth:1,borderColor:"#aaa"}},lineStyle:{normal:{color:"source",curveness:.5}}}]};return this.isDark()&&_.set(m.series[0],"label.normal.textStyle.color","white"),this.options=Object.assign(m,this.options),!0}}]),t}(DrawEcharts),DrawEchartsRiver=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"create",value:function(){if(this.initChartByJsCode())return!0;var e=this.getDrawCommandObject(),t={x:"dt",y:"views",name:"name",title:"title"};e&&(t=Object.assign(t,e));var r={},a={},n={},i=[];this.widget.data.data.forEach(function(e){var i=parseInt(e[t.y]);_.set(r,e[t.name]+"."+e[t.x],i),a[e[t.name]]=1,n[e[t.x]]=1}),_.forEach(a,function(e,t){_.forEach(n,function(e,a){var n=_.get(r,t+"."+a,0);i.push([a,n,t])})});var o=[{type:"themeRiver",data:i,itemStyle:{emphasis:{shadowBlur:20,shadowColor:"rgba(0, 0, 0, 0.8)"}}}],s={tooltip:{trigger:"axis",axisPointer:{type:"line",lineStyle:{color:"rgba(0,0,0,0.2)",width:2,type:"solid"}}},singleAxis:{axisTick:{},axisLabel:{},type:"time",position:"top",splitLine:{show:!0,lineStyle:{type:"dashed",opacity:.2}}},series:o};return this.options=Object.assign(this.options,s),!0}}]),t}(DrawEcharts),DrawEchartsMap=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"loadWorldMapJS",value:function(){if(window.loadWorldMapJSEcharts)return!1;var e=document.createElement("script");e.type="text/javascript",e.async=!1,e.src="http://loader.tabix.io/extend/echarts_world_map.js",e.charset="utf-8";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t),window.loadWorldMapJSEcharts=!0}},{key:"create",value:function(){this.loadWorldMapJS();var e=this.getDrawCommandObject(),t={longitude:"longitude",latitude:"latitude",count:"count",name:"name",title:"Map",destination:{longitude:"destination_longitude",latitude:"destination_latitude",speed:"destination_speed",name:"destination_name",count:"destination_count"}},r=0;e&&(t=Object.assign(t,e));var a=[],n=[];this.data().forEach(function(e,i){var o=parseInt(e[t.count]);if(o>r&&(r=o),e[t.destination.longitude]&&e[t.destination.latitude]){var s="";e[t.destination.name]&&(s=e[t.destination.name]),n.push({fromName:e[t.name],toName:s,coords:[[e[t.longitude],e[t.latitude]],[e[t.destination.longitude],e[t.destination.latitude]]]})}a.push({name:e[t.name],value:[e[t.longitude],e[t.latitude],o],label:{emphasis:{position:"right",show:!0}}})});var i=[{name:t.title,type:"effectScatter",coordinateSystem:"geo",data:a,showEffectOn:"render",rippleEffect:{brushType:"stroke"},symbolSize:function(e){return r?e[2]/r*15:e[2]/1e4},hoverAnimation:!0,label:{normal:{formatter:"{b}",position:"right",show:!0}},itemStyle:{normal:{color:"#f4e925",shadowBlur:10,shadowColor:"#333"}},zlevel:1}];if(n.length>0){var o="path://M1705.06,1318.313v-89.254l-319.9-221.799l0.073-208.063c0.521-84.662-26.629-121.796-63.961-121.491c-37.332-0.305-64.482,36.829-63.961,121.491l0.073,208.063l-319.9,221.799v89.254l330.343-157.288l12.238,241.308l-134.449,92.931l0.531,42.034l175.125-42.917l175.125,42.917l0.531-42.034l-134.449-92.931l12.238-241.308L1705.06,1318.313z";i.push({name:t.title,type:"lines",zlevel:1,effect:{show:!0,period:6,trailLength:.7,color:"#fff",symbolSize:3},lineStyle:{normal:{width:0,curveness:.2}},data:n}),i.push({name:t.title,type:"lines",zlevel:2,symbol:["none","arrow"],symbolSize:10,effect:{show:!0,period:6,trailLength:0,symbol:o,symbolSize:15},lineStyle:{normal:{width:1,opacity:.6,curveness:.2}},data:n})}var s={tooltip:{trigger:"item"},geo:{name:t.title,type:"map",map:"world",label:{emphasis:{show:!1}},visualMap:{show:!0,min:0,max:100,inRange:{symbolSize:[6,60]}},roam:!0,itemStyle:{normal:{areaColor:"#323c48",borderColor:"#404a59"},emphasis:{areaColor:"#2a333d"}}},series:i};return this.options=Object.assign(this.options,s),!0}}]),t}(DrawEcharts),DrawEchartsHeatmap=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"create",value:function(){var e=this.getParameterPath();if(!e)return this.setError("Not set path"),!1;var t={},r={},a={};this.data().forEach(function(n){_.set(t,n[e[0]],1),_.set(r,n[e[1]],1),_.set(a,n[e[0]]+"."+n[e[1]],parseFloat(n[e[2]]))});var n=[],i=_.keys(t),o=_.keys(r),s=0,l=0;_.mapKeys(t,function(e,t){_.mapKeys(r,function(e,r){var i=_.get(a,t+"."+r,"-");s>i&&(s=i),i>l&&(l=i),n.push([t,r,i])})});var c={tooltip:{position:"top"},animation:!1,grid:{height:"50%",y:"10%"},xAxis:{type:"category",data:i,splitArea:{show:!0}},yAxis:{type:"category",data:o,splitArea:{show:!0}},visualMap:{min:s,max:l,calculable:!0,orient:"horizontal",left:"center",bottom:"15%"},series:[{name:"Punch Card",type:"heatmap",data:n,label:{normal:{show:!0}},itemStyle:{emphasis:{shadowBlur:10,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};return this.options=Object.assign(c,this.options),!0}}]),t}(DrawEcharts),DrawEchartsChart=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"create",value:function(){console.log("DrawEchartsChart");var e=this.getDrawCommandObject(),t=this.preCreate(e),r=this.createChart(e),a={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0}};return e.title&&this.applyTitle(e.title),this.applyDataZoom(),this.applyLegend(),this.options=Object.assign(r,this.options,a,t),this.postCreate(e),!0}},{key:"findDateTimeAxis",value:function(){var e=this.getDateTimeColumn();if(e)return e;var t=this.getDateColumn();return t?t:!1}},{key:"postCreate",value:function(e){return{}}},{key:"preCreate",value:function(e){return{}}},{key:"createChart",value:function(e){var t=this,r={autoAxis:!1,markLine:!0,stack:!1,path:!1,sort:!0};e&&(r=Object.assign(r,e));var a=this.getColumns(),n=this.getFirstColumn(),i=this.findDateTimeAxis(),o={},s=[],l=[],c=[],d={},u=this.data();i&&(n=i),r.sort&&(u=_.sortBy(u,n)),
l=[{name:n,type:"category",data:_.map(u,n)}],console.info("xAxis",l);var m=[],b="",h=0,p=this.getParameterPath(),g=!1;p&&(g=!0);var f=0,v=[];for(var y in a){var w=a[y];w!=n&&(this.isStringColumn(w)&&2>f&&!g?(_.isArray(p)||(p=[]),p.push(w),f++):this.isNumericColumn(w)&&v.push(w))}console.log("PATH",p),console.log("colValues",v);var x=u.length;for(h=0;x>h;++h){var k=u[h],S=function(e){var r=a[e],i=[n];if(r!==n&&t.isNumericColumn(r)&&_.findIndex(p,r)<0){if(p)for(var o=0;o<p.length;++o){var s=p[o];i.push(k[s])}i.push(r),i=i.join(":___:"),d[i]||(d[i]=new Map,l[0].data.forEach(function(e){d[i].set(e,null)}));var c=k[r];t.isNumericColumn(r)&&(c=parseFloat(c)),console.log("item[firstCol]=",k[n],c),d[i].set(k[n],c)}};for(var T in a)S(T)}console.log("firstCol",n),console.log("colValues",v),console.log("path",p),u=null,v=null,h=0;for(var D in d){var C="";C=D.replace(/:___:/g,":");var I=Array.from(d[D].values()),E=_.median(I),A={name:C,type:"line",symbolSize:8,hoverAnimation:!1,data:I};this.preference.bar&&(A.type="bar",A.barGap="-100%",A.barCategoryGap="40%"),r.markLine&&(A.markLine={data:[{name:"mediana",yAxis:E}]}),m.push({column:C,median:E,index:h}),b=C,c.push(A),h+=1}if(r.autoAxis&&m.length>1){var R=_.groupBy(m,function(e){return Math.floor(e.median/1e3)});if(_.size(R)>1){var U=function(e){var t=R[e],a=_.map(t,"column").join(",");_.forEach(t,function(e){c[e.index].yAxisIndex=s.length,r.stack&&(c[e.index].stack=a,c[e.index].areaStyle={normal:{}})}),s.push({name:a,type:"value"})};for(var M in R)U(M)}}return s.length||(s=[{name:b,type:"value"}]),o.series=c,o.yAxis=s,o.xAxis=l,console.info("options",o),o}}]),t}(DrawEcharts),DrawEchartsGridChart=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"preCreate",value:function(e){return this.preference.gridchart=!0,{}}},{key:"postCreate",value:function(e){var t=[],r=[],a=[],n=[],i=0;console.info("postCreate!!!!!!",this.options);var o=[],s=this.options.xAxis[0],l=this.options.yAxis[0];for(var c in this.options.series){c=parseInt(c);var d=this.options.series[c].name;this.options.series[c].xAxisIndex=c,this.options.series[c].yAxisIndex=i,console.log(d,this.options.series[c]),s.show=!1,s.gridIndex=c,l.gridIndex=c,l.show=!1,l.name=d,t.push({show:!0,borderWidth:0,shadowBlur:2}),a.push(_.clone(s)),r.push(_.clone(l)),n.push({textAlign:"center",text:d,textStyle:{fontSize:11,fontWeight:"normal"}}),o.push(c),i+=1}var u=Math.ceil(Math.sqrt(i));t.forEach(function(e,t){e.left=t%u/u*100+.5+"%",e.top=Math.floor(t/u)/u*100+.5+"%",e.width=1/u*100-1+"%",e.height=1/u*100-1+"%",n[t].left=parseFloat(e.left)+parseFloat(e.width)/2+"%",n[t].top=parseFloat(e.top)+"%"}),this.options.dataZoom&&this.options.dataZoom[0]&&(this.options.dataZoom[0].xAxisIndex=o),this.options.titles=n,this.options.grid=t,this.options.xAxis=a,this.options.yAxis=r}}]),t}(DrawEchartsChart),DrawEchartsBar=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"preCreate",value:function(e){return this.preference.bar=!0,{}}}]),t}(DrawEchartsChart),DrawD3=function(e){function t(e){_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.library="d3",r}return _inherits(t,e),t}(DrawBasicChart),DrawC3=function(e){function t(e){_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.library="c3",r.bindto=!1,r}return _inherits(t,e),_createClass(t,[{key:"onResize",value:function(){this.chart&&this.init}},{key:"preProcessor",value:function(){return console.log("preProcessor>c3.generate"),this.initChartByJsCode()?(console.log("c3.options>",this.options),this.bindto.className+=" c3",console.log("this.bindto.className",this.bindto.className),this.options.bindto=this.bindto,console.log("c3.options>",this.options),void(this.chart=c3.generate(this.options))):(console.error("C3.Init by code"),!1)}}]),t}(DrawBasicChart),DrawAMcharts=function(e){function t(e){_classCallCheck(this,t),console.warn("DrawAMcharts constructor");var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.library="amchart",r}return _inherits(t,e),_createClass(t,[{key:"onResize",value:function(){this.makeLegend()}},{key:"preProcessor",value:function(){this.createChart()&&(this.init=!0),console.log("!preProcessor,done",this.init,this.options)}},{key:"createChart",value:function(){var e=this,t={},r=this.widget.data.meta,a=!1,n="",i="mm",o=[],s=0,l=[];r.forEach(function(r){if("DateTime"==r.type)a="YYYY-MM-DD JJ:NN:SS",n=r.name;else if("Date"==r.type)a="YYYY-MM-DD",i="DD",n=r.name;else{if(!n)return void(n=r.name);s+=1;var c=e.getChartGraph(r,t[r.name]);c.id="g"+s,"v1"!==c.valueAxis&&l.push(c.valueAxis),o.push(c)}});var c={theme:Widget.isDark?"dark":"light",color:Widget.isDark?"#eee":"#333",type:"serial",categoryField:n,valueAxes:[{id:"v1",axisAlpha:1,gridAlpha:.07,axisColor:Widget.isDark?"#eee":"#333",gridColor:Widget.isDark?"#eee":"#333",ignoreAxisWidth:!0}],balloon:{borderThickness:1,shadowAlpha:0},graphs:o,chartCursor:{valueLineEnabled:!0,valueLineBalloonEnabled:!0,cursorAlpha:0,zoomable:!1,valueZoomable:!0,valueLineAlpha:.5},chartScrollbar:{graph:"g1",gridAlpha:0,color:"#888888",scrollbarHeight:25,backgroundAlpha:0,selectedBackgroundAlpha:.1,selectedBackgroundColor:"#888888",graphFillAlpha:0,autoGridCount:!0,selectedGraphFillAlpha:0,graphLineAlpha:.2,graphLineColor:"#c2c2c2",selectedGraphLineColor:"#888888",selectedGraphLineAlpha:1},categoryAxis:{dashLength:1,minorGridEnabled:!0,axisColor:Widget.isDark?"#eee":"#333",gridColor:Widget.isDark?"#eee":"#333"},data:this.widget.data.data};if(c.categoryAxis.parseDates=!1,a&&(c.dataDateFormat=a,c.categoryAxis.parseDates=!0,c.categoryAxis.minPeriod=i),l){var d=0;l.forEach(function(e){d++;var t={id:e,axisAlpha:1,axisThickness:1,position:"right",ignoreAxisWidth:!0,offset:1*d};c.valueAxes.push(t)})}return this.options=c,this.init=!0,this.makeLegend(),!0}},{key:"makeLegend",value:function(){console.log("this.widget.sizeY",this.widget.sizeY),this.widget.sizeY<2?delete this.options.legend:this.options.legend={align:"center",equalWidths:!1,periodValueText:"total: [[value.sum]]",valueAlign:"left",valueText:"[[value]] ([[percents]]%)",valueWidth:100},console.warn(this.options)}},{key:"getChartGraph",value:function(e,t){var r=e.name,a=e.name,n="v1";r=r.replace(/_axis\d+/gm,"");var i=/.*_axis(\d+).*/i,o=a.match(i);o&&o[1]&&(n="v"+o[1]);var s={id:"g1",valueAxis:n,fillAlphas:.2,bullet:"round",bulletSize:8,hideBulletsCount:50,lineThickness:1,title:r,useLineColorForBulletBorder:!0,valueField:a,type:"smoothedLine",balloonText:"[[title]] [[category]]<br><b><span style='font-size:14px;'>[[value]]</span></b>"};return t||(t={}),Object.assign(s,t)}}]),t}(DrawBasicChart),DataProvider=function(){function e(t,r){_classCallCheck(this,e),this.data=t.data,this.text=!1,this.progressQuery="",this.sort=!1,this.sortOrder=!1,t.error||angular.isObject(t.data)||(angular.isString(t.data)?this.text=t.data:this.text=angular.toJson(t.data,!0),this.text=this.text.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),r||(r="ch"),this.sourceType=r,this.meta=t.meta,t.query?this.query=t.query:this.query={index:0,drawCommands:!1},t.error?(this.error=t.error.replace("<br/>","\n").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),this.error=this.error.replace("\\n","<br/>")):this.error=!1,this.draw=this.query.drawCommands,this.rows=t.rows,this.position=this.query.index,this.countAll=t.countAllQuery}return e.$inject=["result","sourceType"],_createClass(e,[{key:"isText",value:function(){return this.text?!0:!1}},{key:"isError",value:function(){return this.error?!0:!1}},{key:"getError",value:function(){return this.error}},{key:"data",value:function(){return this.data}},{key:"meta",value:function(){return this.meta}},{key:"toString",value:function(){return"("+this.name+", "+this.y+")"}}],[{key:"convertArrayToDataProvider",value:function(t,r){var a={};return a.data=t,a.meta=[],a.error=!1,a.query={drawCommands:!1},a.rows=t.length,a.position=0,a.countAll=0,Object.keys(t[0]).map(function(e){return a.meta.push({name:e,type:"string"})}),new e(a,r)}}]),e}();angular.module(smi2.app.name).service("DataProvider",DataProvider),/*
 * Copyright (c) 2017. Smi2
 */
angular.module(smi2.app.name).directive("pivot",[function(){return{restrict:"AE",scope:{data:"=",config:"=",editMode:"="},link:function(e,t,r){var a=$.extend($.pivotUtilities.renderers);null==e.config&&(e.config={rows:[],cols:[]}),e.renderPivotTable=function(){$(t).pivot(e.data,{renderers:a,rendererName:"Table",cols:e.config.cols,rows:e.config.rows,onRefresh:function(t){var r=JSON.parse(JSON.stringify(t));delete r.aggregators,delete r.renderers,delete r.derivedAttributes,delete r.rendererOptions,delete r.localeStrings,e.config=r,e.$apply()}})},e.renderPivotUITable=function(){$(t).pivotUI(e.data)},e.$watch("scope.editMode",function(t,r){console.log("watch"+e.editMode),t&&(e.editMode?e.renderPivotUITable():e.renderPivotTable())},!0),e.renderPivotUITable()}}}]),/**
 * ng-handsontable 0.13.0
 * 
 * Copyright 2012-2015 Marcin Warpechowski
 * Copyright 2015 Handsoncode sp. z o.o. <hello@handsontable.com>
 * Licensed under the MIT license.
 * https://github.com/handsontable/ngHandsontable
 * Date: Wed Oct 26 2016 10:00:05 GMT+0200 (CEST)
*/
document.all&&!document.addEventListener&&(document.createElement("hot-table"),document.createElement("hot-column"),document.createElement("hot-autocomplete")),angular.module("ngHandsontable.services",[]),angular.module("ngHandsontable.directives",[]),angular.module("ngHandsontable",["ngHandsontable.services","ngHandsontable.directives"]),Handsontable.hooks.add("afterContextMenuShow",function(){Handsontable.EventManager.isHotTableEnv=!1}),function(){function e(e){return{parseAutoComplete:function(t,r,a){t.source=function(n,i){var o=this.instance.getSelected()[0],s=[],l=r[o];if(l){var c=t.optionList;if(c&&c.object){if(angular.isArray(c.object))s=c.object;else{var d=e(c.object)(l);if(angular.isArray(d))if(a)for(var u=0,m=d.length;m>u;u++){var b=d[u][c.property];null!==b&&void 0!==b&&s.push(b)}else s=d;else s=d}i(s)}}}}}}e.$inject=["$parse"],angular.module("ngHandsontable.services").factory("autoCompleteFactory",e)}(),function(){function e(){var e={};return{getInstance:function(t){return e[t]},registerInstance:function(t,r){e[t]=r},removeInstance:function(t){e[t]=void 0}}}e.$inject=[],angular.module("ngHandsontable.services").factory("hotRegisterer",e)}(),function(){function e(e){return e.replace(/[A-Z]/g,function(e){return"-"+e.charAt(0).toLowerCase()})}function t(e){return e.substr(0,1).toUpperCase()+e.substr(1,e.length-1)}function r(r){return{containerClassName:"handsontable-container",initializeHandsontable:function(e,t){var a,n=document.createElement("div");return n.className=this.containerClassName,t.hotId&&(n.id=t.hotId),e[0].appendChild(n),a=new Handsontable(n,t),t.hotId&&r.registerInstance(t.hotId,a),a},updateHandsontableSettings:function(e,t){e&&e.updateSettings(t)},renderHandsontable:function(e){e&&e.render()},mergeSettingsFromScope:function(e,t){var r,a,n,i=angular.extend({},t);for(e=e||{},angular.extend(i,t.settings||{}),r=this.getAvailableSettings(),a=0,n=r.length;n>a;a++)"undefined"!=typeof i[r[a]]&&(e[r[a]]=i[r[a]]);return e},mergeHooksFromScope:function(e,r){var a,n,i,o,s=angular.extend({},r);for(e=e||{},angular.extend(s,r.settings||{}),a=this.getAvailableHooks(),n=0,i=a.length;i>n;n++)o="on"+t(a[n]),("function"==typeof s[a[n]]||"function"==typeof s[o])&&(e[a[n]]=s[a[n]]||s[o]);return e},trimScopeDefinitionAccordingToAttrs:function(e,t){for(var r in e)e.hasOwnProperty(r)&&void 0===t[r]&&void 0===t[e[r].substr(1,e[r].length)]&&delete e[r];return e},getTableScopeDefinition:function(){var e={};return this.applyAvailableSettingsScopeDef(e),this.applyAvailableHooksScopeDef(e),e.datarows="=",e.dataschema="=",e.observeDomVisibility="=",e},getColumnScopeDefinition:function(){var e={};return this.applyAvailableSettingsScopeDef(e),e.data="@",e},applyAvailableSettingsScopeDef:function(e){var t,r,a;for(t=this.getAvailableSettings(),r=0,a=t.length;a>r;r++)e[t[r]]="=";return e},applyAvailableHooksScopeDef:function(e){var r,a,n;for(r=this.getAvailableHooks(),a=0,n=r.length;n>a;a++)e[r[a]]="=on"+t(r[a]);return e},getAvailableSettings:function(t){var r=Object.keys(Handsontable.DefaultSettings.prototype);return-1===r.indexOf("contextMenuCopyPaste")&&r.push("contextMenuCopyPaste"),-1===r.indexOf("handsontable")&&r.push("handsontable"),r.indexOf("settings")>=0&&r.splice(r.indexOf("settings"),1),t&&(r=r.map(e)),r},getAvailableHooks:function(t){var r=Handsontable.hooks.getRegistered();return t&&(r=r.map(function(t){return"on-"+e(t)})),r}}}r.$inject=["hotRegisterer"],angular.module("ngHandsontable.services").factory("settingFactory",r)}(),function(){function e(){return{restrict:"EA",scope:!0,require:"^hotColumn",link:function(e,t,r,a){var n=r.datarows;a.setColumnOptionList(n)}}}e.$inject=[],angular.module("ngHandsontable.directives").directive("hotAutocomplete",e)}(),function(){function e(e){return{restrict:"EA",require:"^hotTable",scope:{},controller:["$scope",function(e){this.setColumnOptionList=function(t){e.column||(e.column={});var r={},a=t.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)\s*$/);a?(r.property=a[1],r.object=a[2]):r.object=t.split(","),e.column.optionList=r}}],compile:function(t,r){var a=this;return this.scope=e.trimScopeDefinitionAccordingToAttrs(e.getColumnScopeDefinition(),r),angular.forEach(Object.keys(this.scope),function(e){a.$$isolateBindings[e]={attrName:e,collection:!1,mode:"data"===e?"@":"=",optional:!1}}),function(t,r,a,n){var i={};angular.forEach(Object.keys(a),function(e){"$"!==e.charAt(0)&&""===a[e]&&(i[e]=!0)}),e.mergeSettingsFromScope(i,t),t.column||(t.column={}),angular.extend(t.column,i),n.setColumnSetting(t.column),t.$on("$destroy",function(){n.removeColumnSetting(t.column)})}}}}e.$inject=["settingFactory"],angular.module("ngHandsontable.directives").directive("hotColumn",e)}(),function(){function e(e,t,r,a){return{restrict:"EA",scope:{},priority:-400,controller:["$scope",function(t){this.setColumnSetting=function(r){t.htSettings||(t.htSettings={}),t.htSettings.columns||(t.htSettings.columns=[]),t.htSettings.columns.push(r),e.updateHandsontableSettings(t.hotInstance,t.htSettings)},this.removeColumnSetting=function(r){t.htSettings.columns.indexOf(r)>-1&&(t.htSettings.columns.splice(t.htSettings.columns.indexOf(r),1),e.updateHandsontableSettings(t.hotInstance,t.htSettings))}}],compile:function(n,i){var o,s=this;return this.scope=e.trimScopeDefinitionAccordingToAttrs(e.getTableScopeDefinition(),i),o=Object.keys(this.scope),angular.forEach(o,function(e){var t=s.scope[e].charAt(0);s.$$isolateBindings[e]={attrName:s.scope[e].length>1?s.scope[e].substr(1,s.scope[e].length):e,collection:"datarows"===e,mode:t,optional:!1}}),function(n,i,s){if(n.settings=a(s.settings)(n.$parent),n.htSettings||(n.htSettings={}),angular.forEach(Object.keys(s),function(e){"$"!==e.charAt(0)&&""===s[e]&&(n.htSettings[e]=!0)}),e.mergeSettingsFromScope(n.htSettings,n),e.mergeHooksFromScope(n.htSettings,n),n.htSettings.data||(n.htSettings.data=n.datarows),n.htSettings.dataSchema=n.dataschema,n.htSettings.hotId=s.hotId,n.htSettings.observeDOMVisibility=n.observeDomVisibility,n.htSettings.columns)for(var l=0,c=n.htSettings.columns.length;c>l;l++){var d=n.htSettings.columns[l];if("autocomplete"===d.type&&d.optionList){if("string"==typeof d.optionList){var u={},m=d.optionList.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)\s*$/);m?(u.property=m[1],u.object=m[2]):u.object=u,d.optionList=u}t.parseAutoComplete(d,n.datarows,!0)}}var b=n.htSettings.afterChange;n.htSettings.afterChange=function(){b&&b.apply(this,arguments),r.$$phase||n.$apply()},n.hotInstance=e.initializeHandsontable(i,n.htSettings),angular.forEach(o,function(t){n.$watch(t,function(r,a){void 0!==r&&("datarows"===t?n.hotInstance.getSettings().data===r?e.renderHandsontable(n.hotInstance):(n.hotInstance.loadData(r),n.htSettings.data=r):r!==a&&(n.htSettings[t]=r,e.updateHandsontableSettings(n.hotInstance,n.htSettings)))},["datarows","columns","rowHeights","colWidths","rowHeaders","colHeaders"].indexOf(t)>=0)}),n.$watch("datarows",function(e){void 0!==e&&n.hotInstance.getSettings().data!==e&&n.hotInstance.loadData(e)}),n.$watchCollection("datarows",function(t,r){r&&r.length===n.htSettings.minSpareRows&&t.length!==n.htSettings.minSpareRows&&(n.htSettings.data=n.datarows,e.updateHandsontableSettings(n.hotInstance,n.htSettings))})}}}}e.$inject=["settingFactory","autoCompleteFactory","$rootScope","$parse"],angular.module("ngHandsontable.directives").directive("hotTable",e),angular.module("ngHandsontable.directives").directive("hotAutoDestroy",["hotRegisterer",function(e){return{restrict:"A",link:function(t,r,a){r.on("$destroy",function(){try{var t=e.getInstance(a.hotId);t?(console.info("hotInstance.destroy();"),t.destroy()):console.log("Failed to destroy hot-instance")}catch(r){console.log(r)}})}}}])}(),function(e,t){function r(e){return function(t,r,a){var n=e(a.ngRightClick);r.bind("contextmenu",function(e){t.$apply(function(){e.preventDefault(),n(t,{$event:e})})})}}e.module(t.app.name).directive("ngRightClick",r),r.$inject=["$parse"]}(angular,smi2),function(e,t){function r(){return{restrict:"A",require:"mdMenu",link:function(t,r,a,n){t.$mdOpenMousepointMenu=function(t){var r=e.element(t.currentTarget).offset();n.offsets=function(){return{left:t.pageX-r.left,top:t.pageY-r.top+8}},n.open(t)}}}}e.module(t.app.name).directive("mousepointMenu",r)}(angular,smi2),/*
 * Licensed under the Apache License, Version 2.0 Copyright 2017 Igor Strykhar,Ivan Kudinov,SMI2 LLC and other contributors
 */
function(e,t){function r(t,r,a){var n="";if("echarts"==t.draw.library){var i="macarons";t.isDark&&(i="dark"),t.draw.chart=echarts.init(r[0],i),n=!1}if("c3"==t.draw.library){var o=document.createElement("div");t.draw.bindto=o,r[0].appendChild(o),n=!1}return"text"==t.draw.library&&(t.element=e.element('<div style="width: 100%;height: 100%">&nbsp;</div>'),n=!1),"d3"==t.draw.library&&console.info("DW:d3"),"gmaps"==t.draw.library&&(t.element=e.element('<div style="width: 100%;height: 100%">&nbsp;</div>'),n=!1),console.group("widget.draw.preProcessor"),console.time("widget.draw.preProcessor time took"),t.draw.preProcessor instanceof Function&&t.draw.preProcessor(),console.timeEnd("widget.draw.preProcessor time took"),console.groupEnd(),n}function a(t,a,n){return function(i,o,s){if(i.widget.isDark=i.isdark,i.widget.preProcessor instanceof Function&&i.widget.preProcessor(),!i.widget.error&&!i.widget.textformat){if("table"!=i.widget.type||i.widget.error||(i.widget.element=e.element('<hot-table\n                        hot-id="'+i.widget.hotId+'"\n                        settings="widget.table.settings"\n                        datarows="widget.data.data"\n                        ng-class="{\'handsontable-dark\': widget.isDark}"\n                        col-headers="widget.table.colHeaders"\n                        manual-column-resize="true"\n                        hot-auto-destroy\n                    ></hot-table>'),i.widget.hotRegisterer=n),"draw"==i.widget.type&&!i.widget.error){i.widget.element=!1;var l=r(i.widget,o,a);l&&(i.widget.element=e.element(l))}"pivot"!=i.widget.type||i.widget.error||(i.widget.element=e.element('<pivot style=" transition: none !important;" data="widget.data.data" config="widget.pivot.config" edit-mode="true"></pivot>')),i.widget.element&&(o.append(i.widget.element),t(i.widget.element)(i)),i.widget.scheduledResize(),i.$watch("widget.sizeY",function(){i.widget.scheduledResize()},!0),i.$watch("widget.sizeX",function(){i.widget.scheduledResize()},!0),e.element(window).on("resize",function(e){i.$broadcast("resize")}),i.events={resize:function(e,t){a(function(){console.log("scope.events.resize"),t.widget.scheduledResize()},200)}}}}}e.module(t.app.name).directive("drawWidget",["$compile","$timeout","hotRegisterer",function(e,t,r){return{restrict:"EA",template:'<div style="width: 100%;height: 100%"></div>',scope:{widget:"=widget",isdark:"=isdark"},replace:!0,link:a(e,t,r)}}])}(angular,smi2),function(){var e=angular.module("angular-pivottable",[]);e.directive("ngPivot",function(){return{restrict:"A",link:function(e,t,r){var a=function(e,r){if(void 0===e)throw"Invalid data input on angular-pivot directive :) -";t.pivotUI(e)};if("undefined"!=typeof google)google.load("visualization","1.0",{packages:["corechart","charteditor"],callback:function(){var t=($.pivotUtilities.derivers,$.extend($.pivotUtilities.renderers,$.pivotUtilities.gchart_renderers)),n={renderers:t};a(e.$eval(r.ngPivot),n)}});else{a(e.$eval(r.ngPivot),n);var n={}}e.$watch(r.ngPivot,function(e){a(e,n)})}}})}();var csvImport=angular.module("ngCsvImport",[]);csvImport.directive("ngCsvImport",function(){return{restrict:"E",transclude:!0,replace:!0,scope:{content:"=?",header:"=?",headerVisible:"=?",separator:"=?",separatorVisible:"=?",result:"=?",encoding:"=?",encodingVisible:"=?",accept:"=?",acceptSize:"=?",acceptSizeExceedCallback:"=?",callback:"=?",mdButtonClass:"@?",mdInputClass:"@?",mdButtonTitle:"@?",mdSvgIcon:"@?",uploadButtonLabel:"="},template:function(e,t){var r=angular.isDefined(t.material),a=angular.isDefined(t.multiple);return'<div class="ng-csv-import"><div ng-show="headerVisible"><div class="label">Header</div>'+(r?'<input type="checkbox" ng-model="header"></div>':'<md-switch class="ng-csv-import-header-switch" ng-model="header"></md-switch>')+'<div ng-show="encoding"><div class="label">Encoding</div><span>{{encoding}}</span></div><div ng-show="separatorVisible"><div class="label">Seperator</div><span><input class="separator-input '+(r?"_md md-input":"")+' " type="text" ng-change="changeSeparator" ng-model="separator"><span></div><div><input class="btn cta gray" upload-button-label="{{uploadButtonLabel}}" type="file" '+(a?"multiple":"")+' accept="{{accept}}"/>'+(r?'<md-button ng-click="onClick($event)" class="_md md-button {{mdButtonClass}}"><md-icon md-svg-icon="{{mdSvgIcon}}"></md-icon> {{mdButtonTitle}}</md-button><md-input-container style="margin:0;"><input type="text" class="_md md-input-readable md-input {{mdInputClass}}" ng-click="onClick($event)" ng-model="filename"></md-input-container>':"")+"</div></div>"},link:function(e,t,r){if(e.separatorVisible=!!e.separatorVisible,e.headerVisible=!!e.headerVisible,e.acceptSize=e.acceptSize||Number.POSITIVE_INFINITY,e.material=angular.isDefined(r.material),e.multiple=angular.isDefined(r.multiple),e.multiple)throw new Error("Multiple attribute is not supported yet.");var a=angular.element(t[0].querySelector('input[type="file"]')),n=angular.element(t[0].querySelector("md-input-container"));if(e.material&&a){if(a.removeClass("ng-show"),a.addClass("ng-hide"),n){var i=angular.element(n[0].querySelector("div.md-errors-spacer"));i&&i.remove()}e.onClick=function(){a.click()}}angular.element(t[0].querySelector(".separator-input")).on("keyup",function(t){if(null!=e.content){var r={csv:e.content,header:e.header,separator:t.target.value,encoding:e.encoding};e.result=o(r),e.$apply(),"function"==typeof e.callback&&e.callback(t)}}),t.on("change",function(t){if(t.target.files&&t.target.files.length){if(t.target.files[0].size>e.acceptSize)return void("function"==typeof e.acceptSizeExceedCallback&&e.acceptSizeExceedCallback(t.target.files[0]));e.filename=t.target.files[0].name;var r=new FileReader;if(r.onload=function(r){e.$apply(function(){var a={csv:r.target.result.replace(/\r\n|\r/g,"\n"),header:e.header,separator:e.separator};e.content=a.csv,e.result=o(a),e.result.filename=e.filename,e.$$postDigest(function(){"function"==typeof e.callback&&e.callback(t)})})},"file"!==t.target.type||null==t.target.files&&null==t.srcElement.files){if(null!=e.content){var a={csv:e.content,header:!e.header,separator:e.separator};e.result=o(a),e.$$postDigest(function(){"function"==typeof e.callback&&e.callback(t)})}}else r.readAsText((t.srcElement||t.target).files[0],e.encoding)}});var o=function(e){var t=e.csv.split(new RegExp('\n(?![^"]*"(?:(?:[^"]*"){2})*[^"]*$)')),r=[],a=0,n=t[0].split(e.separator).length,i=[];e.header&&(i=t[0].split(e.separator),a=1);for(var o=a;o<t.length;o++){var l={},c=t[o].split(new RegExp(e.separator+'(?![^"]*"(?:(?:[^"]*"){2})*[^"]*$)'));if(c.length===n){if(e.header)for(var d=0;d<i.length;d++)l[i[d]]=s(c[d]);else for(var u=0;u<c.length;u++)l[u]=s(c[u]);r.push(l)}}return r},s=function(e){return e.replace(/^\s*|\s*$/g,"").replace(/^"|"$/g,"").replace(/""/g,'"')}}}}),function(e,t){function r(e,t,r,a,n,i,o,s){e.vars={searchline:"",counter:0,loaded:!1,error:!1,databases:[]},e.vars.scrollConfig={autoHideScrollbar:!1,theme:n.isDark()?"light":"dark",scrollButtons:{enable:!1},scrollInertia:400,advanced:{updateOnContentResize:!0}},e.vars.metis={config:{toggle:!1,preventDefault:!1}},e.$watch("vars.searchline",function(t){t.length<2?e.vars.databases.forEach(function(t,r){e.vars.databases[r].active=!0,t.tables.forEach(function(t,a){e.vars.databases[r].tables[a].active=!0,t.fields.forEach(function(t,n){e.vars.databases[r].tables[a].fields[n].active=!0})})}):e.filterCompletions(t),s(function(){$("#sideBarMetismenu").metisMenu()},250)}),e.clickInsertField=function(e){t.$emit("handleBroadcastInsertInActive",{value:" "+e.name+",\n"})},e.clickAndSelect=function(r,a){return r.name==t.currentDatabase?(a.stopPropagation(),!1):void e.selectDatabase(r)},e.selectDatabase=function(e){t.currentDatabase=e.name,o.show(o.simple().content("USE "+e.name+" database").theme(n.theme).position("bottom right")),i("tableSiedenav").close()},e.openTable=function(e){i("tableSiedenav").close(),t.currentDatabase!=e.database&&(o.show(o.simple().content("USE "+e.database+" database").theme(n.theme).position("bottom right")),t.currentDatabase=e.database),t.currentTable=e.name,i("tableSiedenav").open()},t.$on("handleBroadcastDatabases",function(){e.reLoad()}),e.filterCompletions=function(t){console.log(">>>filterCompletions",t);var r={},a=t.toUpperCase(),n=t.toLowerCase();e.vars.databases.forEach(function(e,i){e.tables.forEach(function(o,s){o.fields.forEach(function(l,c){var d={},u=o.name+"."+l.name;if(u){for(var m=-1,b=0,h=0,p=void 0,g=void 0,f=0;f<t.length;f++){var v=u.indexOf(n[f],m+1),y=u.indexOf(a[f],m+1);if(p=v>=0&&(0>y||y>v)?v:y,0>p)return;g=p-m-1,g>0&&(-1===m&&(h+=10),h+=g),b|=1<<p,m=p}d.matchMask=b,d.exactMatch=h?0:1,d.score=(d.score||0)-h,d.dbase=e.name,d.table=o.name,d.field=l.name,r[i]||(r[i]={}),r[i][s]||(r[i][s]={}),r[i][s][c]=d}})})}),e.vars.databases.forEach(function(t,a){r[a]?e.vars.databases[a].active=!0:e.vars.databases[a].active=!1,t.tables.forEach(function(t,n){r[a]&&r[a][n]?e.vars.databases[a].tables[n].active=!0:e.vars.databases[a].tables[n].active=!1,t.fields.forEach(function(t,i){r[a]&&r[a][n]&&r[a][n][i]?e.vars.databases[a].tables[n].fields[i].active=!0:e.vars.databases[a].tables[n].fields[i].active=!1})})})},e.rightMenuProcessTable=function(e){var r=e.item.name,n=e.item.database;"OpenTables"==e.key?window.location="/#/database/"+n+"/table/"+r:"InsertDescribe"==e.key&&a.query("SELECT * FROM system.columns WHERE database='"+n+"' AND table='"+r+"'").then(function(e){var a=[],i=[];e.data.forEach(function(e){a.push(e.name),"Date"==e.type&&i.push(e.name+"=today()")}),-1!==r.indexOf(".")&&(r='"'+r+'"');var o="\nSELECT\n	"+a.join(",\n	")+"\nFROM\n	"+n+"."+r+"\n";i.length&&(o=o+"\nWHERE\n	"+i.join("\n AND \n")),o+="\nLIMIT 100\n\n",console.log(o),t.$emit("handleBroadcastInsertInActive",{value:o})})},e.reLoad=function(){var t=[];e.vars.loaded=!1,e.vars.error=!1,e.vars.databases=[],a.query("SELECT * FROM system.columns").then(function(r){var n=r.data||[];n.forEach(function(e){t[e.database+"."+e.table]||(t[e.database+"."+e.table]=[]),t[e.database+"."+e.table].push({name:e.name,type:e.type,active:!0})}),a.query("SELECT database,name,engine FROM system.tables").then(function(r){var n=r.data||[];e.vars.databases=n.reduce(function(e,r){var a=[{active:!0,value:"Open table",key:"OpenTables",icon:"arrow-expand",item:r},{active:!0,value:"Code Select from",key:"InsertDescribe",icon:"format-size",item:r}],n="";r.engine.match(/Dictionary.*/)&&(n="library"),r.engine.match(/Distributed.*/)&&(n="soundcloud"),r.engine.match(/AggregatingMergeTree.*/)&&(n="cube"),r.engine.match(/MaterializedView.*/)&&(n="border-bottom"),r.engine.match(/SummingMergeTree.*/)&&(n="table-row-plus-after"),r.engine.match(/CollapsingMergeTree.*/)&&(n="table-row-height"),r.engine.match(/$Merge^/)&&(n="source-fork"),r.active=!0,r.classEngine=n,r.rightMenuListTable=a;var i=!0,o=!1,s=void 0;try{for(var l,c=e[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var d=l.value;if("-"!==r.name&&d.name==r.database)return d.tables.push({active:!0,database:r.database,name:r.name,engine:r.engine,classEngine:r.classEngine,fields:t[r.database+"."+r.name],rightMenuList:r.rightMenuListTable}),e}}catch(u){o=!0,s=u}finally{try{!i&&c["return"]&&c["return"]()}finally{if(o)throw s}}return[].concat(_toConsumableArray(e),[{name:r.database,tables:[{active:!0,database:r.database,name:r.name,engine:r.engine,classEngine:r.classEngine,rightMenuList:r.rightMenuListTable,fields:t[r.database+"."+r.name]}]}])},[]),e.selectDatabase(e.vars.databases[0]),a.query("SELECT name FROM system.databases").then(function(t){var r=t.data||[];r.forEach(function(t){var r=!1;e.vars.databases.forEach(function(e){e.name==t.name&&(r=!0)}),r||e.vars.databases.push({name:t.name,tables:[],active:!0})}),e.vars.loaded=!0,e.vars.error=!1},function(){e.vars.loaded=!0,e.vars.error=!0}),s(function(){$("#sideBarMetismenu").metisMenu()},250)},function(){e.vars.loaded=!0,e.vars.error=!0})},function(){e.vars.loaded=!0,e.vars.error=!0})},e.reLoad()}e.module(t.app.name).controller("SidebarController",r),r.$inject=["$scope","$rootScope","$state","API","ThemeService","$mdSidenav","$mdToast","$timeout"]}(angular,smi2),function(e,t){function r(r,a,n,i,o){r.user=n.getConnectionInfo().name,r.themes=i.list,r.vars={disable_exit:window.global_tabix_disable_exit},r.help=function(r){function a(e,r){e.vars={version:t.app.version,buildDate:t.app.buildDate},e.hide=function(){r.hide()},e.cancel=function(){r.cancel()},e.answer=function(e){r.hide(e)}}a.$inject=["$scope","$mdDialog"],o.show({controller:a,templateUrl:"app/base/helpDialogRu.html",parent:e.element(document.body),targetEvent:r,clickOutsideToClose:!0})},r.logout=function(){n.clear(),a.go("login")},r.setUiTheme=function(e){i.set(e.name),window.location.reload()}}e.module(t.app.name).controller("HeaderController",r),r.$inject=["$scope","$state","API","ThemeService","$mdDialog"]}(angular,smi2),ace.define("ace/mode/clickhouse",["require","exports","module","ace/lib/oop","ace/mode/text","ace/token_iterator","ace/mode/folding","ace/mode/clickhouse_FoldMode","ace/mode/clickhouse_highlight_rules"],function(e,t){var r=e("../lib/oop"),a=e("./text").Mode,n=e("./clickhouse_highlight_rules").ClickhouseHighlightRules,i=e("./clickhouse_FoldMode").FoldMode,o=e("./matching_brace_outdent").MatchingBraceOutdent,s=e("./behaviour/cstyle").CstyleBehaviour,l=function(){this.foldingRules=new i,this.$outdent=new o,this.$behaviour=new s,this.HighlightRules=n};r.inherits(l,a),function(){this.lineCommentStart="--",this.getCompletions=function(e,t,r,a){return t.$mode.$highlightRules.completions},this.$id="ace/mode/clickhouse",this.checkOutdent=function(e,t,r){return this.$outdent.checkOutdent(t,r)},this.autoOutdent=function(e,t,r){this.$outdent.autoOutdent(t,r)},this.findTokens=function(t,r,a){t=t.replace(/^(\r\n|\n|\r)/gm,"").replace(/(\r\n|\n|\r)$/gm,"");for(var n=e("ace/token_iterator").TokenIterator,i=e("ace/edit_session").EditSession,o=new i(t,this),s=new n(o,0,0),l=s.getCurrentToken(),c=[];l;){var d=l;if(d.row=s.getCurrentTokenRow(),d.col=s.getCurrentTokenColumn(),d.type==r&&(c.push(d),a))return d.value=d.value.toLowerCase(),d;l=s.stepForward()}return c},this.trim=function(e,t){return t!==!0&&"string"==typeof t&&t.length>0&&(e=e.replace("^("+t+")","  ").replace(t+"$","  "),e=e.replace(new RegExp("^"+t+"|"+t+"$","g"),"  ")),e.trim()},this.collapseAll=function(e){for(var t=e,r=t.foldWidgets,a=t.getLength(),n=0,i=n;a>i;i++)if(null==r[i]&&(r[i]=t.getFoldWidget(i)),"start"==r[i]){var o=t.getFoldWidgetRange(i);if(o&&o.end.row<=a&&o.start.row>=n){i=o.end.row;try{var s=t.addFold("...",o);s&&(s.collapseChildren=depth)}catch(t){}}}},this.replaceVars=function(e,t){return e},this.fetchTokens=function(t){var r={groupby:[],where:[],vars:[],limit:-1},a=e("ace/token_iterator").TokenIterator,n=e("ace/edit_session").EditSession,i=new n(t,this);i.bgTokenizer.start(0);for(var o=new a(i,0,0),s=o.getCurrentToken();s;){var l=s;l.row=o.getCurrentTokenRow(),l.col=o.getCurrentTokenColumn(),console.log("token:",l),s=o.stepForward()}return r},this.splitByTokens=function(t,r,a){t=this.trim(t,";;"),t=this.trim(t,";");var n=e("ace/token_iterator").TokenIterator,i=e("ace/edit_session").EditSession,o=e("ace/range").Range,s=new i(t,this);s.bgTokenizer.start(0);for(var l=new n(s,0,0),c=l.getCurrentToken(),d=[],u=0,m=0,b=!1,h=void 0,p=void 0;c;){var g=c;if(g.row=l.getCurrentTokenRow(),g.col=l.getCurrentTokenColumn(),g.type==r&&(a!==!0&&g.value==a||a===!0)){var f=0;a instanceof String&&(f=a.length),h=new o(u,m,g.row,g.col+f),p=s.getTextRange(h),u=g.row,m=g.col+f,p=this.trim(p,g.value),p.length>2&&("string"==typeof b&&(p=this.trim(p,b)),d.push({sql:p,range:h,keyword:b}),b=g.value)}c=l.stepForward()}return h=new o(u,m,Number.MAX_VALUE,Number.MAX_VALUE),p=s.getTextRange(h),p=this.trim(p,a),"string"==typeof b&&(p=this.trim(p,b)),p.length>2&&d.push({sql:p,range:h,keyword:b}),d}}.call(l.prototype),t.Mode=l}),ace.define("ace/mode/clickhouse_highlight_rules",["require","exports","$rootScope","module","ace/lib/oop","ace/snippets","ace/ext/language_tools","ace/mode/text_highlight_rules"],function(e,t,r){var a=e("../lib/oop"),n=e("./text_highlight_rules").TextHighlightRules,i=function(){var e="SELECT|CASE|THEN|INSERT|UPDATE|DELETE|WHERE|AND|OR|LIMIT|OFFSET|HAVING|AS|FROM|WHEN|ELSE|END|TYPE|LEFT|RIGHT|JOIN|ON|OUTER|DESC|ASC|UNION|CREATE|TABLE|PRIMARY|KEY|FOREIGN|NOT|REFERENCES|DEFAULT|NULL|INNER|CROSS|NATURAL|DATABASE|DROP|GRANT|ANY|BETWEEN|ATTACH|DETACH|DESCRIBE|OPTIMIZE|PREWHERE|TOTALS|DATABASES|PROCESSLIST|SHOW|IF",t="IF\\W+NOT\\W+EXISTS|IF\\W+EXISTS|FORMAT\\W+Vertical|FORMAT\\W+JSONCompact|FORMAT\\W+JSONEachRow|FORMAT\\W+TSKV|FORMAT\\W+TabSeparatedWithNames|FORMAT\\W+TabSeparatedWithNamesAndTypes|FORMAT\\W+TabSeparatedRaw|FORMAT\\W+BlockTabSeparated|FORMAT\\W+CSVWithNames|FORMAT\\W+CSV|FORMAT\\W+JSON|FORMAT\\W+TabSeparated",r="true|false",a="sum|sumIf|avg|avgIf",n="int|numeric|decimal|date|varchar|char|bigint|float|double|bit|binary|text|set|timestamp|money|real|number|integer|uint8|uint16|uint32|uint64|int8|int16|int32|int64|float32|float64|datetime|enum8|enum16|array|tuple|string";if(window.global_builtinFunctions){var i=[];window.global_builtinFunctions.forEach(function(e){i.push(e.name)}),a=i.join("|")}var o="";o=window.global_delimiter?new RegExp(window.global_delimiter):new RegExp(";;");var s="DRAW_GMAPS|DRAW_CALENDAR|DRAW_TEXT|DRAW_HEATMAP|DRAW_CHART|DRAW_BAR|DRAW_GRIDCHART|DRAW_RIVER|DRAW_RAW|DRAW_SANKEYS|DRAW_TREEMAP|DRAW_C3|DRAW_MAP",l=[],c=e.toLowerCase();_.isArray(window.global_keywords_fieldsList)&&window.global_keywords_fieldsList.forEach(function(e){var t=e.name.toLowerCase()+"|";c.indexOf(t)>-1||l.push(e.name)});var d=this.createKeywordMapper({"support.function":a,keyword:e,"constant.language":r,"storage.type":n,"markup.bold":window.global_keywords_tables,"markup.heading":l.join("|")},"identifier",!0);this.$rules={start:[{token:"comment",regex:"--.*$",caseInsensitive:!0},{token:"comment.block",start:"```",end:"```"},{token:"keyword",regex:"GROUP\\W+BY|ORDER\\W+BY|LIMIT\\W+\\d+\\W+BY\\W+"},{token:"variable.language",regex:/\$[\w]+(?:\[[\w\]+]|[=\-]>\w+)?/},{token:"variable.other",regex:/@[\w]+(?:\[[\w\]+]|[=\-]>\w+)?/},{token:"comment",start:"/\\*",end:"\\*/"},{token:"string",regex:'".*?"'},{token:"storage",regex:t},{token:"invalid.illegal",regex:s},{token:"string",regex:"'.*?'"},{token:"constant.numeric",regex:"[+-]?\\d+(?:(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)?\\b"},{token:d,regex:"[a-zA-Z_$][a-zA-Z0-9_$]*\\b"},{token:"constant.character.escape",regex:o},{token:"punctuation",regex:/[?:,;.]/},{token:"keyword.operator",regex:"\\+|\\-|\\/|\\/\\/|%|<@>|@>|<@|&|\\^|~|<|>|<=|=>|==|!=|<>|="},{token:"paren.lparen",regex:"[\\(\\{]"},{token:"paren.rparen",regex:"[\\)\\}]"},{token:"text",regex:"\\s+"}]},this.normalizeRules();var u=function(e,t,r){if(!window.global_chFunctionsHelp)return!1;if(!window.global_chFunctionsHelp.functions)return!1;var a="<span>",n=e;if("undefined"!=typeof window.global_chFunctionsHelp.functions[e]?n=e:"undefined"!=typeof window.global_chFunctionsHelp.functions[t]&&(n=t),"undefined"!=typeof window.global_chFunctionsHelp.functions[n]){var i=window.global_lang;i||(i="ru");var o=window.global_chFunctionsHelp.functions[n],s="",l="";o.desc&&(s=o.bracket,l=o.desc[i],l||(l=o.desc.en?o.desc.en:o.desc.ru)),l&&(l=l.replace(/\.\s*/gm,".<br>")),a='<span class="ace_doc-header"><b>'+e+s+'</b></span><br><span class="ace_doc-description">'+l+" </span>"}else a='<span class="ace_doc-header"><b>'+e+"( ) </b></span><br>"+t;return a+'<a title="close" class="ace_doc-tooltip-boxclose"></a></span></div>'},m=function(e,t){return'<div style="padding: 15px 5px 5px 15px"><b>'+e+"</b><br>"+t+"</div>"},b=[],h=function(e,t,r){e.forEach(function(e){b.push({name:e,value:e,score:0,meta:t,docHTML:m(e,t),iconClass:r})})};h(e.split("|"),"keyword","keyword"),h("GROUP BY|ORDER BY|FORMAT JSON|FORMAT JSONCompact|FORMAT JSONEachRow|FORMAT TSKV|FORMAT TabSeparated|FORMAT TabSeparatedWithNames|FORMAT TabSeparatedWithNamesAndTypes|FORMAT TabSeparatedRaw|FORMAT BlockTabSeparated|FORMAT CSV|FORMAT CSVWithNames".split("|"),"keyword","keyword"),h(s.split("|"),"draw","draw"),h(n.split("|"),"type","type"),h(window.global_keywords_tables.split("|"),"[table]","table"),window.global_builtinFunctions&&window.global_builtinFunctions.forEach(function(e){b.push({name:e.name,value:e.name+"( )",caption:e.name,score:e.score,meta:"function",iconClass:"function",docHTML:u(e.name,e.origin,e.comb)})}),window.global_keywords_dictList&&window.global_keywords_dictList.forEach(function(e){b.push({name:e.dic,value:e.dic,caption:e.title,score:0,meta:"dic",iconClass:"dict",docHTML:m(e.title,e.dic)})}),window.global_keywords_fieldsList&&window.global_keywords_fieldsList.forEach(function(e){var t=e.table+"."+e.name,r=e.name,a="type:"+e.type+"<br><br>default_type:"+e.default_type+"<br>"+e.default_expression;b.push({name:t,value:r,score:20,meta:e.table,iconClass:"field",docHTML:m(t,a)})}),this.completions=b};a.inherits(i,n),t.ClickhouseHighlightRules=i}),ace.define("ace/mode/matching_brace_outdent",["require","exports","module","ace/range"],function(e,t,r){var a=e("ace/range").Range,n=function(){};(function(){this.checkOutdent=function(e,t){return/^\s+$/.test(e)?/^\s*\}/.test(t):!1},this.autoOutdent=function(e,t){var r=e.getLine(t),n=r.match(/^(\s*\})/);if(!n)return 0;var i=n[1].length,o=e.findMatchingBracket({row:t,column:i});if(!o||o.row==t)return 0;var s=this.$getIndent(e.getLine(o.row));e.replace(new a(t,0,t,i-1),s)},this.$getIndent=function(e){return e.match(/^\s*/)[0]}}).call(n.prototype),t.MatchingBraceOutdent=n}),ace.define("ace/mode/clickhouse_FoldMode",["$rootScope","require","exports","module","ace/lib/oop","ace/range","ace/mode/sqlserver","ace/mode/folding/cstyle"],function(e,t,r){var a=e("../lib/oop"),n=e("ace/mode/folding/cstyle").FoldMode,i=(e("ace/range").Range,e("ace/token_iterator").TokenIterator),o=t.FoldMode=function(){};a.inherits(o,n),function(){this.foldingRules="cStyle",this.foldingStartMarker=/\(|\{/,this.getFoldWidgetRange=function(e,t,r,a){for(var n=new i(e,r,0),o=n.getCurrentToken(),s=!1;o;){var l=o,c=n.getCurrentTokenPosition();if(o=n.stepForward(),"paren.lparen"!=l.type||"("!=l.value&&"{"!=l.value||(s=e.getBracketRange(c)),s)break}return s}}.call(o.prototype)}),window.global_chFunctionsHelp={functions:{VAR_SAMP:{bracket:"()",desc:{ru:"",en:""}},STDDEV_POP:{bracket:"()",desc:{ru:"",en:""}},VAR_POP:{bracket:"()",desc:{ru:"",en:""}},medianTDigestWeighted:{bracket:"()",desc:{ru:"",en:""}},anyHeavy:{bracket:"()",desc:{ru:"",en:""}},uniqCombinedRaw:{bracket:"()",desc:{ru:"",en:""}},quantileTDigestWeighted:{bracket:"()",desc:{ru:"",en:""}},quantilesTDigestWeighted:{bracket:"()",desc:{ru:"",en:""}},quantilesTDigest:{bracket:"()",desc:{ru:"",en:""}},quantilesExact:{bracket:"()",desc:{ru:"",en:""}},medianExactWeighted:{bracket:"()",desc:{ru:"",en:""}},medianTDigest:{bracket:"()",desc:{ru:"",en:""}},medianExact:{bracket:"()",desc:{ru:"",en:""}},quantilesExactWeighted:{bracket:"()",desc:{ru:"",en:""}},STDDEV_SAMP:{bracket:"()",desc:{ru:"",en:""}},COVAR_SAMP:{bracket:"()",desc:{ru:"",en:""}},COVAR_POP:{bracket:"()",desc:{ru:"",en:""}},uniqCombinedLinearCounting:{bracket:"()",desc:{ru:"",en:""}},uniqCombinedBiasCorrected:{bracket:"()",desc:{ru:"",en:""}},debug:{bracket:"()",desc:{ru:"",en:""}},rowNumberInBlock:{bracket:"()",desc:{ru:"",en:""}},blockNumber:{bracket:"()",desc:{ru:"",en:""}},toColumnTypeName:{bracket:"()",desc:{ru:"",en:""}},dictGetDateOrDefault:{bracket:"()",desc:{ru:"",en:""}},dictGetFloat64OrDefault:{bracket:"()",desc:{ru:"",en:""}},dictGetInt64OrDefault:{bracket:"()",desc:{ru:"",en:""}},dictGetUInt32OrDefault:{bracket:"()",desc:{ru:"",en:""}},positionCaseInsensitiveUTF8:{bracket:"()",desc:{ru:"",en:""}},dictGetUInt16OrDefault:{bracket:"()",desc:{ru:"",en:""}},bitTestAll:{bracket:"()",desc:{ru:"",en:""}},metroHash64:{bracket:"()",desc:{ru:"",en:""}},arrayReduce:{bracket:"()",desc:{ru:"",en:""}},farmHash64:{bracket:"()",desc:{ru:"",en:""}},arrayUniq:{bracket:"()",desc:{ru:"",en:""}},concatAssumeInjective:{bracket:"()",desc:{ru:"",en:""}},dictGetInt16OrDefault:{bracket:"()",desc:{ru:"",en:""}},cutIPv6:{bracket:"()",desc:{ru:"",en:""}},IPv4ToIPv6:{bracket:"()",desc:{ru:"",en:""}},dictGetDateTimeOrDefault:{bracket:"()",desc:{ru:"",en:""}},positionCaseInsensitive:{bracket:"()",desc:{ru:"",en:""}},multiIf:{bracket:"()",desc:{ru:"",en:""}},toUnixTimestamp:{bracket:"()",desc:{ru:"",en:""}},dictGetUInt64OrDefault:{bracket:"()",desc:{ru:"",en:""}},dictGetUInt8OrDefault:{bracket:"()",desc:{ru:"",en:""}},dictGetFloat32OrDefault:{bracket:"()",desc:{ru:"",en:""}},bitTest:{bracket:"()",desc:{ru:"",en:""}},regionToTopContinent:{bracket:"()",desc:{ru:"",en:""}},dictGetInt8OrDefault:{bracket:"()",desc:{ru:"",en:""}},dictGetInt32OrDefault:{bracket:"()",desc:{ru:"",en:""}},bitTestAny:{bracket:"()",desc:{ru:"",en:""}},indexHint:{bracket:"()",desc:{ru:"",en:""}},identity:{bracket:"()",desc:{ru:"",en:""}},runningAccumulate:{bracket:"()",desc:{ru:"",en:""}},finalizeAggregation:{bracket:"()",desc:{ru:"",en:""}},randConstant:{bracket:"()",desc:{ru:"",en:""}},greatCircleDistance:{bracket:"()",desc:{ru:"",en:""}},corr:{bracket:"(x, y)",desc:{ru:'Вычисляет коэффициент корреляции Пирсона: <span class="inline-example">Σ((x - x̅)(y - y̅)) / sqrt(Σ((x - x̅)<sup>2</sup>) * Σ((y - y̅)<sup>2</sup>))</span>.',en:'Calculates the Pearson correlation coefficient: <span class="inline-example">Σ((x - x̅)(y - y̅)) / sqrt(Σ((x - x̅)<sup>2</sup>) * Σ((y - y̅)<sup>2</sup>))</span>.'}},stddevPop:{bracket:"(x)",desc:{ru:"Результат равен квадратному корню от varPop(x).",en:"The result is equal to the square root of &#39;varPop(x)&#39;."}},varPop:{bracket:"(x, y)",desc:{ru:"Вычисляет величину %%Σ((x - x̅)(y - y̅)) / n%%.",en:"Calculates the value of %%Σ((x - x̅)(y - y̅)) / n%%."}},argMin:{bracket:"(arg, val)",desc:{ru:"Вычисляет значение arg при минимальном значении val. Если есть несколько разных значений arg для минимальных значений val, то выдаётся первое попавшееся из таких значений.",en:"Calculates the &#39;arg&#39; value for a minimal &#39;val&#39; value. If there are several different values of &#39;arg&#39; for minimal values of &#39;val&#39;, the first of these values encountered is output."}},quantileExactWeighted:{bracket:"(level)(x, weight)",desc:{ru:'Вычисляет квантиль уровня level точно. При этом, каждое значение учитывается с весом weight - как будто оно присутствует weight раз. Аргументы функции можно рассматривать как гистограммы, где значению x соответствует "столбик" гистограммы высоты weight, а саму функцию можно рассматривать как суммирование гистограмм. <br>  <br> В качестве алгоритма используется хэш-таблица. Из-за этого, в случае, если передаваемые значения часто повторяются, функция потребляет меньше оперативки, чем quantileExact. Вы можете использовать эту функцию вместо quantileExact, указав в качестве веса число 1.',en:""}},min:{bracket:"(v)",desc:{ru:"Минимальная скорость выполнения запроса в строчках в секунду. Проверяется на каждый блок данных по истечении timeout_before_checking_execution_speed. Если скорость выполнения запроса оказывается меньше, то кидается исключение.",en:"Minimal execution speed in rows per second. Checked on every data block when &#39;timeout_before_checking_execution_speed&#39; expires. If the execution speed is lower, an exception is thrown."}},varSamp:{bracket:"(x, y)",desc:{ru:"Вычисляет величину %%Σ((x - x̅)(y - y̅)) / (n - 1)%%. <br>  <br> Возвращает Float64. В случае, когда n &lt;= 1, возвращается +∞.",en:"Calculates the value of %%Σ((x - x̅)(y - y̅)) / (n - 1)%%. <br>  <br> Returns Float64. If n &lt;= 1, it returns +∞."}},anyLast:{bracket:"(x)",desc:{ru:"Выбирает последнее попавшееся значение. <br> Результат так же недетерминирован, как и для функции any.",en:"Selects the last value encountered. <br> The result is just as indeterminate as for the &#39;any&#39; function."}},argMax:{bracket:"(arg, val)",desc:{ru:"Вычисляет значение arg при максимальном значении val. Если есть несколько разных значений arg для максимальных значений val, то выдаётся первое попавшееся из таких значений.",en:"Calculates the &#39;arg&#39; value for a maximum &#39;val&#39; value. If there are several different values of &#39;arg&#39; for maximum values of &#39;val&#39;, the first of these values encountered is output."}},count:{bracket:"()",desc:{ru:"После скольких раз, когда скомпилированный кусок кода мог пригодиться, выполнить его компиляцию. По умолчанию - 3. <br> В случае, если значение равно нулю, то компиляция выполняется синхронно, и запрос будет ждать окончания процесса компиляции перед продолжением выполнения. Это можно использовать для тестирования, иначе используйте значения, начиная с 1. Как правило, компиляция занимает по времени около 5-10 секунд. <br> В случае, если значение равно 1 или больше, компиляция выполняется асинхронно, в отдельном потоке. При готовности результата, он сразу же будет использован, в том числе, уже выполняющимися в данный момент запросами. <br>  <br> Скомпилированный код требуется для каждого разного сочетания используемых в запросе агрегатных функций и вида ключей в GROUP BY. <br> Результаты компиляции сохраняются в директории build в виде .so файлов. Количество результатов компиляции не ограничено, так как они не занимают много места. При перезапуске сервера, старые результаты будут использованы, за исключением случая обновления сервера - тогда старые результаты удаляются.",en:"Counts the number of rows. Accepts zero arguments and returns UInt64. <br> The syntax COUNT(DISTINCT x) is not supported. The separate &#39;uniq&#39; aggregate function exists for this purpose. <br>  <br> A &#39;SELECT count() FROM table&#39; query is not optimized, because the number of entries in the table is not stored separately. It will select some small column from the table and count the number of values in it."}},any:{bracket:"(x)",desc:{ru:"Выбирает последнее попавшееся значение. <br> Результат так же недетерминирован, как и для функции any.",en:"Selects the last value encountered. <br> The result is just as indeterminate as for the &#39;any&#39; function."}},avg:{bracket:"(x)",desc:{ru:"Вычисляет среднее. <br> Работает только для чисел. <br> Результат всегда - Float64.",en:"Calculates the average. <br> Only works for numbers. <br> The result is always Float64."}},sequenceMatch:{bracket:"(pattern)(time, cond1, cond2, ...)",desc:{ru:"Сопоставление с образцом для цепочки событий. <br>  <br> pattern - строка, содержащая шаблон для сопоставления. Шаблон похож на регулярное выражение. <br> time - время события, тип DateTime <br> cond1, cond2 ... - от одного до 32 аргументов типа UInt8 - признаков, было ли выполнено некоторое условие для события. <br>  <br> Функция собирает в оперативке последовательность событий. Затем производит проверку на соответствие этой последовательности шаблону. <br> Возвращает UInt8 - 0, если шаблон не подходит и 1, если шаблон подходит. <br>  <br> Пример: %%sequenceMatch('(?1).*(?2)')(EventTime, URL LIKE '%company%', URL LIKE '%cart%')%% <br> - была ли цепочка событий, в которой посещение страницы с адресом, содержащим %%company%% было раньше по времени посещения страницы с адресом, содержащим %%cart%%. <br>  <br> Это вырожденный пример. Его можно записать с помощью других агрегатных функций: <br> %%minIf(EventTime, URL LIKE '%company%') &lt; maxIf(EventTime, URL LIKE '%cart%')%%. <br> Но в более сложных случаях, такого решения нет. <br>  <br> Синтаксис шаблонов: <br> %%(?1)%% - ссылка на условие (вместо 1 - любой номер); <br> %%.*%% - произвольное количество любых событий; <br> %%(?t&gt;=1800)%% - условие на время; <br> за указанное время допускается любое количество любых событий; <br> вместо >= могут использоваться операторы &lt;, &gt;, &lt;=; <br> вместо 1800 может быть любое число; <br>  <br> События, произошедшие в одну секунду",en:'Pattern matching for event chains. <br>  <br> &#39;pattern&#39; is a string containing a pattern to match. The pattern is similar to a regular expression. <br> &#39;time&#39; is the event time of the DateTime type. <br> &#39;cond1, cond2 ...&#39; are from one to 32 arguments of the UInt8 type that indicate whether an event condition was met. <br>  <br> The function collects a sequence of events in RAM. Then it checks whether this sequence matches the pattern. <br> It returns UInt8 - 0 if the pattern isn&#39;t matched, or 1 if it matches. <br>  <br> Example: %%sequenceMatch(&#39;(?1).*(?2)&#39;)(EventTime, URL LIKE &#39;%company%&#39;, URL LIKE &#39;%cart%&#39;)%% <br> - whether there was a chain of events in which pages with the address in %%company%% were visited earlier than pages with the address in %%cart%%. <br>  <br> This is a degenerate example. You could write it using other aggregate functions: <br> %%minIf(EventTime, URL LIKE &#39;%company%&#39;) &lt; maxIf(EventTime, URL LIKE &#39;%cart%&#39;)%%. <br> However, there is no such solution for more complex situations. <br>  <br> Pattern syntax: <br> %%(?1)%% - Reference to a condition (any number in place of 1). <br> %%.*%% - Any number of events. <br> <span class="inline-example">(?t>=1800)</span> - Time condition. <br> Any quantity of any type of events is allowed over the specified time. <br> The operators &lt;, >, &lt;= may be used instead of  >=. <br> Any number ma'
}},stddevSamp:{bracket:"(x)",desc:{ru:"Результат равен квадратному корню от varSamp(x).",en:"The result is equal to the square root of &#39;varSamp(x)&#39;."}},medianDeterministic:{bracket:"(x, determinator)",desc:{ru:"",en:"This function works similarly to the &#39;median&#39; function - it approximates the median. However, in contrast to &#39;median&#39;, the result is deterministic and does not depend on the order of query execution. <br>  <br> To achieve this, the function takes a second argument - the &quot;determinator&quot;. This is a number whose hash is used instead of a random number generator in the reservoir sampling algorithm. For the function to work correctly, the same determinator value should not occur too often. For the determinator, you can use an event ID, user ID, and so on. <br>  <br> Don&#39;t use this function for calculating timings. The &#39;medianTiming&#39;, &#39;quantileTiming&#39;, and &#39;quantilesTiming&#39; functions are better suited to this purpose."}},quantilesTimingWeighted:{bracket:"(level1, level2, ...)(x, weight)",desc:{ru:"",en:"Calculates the quantiles of all specified levels using the same algorithm as the &#39;medianTimingWeighted&#39; function."}},uniq:{bracket:"(N)(x)",desc:{ru:"Вычисляет количество различных значений аргумента, если оно меньше или равно N. <br> В случае, если количество различных значений аргумента больше N, возвращает N + 1. <br>  <br> Рекомендуется использовать для маленьких N - до 10. Максимальное значение N - 100. <br>  <br> Для состояния агрегатной функции используется количество оперативки равное 1 + N * размер одного значения байт. <br> Для строк запоминается некриптографический хэш, имеющий размер 8 байт. То есть, для строк вычисление приближённое. <br>  <br> Функция также работает для нескольких аргументов. <br>  <br> Работает максимально быстро за исключением патологических случаев, когда используется большое значение N и количество уникальных значений чуть меньше N. <br>  <br> Пример применения: <br> Задача: показывать в отчёте только поисковые фразы, по которым было хотя бы 5 уникальных посетителей. <br> Решение: пишем в запросе %%GROUP BY SearchPhrase HAVING uniqUpTo(4)(UserID) &gt;= 5%%",en:'Calculates the number of different argument values, if it is less than or equal to N. <br> If the number of different argument values is greater than N, it returns N + 1. <br>  <br> Recommended for use with small Ns, up to 10. The maximum N value is 100. <br>  <br> For the state of an aggregate function, it uses the amount of memory equal to 1 + N * the size of one value of bytes. <br> For strings, it stores a non-cryptographic hash of 8 bytes. That is, the calculation is approximated for strings. <br>  <br> It works as fast as possible, except for cases when a large N value is used and the number of unique values is slightly less than N. <br>  <br> Usage example: <br> Problem: Generate a report that shows only keywords that produced at least 5 unique users. <br> Solution: Write in the query <span class="inline-example">GROUP BY SearchPhrase HAVING uniqUpTo(4)(UserID) >= 5</span>'}},covarSamp:{bracket:"(x, y)",desc:{ru:"Вычисляет величину %%Σ((x - x̅)(y - y̅)) / (n - 1)%%. <br>  <br> Возвращает Float64. В случае, когда n &lt;= 1, возвращается +∞.",en:"Calculates the value of %%Σ((x - x̅)(y - y̅)) / (n - 1)%%. <br>  <br> Returns Float64. If n &lt;= 1, it returns +∞."}},max:{bracket:"(v)",desc:{ru:"Максимальное количество байт (несжатых данных), которых можно передать на удалённый сервер или сохранить во временную таблицу, при использовании GLOBAL IN.",en:"Maximum number of bytes (uncompressed data) that can be passed to a remote server or saved in a temporary table when using GLOBAL IN."}},quantileTDigest:{bracket:"(level)(x)",desc:{ru:"Вычисляет квантиль уровня level приближённо, с использованием алгоритма <a href='https://github.com/tdunning/t-digest/raw/master/docs/t-digest-paper/histo.pdf'>t-digest</a>. Максимальная погрешность составляет 1%. Расход памяти на состояние пропорционален логарифму от количества переданных значений. <br>  <br> Производительность функции ниже quantile, quantileTiming. По соотношению размера состояния и точности, функция существенно лучше, чем quantile. <br>  <br> Результат зависит от порядка выполнения запроса, и является недетерминированным.",en:""}},quantilesTiming:{bracket:"(level1, level2, ...)(x, weight)",desc:{ru:"",en:"Calculates the quantiles of all specified levels using the same algorithm as the &#39;medianTimingWeighted&#39; function."}},quantiles:{bracket:"(level1, level2, ...)(x, determinator)",desc:{ru:"Для всех quantile-функций, также присутствуют соответствующие quantiles-функции: %%quantiles%%, %%quantilesDeterministic%%, %%quantilesTiming%%, %%quantilesTimingWeighted%%, %%quantilesExact%%, %%quantilesExactWeighted%%, %%quantilesTDigest%%. Эти функции за один проход вычисляют все квантили перечисленных уровней и возвращают массив вычисленных значений.",en:"Calculates the quantiles of all specified levels using the same algorithm as the &#39;medianDeterministic&#39; function."}},quantile:{bracket:"(level1, level2, ...)(x, determinator)",desc:{ru:"Для всех quantile-функций, также присутствуют соответствующие quantiles-функции: %%quantiles%%, %%quantilesDeterministic%%, %%quantilesTiming%%, %%quantilesTimingWeighted%%, %%quantilesExact%%, %%quantilesExactWeighted%%, %%quantilesTDigest%%. Эти функции за один проход вычисляют все квантили перечисленных уровней и возвращают массив вычисленных значений.",en:"Calculates the quantiles of all specified levels using the same algorithm as the &#39;medianDeterministic&#39; function."}},groupArray:{bracket:"(x)",desc:{ru:"Составляет массив из значений аргумента. <br> Значения в массив могут быть добавлены в любом (недетерминированном) порядке. <br>  <br> В некоторых случаях, вы всё-таки можете рассчитывать на порядок выполнения запроса. Это - случаи, когда SELECT идёт из подзапроса, в котором используется ORDER BY.",en:"Creates an array of argument values. <br> Values can be added to the array in any (indeterminate) order. <br>  <br> In some cases, you can rely on the order of execution. This applies to cases when SELECT comes from a subquery that uses ORDER BY."}},sum:{bracket:"(x)",desc:{ru:"Вычисляет сумму. <br> Работает только для чисел.",en:"Calculates the sum. <br> Only works for numbers."}},median:{bracket:"(x, weight)",desc:{ru:"Для всех quantile-функций, также присутствуют соответствующие median-функции: %%median%%, %%medianDeterministic%%, %%medianTiming%%, %%medianTimingWeighted%%, %%medianExact%%, %%medianExactWeighted%%, %%medianTDigest%%. Они являются синонимами и их поведение ничем не отличается.",en:"Differs from the &#39;medianTiming&#39; function in that it has a second argument - &quot;weights&quot;. Weight is a non-negative integer. <br> The result is calculated as if the &#39;x&#39; value were passed &#39;weight&#39; number of times to the &#39;medianTiming&#39; function."}},quantileTiming:{bracket:"(level)(x, weight)",desc:{ru:'Отличается от функции medianTiming наличием второго аргумента - "веса". Вес - неотрицательное целое число. <br> Результат считается так же, как если бы в функцию medianTiming значение x было передано weight количество раз.',en:"Calculates the quantile of &#39;level&#39; using the same algorithm as the &#39;medianTimingWeighted&#39; function."}},quantileTimingWeighted:{bracket:"(level)(x, weight)",desc:{ru:'Отличается от функции medianTiming наличием второго аргумента - "веса". Вес - неотрицательное целое число. <br> Результат считается так же, как если бы в функцию medianTiming значение x было передано weight количество раз.',en:"Calculates the quantile of &#39;level&#39; using the same algorithm as the &#39;medianTimingWeighted&#39; function."}},groupUniqArray:{bracket:"(x)",desc:{ru:"Составляет массив из различных значений аргумента. Расход оперативки такой же, как у функции uniqExact.",en:"Creates an array from different argument values. Memory consumption is the same as for the &#39;uniqExact&#39; function."}},uniqHLL12:{bracket:"(x)",desc:{ru:"Приближённо вычисляет количество различных значений аргумента, используя алгоритм HyperLogLog. <br> Используется 2<sup>12</sup> 5-битовых ячеек. Размер состояния чуть больше 2.5 КБ. <br>  <br> Результат детерминирован (не зависит от порядка выполнения запроса). <br>  <br> В большинстве случаев, используйте функцию uniq или uniqCombined.",en:"Uses the HyperLogLog algorithm to approximate the number of different values of the argument. It uses 2<sup>12</sup> 5-bit cells. The size of the state is slightly more than 2.5 KB. <br>  <br> The result is determinate (it doesn&#39;t depend on the order of query execution). <br>  <br> In most cases, use the &#39;uniq&#39; function. You should only use this function if you understand its advantages well."}},covarPop:{bracket:"(x, y)",desc:{ru:"Вычисляет величину %%Σ((x - x̅)(y - y̅)) / n%%.",en:"Calculates the value of %%Σ((x - x̅)(y - y̅)) / n%%."}},sequenceCount:{bracket:"(pattern)(time, cond1, cond2, ...)",desc:{ru:"Аналогично функции sequenceMatch, но возвращает не факт наличия цепочки событий, а UInt64 - количество найденных цепочек. <br> Цепочки ищутся без перекрытия. То есть, следующая цепочка может начаться только после окончания предыдущей.",en:""}},quantileDeterministic:{bracket:"(level)(x, determinator)",desc:{ru:'Работает аналогично функции quantile, но, в отличие от неё, результат является детерминированным и не зависит от порядка выполнения запроса. <br>  <br> Для этого, функция принимает второй аргумент - "детерминатор". Это некоторое число, хэш от которого используется вместо генератора случайных чисел в алгоритме reservoir sampling. Для правильной работы функции, одно и то же значение детерминатора не должно встречаться слишком часто. В качестве детерминатора вы можете использовать идентификатор события, идентификатор посетителя и т. п. <br>  <br> Не используйте эту функцию для рассчёта таймингов. Для этого есть более подходящая функции - quantileTiming.',en:"Calculates the quantile of &#39;level&#39; using the same algorithm as the &#39;medianDeterministic&#39; function."}},quantileExact:{bracket:"(level)(x, weight)",desc:{ru:'Вычисляет квантиль уровня level точно. При этом, каждое значение учитывается с весом weight - как будто оно присутствует weight раз. Аргументы функции можно рассматривать как гистограммы, где значению x соответствует "столбик" гистограммы высоты weight, а саму функцию можно рассматривать как суммирование гистограмм. <br>  <br> В качестве алгоритма используется хэш-таблица. Из-за этого, в случае, если передаваемые значения часто повторяются, функция потребляет меньше оперативки, чем quantileExact. Вы можете использовать эту функцию вместо quantileExact, указав в качестве веса число 1.',en:""}},quantilesDeterministic:{bracket:"(level1, level2, ...)(x, determinator)",desc:{ru:"",en:"Calculates the quantiles of all specified levels using the same algorithm as the &#39;medianDeterministic&#39; function."}},medianTiming:{bracket:"(x, weight)",desc:{ru:"",en:"Differs from the &#39;medianTiming&#39; function in that it has a second argument - &quot;weights&quot;. Weight is a non-negative integer. <br> The result is calculated as if the &#39;x&#39; value were passed &#39;weight&#39; number of times to the &#39;medianTiming&#39; function."}},medianTimingWeighted:{bracket:"(x, weight)",desc:{ru:"",en:"Differs from the &#39;medianTiming&#39; function in that it has a second argument - &quot;weights&quot;. Weight is a non-negative integer. <br> The result is calculated as if the &#39;x&#39; value were passed &#39;weight&#39; number of times to the &#39;medianTiming&#39; function."}},uniqExact:{bracket:"(x)",desc:{ru:"Вычисляет количество различных значений аргумента, точно. <br> Не стоит бояться приближённых расчётов. Поэтому, используйте лучше функцию uniq. <br> Функцию uniqExact следует использовать, если вам точно нужен точный результат. <br>  <br> Функция uniqExact расходует больше оперативки, чем функция uniq, так как размер состояния неограниченно растёт по мере роста количества различных значений.",en:"Calculates the number of different values of the argument, exactly. <br> There is no reason to fear approximations, so it&#39;s better to use the &#39;uniq&#39; function. <br> You should use the &#39;uniqExact&#39; function if you definitely need an exact result. <br>  <br> The &#39;uniqExact&#39; function uses more memory than the &#39;uniq&#39; function, because the size of the state has unbounded growth as the number of different values increases."}},uniqCombined:{bracket:"(x)",desc:{ru:"Приближённо вычисляет количество различных значений аргумента. Работает для чисел, строк, дат, дат-с-временем, для нескольких аргументов и аргументов-кортежей. <br>  <br> Используется комбинация трёх алгоритмов: массив, хэш-таблица и HyperLogLog с таблицей коррекции погрешности. Расход памяти в несколько раз меньше, чем у функции uniq, а точность в несколько раз выше. Скорость работы чуть ниже, чем у функции uniq, но иногда может быть даже выше - в случае распределённых запросов, в которых по сети передаётся большое количество состояний агрегации. Максимальный размер состояния составляет 96 KiB (HyperLogLog из 2<sup>17</sup> 6-битовых ячеек). <br>  <br> Результат детерминирован (не зависит от порядка выполнения запроса). <br>  <br> Функция uniqCombined является хорошим выбором по умолчанию для подсчёта количества различных значений.",en:""}},uniqUpTo:{bracket:"(N)(x)",desc:{ru:"Вычисляет количество различных значений аргумента, если оно меньше или равно N. <br> В случае, если количество различных значений аргумента больше N, возвращает N + 1. <br>  <br> Рекомендуется использовать для маленьких N - до 10. Максимальное значение N - 100. <br>  <br> Для состояния агрегатной функции используется количество оперативки равное 1 + N * размер одного значения байт. <br> Для строк запоминается некриптографический хэш, имеющий размер 8 байт. То есть, для строк вычисление приближённое. <br>  <br> Функция также работает для нескольких аргументов. <br>  <br> Работает максимально быстро за исключением патологических случаев, когда используется большое значение N и количество уникальных значений чуть меньше N. <br>  <br> Пример применения: <br> Задача: показывать в отчёте только поисковые фразы, по которым было хотя бы 5 уникальных посетителей. <br> Решение: пишем в запросе %%GROUP BY SearchPhrase HAVING uniqUpTo(4)(UserID) &gt;= 5%%",en:'Calculates the number of different argument values, if it is less than or equal to N. <br> If the number of different argument values is greater than N, it returns N + 1. <br>  <br> Recommended for use with small Ns, up to 10. The maximum N value is 100. <br>  <br> For the state of an aggregate function, it uses the amount of memory equal to 1 + N * the size of one value of bytes. <br> For strings, it stores a non-cryptographic hash of 8 bytes. That is, the calculation is approximated for strings. <br>  <br> It works as fast as possible, except for cases when a large N value is used and the number of unique values is slightly less than N. <br>  <br> Usage example: <br> Problem: Generate a report that shows only keywords that produced at least 5 unique users. <br> Solution: Write in the query <span class="inline-example">GROUP BY SearchPhrase HAVING uniqUpTo(4)(UserID) >= 5</span>'}},substring:{bracket:"(s, offset, length)",desc:{ru:"Так же, как substring, но для кодовых точек Unicode. Работает при допущении, что строка содержит набор байт, представляющий текст в кодировке UTF-8. Если допущение не выполнено - то возвращает какой-нибудь результат (не кидает исключение).",en:"The same as &#39;substring&#39;, but for Unicode code points. Works under the assumption that the string contains a set of bytes representing a UTF-8 encoded text. If this assumption is not met, it returns some result (it doesn&#39;t throw an exception)."}},notLike:{bracket:"(haystack, pattern), haystack NOT LIKE pattern operator",desc:{ru:"То же, что like, но с отрицанием.",en:"The same thing as &#39;like&#39;, but negative."}},hostName:{bracket:"()",desc:{ru:"Возвращает строку - имя хоста, на котором эта функция была выполнена. При распределённой обработке запроса, это будет имя хоста удалённого сервера, если функция выполняется на удалённом сервере.",en:"Returns a string with the name of the host that this function was performed on. For distributed processing, this is the name of the remote server host, if the function is performed on a remote server."}},globalNotIn:{bracket:"(v)",desc:{ru:'Смотрите раздел "Операторы IN".',en:"See the section &quot;IN operators&quot;."}},or:{bracket:"(v)",desc:{ru:"То же самое, что и max_temporary_columns, но без учёта столбцов-констант. <br> Стоит заметить, что столбцы-константы довольно часто образуются в процессе выполнения запроса, но расходуют примерно нулевое количество вычислительных ресурсов.",en:"The same thing as &#39;max_temporary_columns&#39;, but without counting constant columns. <br> Note that constant columns are formed fairly often when running a query, but they require approximately zero computing resources."}},extractAll:{bracket:"(haystack, pattern)",desc:{ru:"Извлечение всех фрагментов строки по регулярному выражению. Если haystack не соответствует регулярному выражению pattern, то возвращается пустая строка. Возвращается массив строк, состоящий из всех соответствий регулярному выражению. В остальном, поведение аналогично функции extract (по прежнему, вынимается первый subpattern, или всё выражение, если subpattern-а нет).",en:"Extracts all the fragments of a string using a regular expression. If &#39;haystack&#39; doesn&#39;t match the &#39;pattern&#39; regex, an empty string is returned. Returns an array of strings consisting of all matches to the regex. In general, the behavior is the same as the &#39;extract&#39; function (it takes the first subpattern, or the entire expression if there isn&#39;t a subpattern)."}},arrayFirst:{bracket:"(func, arr1, ...)",desc:{ru:"Вернуть индекс первого элемента массива arr1, для которого функция func возвращает не 0.",en:"Returns the index of the first element in the &#39;arr1&#39; array for which &#39;func&#39; returns something other than 0."}},notEquals:{bracket:"(v)",desc:{ru:"",en:""}},arrayExists:{bracket:"([func,] arr1, ...)",desc:{ru:"Вернуть 1, если существует хотя бы один элемент массива arr, для которого функция func возвращает не 0. Иначе вернуть 0.",en:"Returns 1 if there is at least one element in &#39;arr&#39; for which &#39;func&#39; returns something other than 0. Otherwise, it returns 0."}},arrayCount:{bracket:"([func,] arr1, ...)",desc:{ru:"Вернуть количество элементов массива arr, для которых функция func возвращает не 0. Если func не указана - вернуть количество ненулевых элементов массива.",en:"Returns the number of elements in &#39;arr&#39; for which &#39;func&#39; returns something other than 0. If &#39;func&#39; is not specified, it returns the number of non-zero items in the array."}},arrayMap:{bracket:"(func, arr1, ...)",desc:{ru:"Вернуть массив, полученный из исходного применением функции func к каждому элементу массива arr.",en:"Returns an array obtained from the original application of the &#39;func&#39; function to each element in the &#39;arr&#39; array."}},now:{bracket:"(v)",desc:{ru:"Если значение истинно, то при выполнении INSERT из входных данных пропускаются (не рассматриваются) колонки с неизвестными именами, иначе в данной ситуации будет сгенерировано исключение. <br> Работает для форматов JSONEachRow и TSKV.",en:"If the parameter is true, INSERT operation will skip columns with unknown names from input. <br> Otherwise, an exception will be generated, it is default behavior. <br> The parameter works only for JSONEachRow and TSKV input formats."}},intDiv:{bracket:"(a, b)",desc:{ru:"Отличается от intDiv тем, что при делении на ноль или при делении минимального отрицательного числа на минус единицу, возвращается ноль.",en:"Differs from &#39;intDiv&#39; in that it returns zero when dividing by zero or when dividing a minimal negative number by minus one."}},topLevelDomain:{bracket:"(v)",desc:{ru:"Возвращает домен верхнего уровня. Пример: .ru.",en:"- Selects the top-level domain. Example: .ru."}},intHash32:{bracket:"(v)",desc:{ru:"Вычисляет 32-битный хэш-код от целого числа любого типа. <br> Это сравнительно быстрая некриптографическая хэш-функция среднего качества для чисел.",en:"Calculates a 32-bit hash code from any type of integer. <br> This is a relatively fast non-cryptographic hash function of average quality for numbers."}},replaceOne:{bracket:"(haystack, pattern, replacement)",desc:{ru:"Замена первого вхождения, если такое есть, подстроки pattern в haystack на подстроку replacement. <br> Здесь и далее, pattern и replacement должны быть константами.",en:"Replaces the first occurrence, if it exists, of the &#39;pattern&#39; substring in &#39;haystack&#39; with the &#39;replacement&#39; substring. <br> Hereafter, &#39;pattern&#39; and &#39;replacement&#39; must be constants."}},cityHash64:{bracket:"(v)",desc:{ru:"Вычисляет CityHash64 от строки или похожую хэш-функцию для произвольного количества аргументов произвольного типа. <br> Если аргумент имеет тип String, то используется CityHash. Это быстрая некриптографическая хэш-функция неплохого качества для строк. <br> Если аргумент имеет другой тип, то используется implementation specific быстрая некриптографическая хэш-функция неплохого качества. <br> Если передано несколько аргументов, то функция вычисляется по тем же правилам, с помощью комбинации по цепочке с использованием комбинатора из CityHash. <br> Например, так вы можете вычислить чексумму всей таблицы с точностью до порядка строк: %%SELECT sum(cityHash64(*)) FROM table%%.",en:"Calculates CityHash64 from a string or a similar hash function for any number of any type of arguments. <br> For String-type arguments, CityHash is used. This is a fast non-cryptographic hash function for strings with decent quality. <br> For other types of arguments, a decent implementation-specific fast non-cryptographic hash function is used. <br> If multiple arguments are passed, the function is calculated using the same rules and chain combinations using the CityHash combinator. <br> For example, you can compute the checksum of an entire table with accuracy up to the row order: %%SELECT sum(cityHash64(*)) FROM table%%."}},OSToRoot:{bracket:"(v)",desc:{ru:"Принимает число типа UInt8 - идентификатор операционной системы из словаря Яндекс.Метрики. Если переданному числу соответствует какая-либо операционная система - возвращает число типа UInt8 - идентификатор соответствующей корневой операционной системы (например, переводит Windows Vista в Windows). Иначе возвращает 0.",en:"Accepts a UInt8 number - the ID of the operating system from the Yandex.Metrica dictionary. If any OS matches the passed number, it returns a UInt8 number - the ID of the corresponding root OS (for example, it converts Windows Vista to Windows). Otherwise, returns 0."}},sipHash128:{bracket:"(v)",desc:{ru:"Вычисляет SipHash от строки. <br> Принимает аргумент типа String. Возвращает FixedString(16). <br> Отличается от sipHash64 тем, что финальный xor-folding состояния делается только до 128 бит.",en:"Calculates SipHash from a string. <br> Accepts a String-type argument. Returns FixedString(16). <br> Differs from sipHash64 in that the final xor-folding state is only done up to 128 bits."}},SHA1:{bracket:"(v)",desc:{ru:"Вычисляет SHA-1, SHA-224, SHA-256 от строки и возвращает полученный набор байт в виде FixedString(20), FixedString(28), FixedString(32). <br> Функция работает достаточно медленно (SHA-1 - примерно 5 миллионов коротких строк в секунду на одном процессорном ядре, SHA-224 и SHA-256 - примерно 2.2 миллионов). <br> Рекомендуется использовать эти функции лишь в тех случаях, когда вам нужна конкретная хэш-функция и вы не можете её выбрать. <br> Даже в этих случаях, рекомендуется применять функцию оффлайн - заранее вычисляя значения при вставке в таблицу, вместо того, чтобы применять её при SELECT-ах.",en:"Calculates SHA-1, SHA-224, or SHA-256 from a string and returns the resulting set of bytes as FixedString(20), FixedString(28), or FixedString(32). <br> The function works fairly slowly (SHA-1 processes about 5 million short strings per second per processor core, while SHA-224 and SHA-256 process about 2.2 million). <br> We recommend using this function only in cases when you need a specific hash function and you can&#39;t select it. <br> Even in these cases, we recommend applying the function offline and pre-calculating values when inserting them into the table, instead of applying it in SELECTS."}},asin:{bracket:"(x)",desc:{ru:"Арксинус.",en:"The arc sine."}},SHA256:{bracket:"(v)",desc:{ru:"Вычисляет SHA-1, SHA-224, SHA-256 от строки и возвращает полученный набор байт в виде FixedString(20), FixedString(28), FixedString(32). <br> Функция работает достаточно медленно (SHA-1 - примерно 5 миллионов коротких строк в секунду на одном процессорном ядре, SHA-224 и SHA-256 - примерно 2.2 миллионов). <br> Рекомендуется использовать эти функции лишь в тех случаях, когда вам нужна конкретная хэш-функция и вы не можете её выбрать. <br> Даже в этих случаях, рекомендуется применять функцию оффлайн - заранее вычисляя значения при вставке в таблицу, вместо того, чтобы применять её при SELECT-ах.",en:"Calculates SHA-1, SHA-224, or SHA-256 from a string and returns the resulting set of bytes as FixedString(20), FixedString(28), or FixedString(32). <br> The function works fairly slowly (SHA-1 processes about 5 million short strings per second per processor core, while SHA-224 and SHA-256 process about 2.2 million). <br> We recommend using this function only in cases when you need a specific hash function and you can&#39;t select it. <br> Even in these cases, we recommend applying the function offline and pre-calculating values when inserting them into the table, instead of applying it in SELECTS."}},MD5:{bracket:"(v)",desc:{ru:"Вычисляет MD5 от строки и возвращает полученный набор байт в виде FixedString(16). <br> Если вам не нужен конкретно MD5, а нужен неплохой криптографический 128-битный хэш, то используйте вместо этого функцию sipHash128. <br> Если вы хотите получить такой же результат, как выдаёт утилита md5sum, напишите %%lower(hex(MD5(s)))%%.",en:"Calculates the MD5 from a string and returns the resulting set of bytes as FixedString(16). <br> If you don&#39;t need MD5 in particular, but you need a decent cryptographic 128-bit hash, use the &#39;sipHash128&#39; function instead. <br> If you need the same result as gives 'md5sum' utility, write %%lower(hex(MD5(s)))%%."}},bitmaskToList:{bracket:"(num)",desc:{ru:"Принимает целое число. Возвращает строку, содержащую список степеней двойки, в сумме дающих исходное число; по возрастанию, в текстовом виде, через запятую, без пробелов.",en:"Accepts an integer. Returns a string containing the list of powers of two that total the source number when summed. They are comma-separated without spaces in text format, in ascending order."}},array:{bracket:"(v)",desc:{ru:"К имени любой агрегатной функции может быть приписан суффикс -%%Array%%. В этом случае, агрегатная функция вместо аргументов типов T принимает аргументы типов Array(T) (массивы). Если агрегатная функция принимает несколько аргументов, то это должны быть массивы одинаковых длин. При обработке массивов, агрегатная функция работает, как исходная агрегатная функция по всем элементам массивов. <br>  <br> Пример 1: %%sumArray(arr)%% - просуммировать все элементы всех массивов arr. В данном примере можно было бы написать проще: %%sum(arraySum(arr))%%. <br> Пример 2: %%uniqArray(arr)%% - посчитать количество уникальных элементов всех массивов arr. Это можно было бы сделать проще: %%uniq(arrayJoin(arr))%%, но не всегда есть возможность добавить arrayJoin в запрос. <br>  <br> Комбинаторы -%%If%% и -%%Array%% можно сочетать. При этом, должен сначала идти Array, а потом If. Примеры: %%uniqArrayIf(arr, cond)%%,  %%quantilesTimingArrayIf(level1, level2)(arr, cond)%%. Из-за такого порядка получается, что аргумент cond не должен быть массивом.",en:"The -%%Array%% suffix can be appended to any aggregate function. In this case, the aggregate function takes arguments of the &#39;Array(T)&#39; type (arrays) instead of &#39;T&#39; type arguments. If the aggregate function accepts multiple arguments, this must be arrays of equal lengths. When processing arrays, the aggregate function works like the original aggregate function across all array elements. <br>  <br> Example 1: %%sumArray(arr)%% - Totals all the elements of all &#39;arr&#39; arrays. In this example, it could have been written more simply: %%sum(arraySum(arr))%%. <br> Example 2: %%uniqArray(arr)%% - Count the number of unique elements in all &#39;arr&#39; arrays. This could be done an easier way: %%uniq(arrayJoin(arr))%%, but it&#39;s not always possible to add &#39;arrayJoin&#39; to a query. <br>  <br> The -%%If%% and -%%Array%% combinators can be used together. However, &#39;Array&#39; must come first, then &#39;If&#39;. Examples: %%uniqArrayIf(arr, cond)%%,  %%quantilesTimingArrayIf(level1, level2)(arr, cond)%%. Due to this order, the &#39;cond&#39; argument can&#39;t be an array."}},dictGetStringOrDefault:{bracket:"(v)",desc:{ru:"%%dictGet<i>T</i>('dict_name', 'attr_name', id, default)%% <br> Аналогично функциям dictGet<i>T</i>, но значение по умолчанию берётся из последнего аргумента функции.",en:""}},greaterOrEquals:{bracket:"(v)",desc:{ru:"",en:""}},e:{bracket:"(v)",desc:{ru:"Что делать, когда количество данных превысило одно из ограничений: throw или break. По умолчанию: throw.",en:"What to do when the amount of data exceeds one of the limits: &#39;throw&#39; or &#39;break&#39;. By default, throw."}},runningDifference:{bracket:"(x)",desc:{ru:"Считает разницу между последовательными значениями строк в блоке данных. <br> Возвращает 0 для первой строки и разницу с предыдущей строкой для каждой последующей строки. <br>  <br> Результат функции зависит от затронутых блоков данных и порядка данных в блоке. <br> Если сделать подзапрос с ORDER BY и вызывать функцию извне подзапроса, можно будет получить ожидаемый результат. <br>  <br> Пример: <br> %% <br> SELECT <br>     EventID, <br>     EventTime, <br>     runningDifference(EventTime) AS delta <br> FROM <br> ( <br>     SELECT <br>         EventID, <br>         EventTime <br>     FROM events <br>     WHERE EventDate = '2016-11-24' <br>     ORDER BY EventTime ASC <br>     LIMIT 5 <br> ) <br>  <br> ┌─EventID─┬───────────EventTime─┬─delta─┐ <br> │    1106 │ 2016-11-24 00:00:04 │     0 │ <br> │    1107 │ 2016-11-24 00:00:05 │     1 │ <br> │    1108 │ 2016-11-24 00:00:05 │     0 │ <br> │    1109 │ 2016-11-24 00:00:09 │     4 │ <br> │    1110 │ 2016-11-24 00:00:10 │     1 │ <br> └─────────┴─────────────────────┴───────┘ <br> %%",en:"Calculates the difference between consecutive values in the data block. <br> Result of the function depends on the order of the data in the blocks. <br>  <br> It works only inside of the each processed block of data. Data splitting in the blocks is not explicitly controlled by the user. <br> If you specify ORDER BY in subquery and call runningDifference outside of it, you could get an expected result. <br>  <br> Example: <br> %% <br> SELECT <br>     EventID, <br>     EventTime, <br>     runningDifference(EventTime) AS delta <br> FROM <br> ( <br>     SELECT <br>         EventID, <br>         EventTime <br>     FROM events <br>     WHERE EventDate = '2016-11-24' <br>     ORDER BY EventTime ASC <br>     LIMIT 5 <br> ) <br>  <br> ┌─EventID─┬───────────EventTime─┬─delta─┐ <br> │    1106 │ 2016-11-24 00:00:04 │     0 │ <br> │    1107 │ 2016-11-24 00:00:05 │     1 │ <br> │    1108 │ 2016-11-24 00:00:05 │     0 │ <br> │    1109 │ 2016-11-24 00:00:09 │     4 │ <br> │    1110 │ 2016-11-24 00:00:10 │     1 │ <br> └─────────┴─────────────────────┴───────┘ <br> %%"
}},not:{bracket:"(v)",desc:{ru:'Смотрите раздел "Операторы IN".',en:"See the section &quot;IN operators&quot;."}},intHash64:{bracket:"(v)",desc:{ru:"Вычисляет 64-битный хэш-код от целого числа любого типа. <br> Работает быстрее, чем intHash32. Качество среднее.",en:"Calculates a 64-bit hash code from any type of integer. <br> It works faster than intHash32. Average quality."}},acos:{bracket:"(x)",desc:{ru:"Арккосинус.",en:"The arc cosine."}},dictGetString:{bracket:"(v)",desc:{ru:"%%dictGet<i>T</i>('dict_name', 'attr_name', id, default)%% <br> Аналогично функциям dictGet<i>T</i>, но значение по умолчанию берётся из последнего аргумента функции.",en:'<span class="inline-example">dictGet<i>T</i>(&#39;dict_name&#39;, &#39;attr_name&#39;, id)</span> <br> - Gets the value of the &#39;attr_name&#39; attribute from the &#39;dict_name&#39; dictionary by the &#39;id&#39; key. <br> &#39;dict_name&#39; and &#39;attr_name&#39; are constant strings. <br> &#39;id&#39; must be UInt64. <br> If the &#39;id&#39; key is not in the dictionary, it returns the default value set in the dictionary definition.'}},and:{bracket:"(x, determinator)",desc:{ru:"Возвращает псевдослучайное число типа UInt64, равномерно распределённое среди всех чисел типа UInt64. <br> Используется linear congruential generator.",en:"This function works similarly to the &#39;median&#39; function - it approximates the median. However, in contrast to &#39;median&#39;, the result is deterministic and does not depend on the order of query execution. <br>  <br> To achieve this, the function takes a second argument - the &quot;determinator&quot;. This is a number whose hash is used instead of a random number generator in the reservoir sampling algorithm. For the function to work correctly, the same determinator value should not occur too often. For the determinator, you can use an event ID, user ID, and so on. <br>  <br> Don&#39;t use this function for calculating timings. The &#39;medianTiming&#39;, &#39;quantileTiming&#39;, and &#39;quantilesTiming&#39; functions are better suited to this purpose."}},dictGetDate:{bracket:"(v)",desc:{ru:"%%dictGet<i>T</i>('dict_name', 'attr_name', id)%% <br> - получить из словаря dict_name значение атрибута attr_name по ключу id. <br> dict_name и attr_name - константные строки. <br> id должен иметь тип UInt64. <br> Если ключа id нет в словаре - вернуть значение по умолчанию, заданное в описании словаря.",en:'<span class="inline-example">dictGet<i>T</i>(&#39;dict_name&#39;, &#39;attr_name&#39;, id)</span> <br> - Gets the value of the &#39;attr_name&#39; attribute from the &#39;dict_name&#39; dictionary by the &#39;id&#39; key. <br> &#39;dict_name&#39; and &#39;attr_name&#39; are constant strings. <br> &#39;id&#39; must be UInt64. <br> If the &#39;id&#39; key is not in the dictionary, it returns the default value set in the dictionary definition.'}},dictGetFloat32:{bracket:"(v)",desc:{ru:"%%dictGet<i>T</i>('dict_name', 'attr_name', id)%% <br> - получить из словаря dict_name значение атрибута attr_name по ключу id. <br> dict_name и attr_name - константные строки. <br> id должен иметь тип UInt64. <br> Если ключа id нет в словаре - вернуть значение по умолчанию, заданное в описании словаря.",en:'<span class="inline-example">dictGet<i>T</i>(&#39;dict_name&#39;, &#39;attr_name&#39;, id)</span> <br> - Gets the value of the &#39;attr_name&#39; attribute from the &#39;dict_name&#39; dictionary by the &#39;id&#39; key. <br> &#39;dict_name&#39; and &#39;attr_name&#39; are constant strings. <br> &#39;id&#39; must be UInt64. <br> If the &#39;id&#39; key is not in the dictionary, it returns the default value set in the dictionary definition.'}},dictGetInt8:{bracket:"(v)",desc:{ru:"%%dictGet<i>T</i>('dict_name', 'attr_name', id)%% <br> - получить из словаря dict_name значение атрибута attr_name по ключу id. <br> dict_name и attr_name - константные строки. <br> id должен иметь тип UInt64. <br> Если ключа id нет в словаре - вернуть значение по умолчанию, заданное в описании словаря.",en:'<span class="inline-example">dictGet<i>T</i>(&#39;dict_name&#39;, &#39;attr_name&#39;, id)</span> <br> - Gets the value of the &#39;attr_name&#39; attribute from the &#39;dict_name&#39; dictionary by the &#39;id&#39; key. <br> &#39;dict_name&#39; and &#39;attr_name&#39; are constant strings. <br> &#39;id&#39; must be UInt64. <br> If the &#39;id&#39; key is not in the dictionary, it returns the default value set in the dictionary definition.'}},dictGetUInt32:{bracket:"(v)",desc:{ru:"%%dictGet<i>T</i>('dict_name', 'attr_name', id)%% <br> - получить из словаря dict_name значение атрибута attr_name по ключу id. <br> dict_name и attr_name - константные строки. <br> id должен иметь тип UInt64. <br> Если ключа id нет в словаре - вернуть значение по умолчанию, заданное в описании словаря.",en:'<span class="inline-example">dictGet<i>T</i>(&#39;dict_name&#39;, &#39;attr_name&#39;, id)</span> <br> - Gets the value of the &#39;attr_name&#39; attribute from the &#39;dict_name&#39; dictionary by the &#39;id&#39; key. <br> &#39;dict_name&#39; and &#39;attr_name&#39; are constant strings. <br> &#39;id&#39; must be UInt64. <br> If the &#39;id&#39; key is not in the dictionary, it returns the default value set in the dictionary definition.'}},OSIn:{bracket:"(lhs, rhs)",desc:{ru:"Проверяет принадлежность операционной системы lhs операционной системе rhs.",en:"Checks whether the &#39;lhs&#39; operating system belongs to the &#39;rhs&#39; operating system."}},arrayFirstIndex:{bracket:"(func, arr1, ...)",desc:{ru:"Вернуть индекс первого элемента массива arr1, для которого функция func возвращает не 0.",en:"Returns the index of the first element in the &#39;arr1&#39; array for which &#39;func&#39; returns something other than 0."}},ceil:{bracket:"(x[, N])",desc:{ru:"Возвращает наименьшее круглое число, которое больше или равно, чем x. <br> В остальном, аналогично функции floor, см. выше.",en:"Returns the smallest round number that is greater than or equal to &#39;x&#39;. In every other way, it is the same as the &#39;floor&#39; function (see above)."}},fragment:{bracket:"(v)",desc:{ru:"Удаляет query string и fragment identifier. Знак вопроса и символ решётки тоже удаляются.",en:"Removes the query-string and fragment identifier. The question mark and number sign are also removed."}},dictGetUInt8:{bracket:"(v)",desc:{ru:"%%dictGet<i>T</i>('dict_name', 'attr_name', id)%% <br> - получить из словаря dict_name значение атрибута attr_name по ключу id. <br> dict_name и attr_name - константные строки. <br> id должен иметь тип UInt64. <br> Если ключа id нет в словаре - вернуть значение по умолчанию, заданное в описании словаря.",en:'<span class="inline-example">dictGet<i>T</i>(&#39;dict_name&#39;, &#39;attr_name&#39;, id)</span> <br> - Gets the value of the &#39;attr_name&#39; attribute from the &#39;dict_name&#39; dictionary by the &#39;id&#39; key. <br> &#39;dict_name&#39; and &#39;attr_name&#39; are constant strings. <br> &#39;id&#39; must be UInt64. <br> If the &#39;id&#39; key is not in the dictionary, it returns the default value set in the dictionary definition.'}},dictHas:{bracket:"(v)",desc:{ru:"%%dictHas('dict_name', id)%% <br> - проверить наличие ключа в словаре. Возвращает значение типа UInt8, равное 0, если ключа нет и 1, если ключ есть.",en:""}},arraySum:{bracket:"([func,] arr1, ...)",desc:{ru:"Вернуть сумму значений функции func. Если функция не указана - просто вернуть сумму элементов массива.",en:"Returns the sum of the &#39;func&#39; values. If the function is omitted, it just returns the sum of the array elements."}},emptyArrayDateTime:{bracket:"(v)",desc:{ru:"Принимает ноль аргументов и возвращает пустой массив соответствующего типа.",en:"Accepts zero arguments and returns an empty array of the appropriate type."}},intDivOrZero:{bracket:"(a, b)",desc:{ru:"Отличается от intDiv тем, что при делении на ноль или при делении минимального отрицательного числа на минус единицу, возвращается ноль.",en:"Differs from &#39;intDiv&#39; in that it returns zero when dividing by zero or when dividing a minimal negative number by minus one."}},SEHierarchy:{bracket:"(v)",desc:{ru:"Принимает число типа UInt8 - идентификатор поисковой системы из словаря Яндекс.Метрики. Возвращает массив с иерархией поисковых систем. Аналогично функции regionHierarchy.",en:"Accepts a UInt8 number - the ID of the search engine from the Yandex.Metrica dictionary. Returns an array with a hierarchy of search engines. Similar to the &#39;regionHierarchy&#39; function."}},regionToContinent:{bracket:"(id[, geobase])",desc:{ru:"Переводит регион в континент. В остальном, аналогично функции regionToCity. <br> Пример: %%regionToContinent(toUInt32(213)) = 10001%% - преобразовали Москву (213) в Евразию (10001).",en:"Converts a region to a continent. In every other way, this function is the same as &#39;regionToCity&#39;. <br> Example: %%regionToContinent(toUInt32(213)) = 10001%% converts Moscow (213) to Eurasia (10001)."}},dictGetInt32:{bracket:"(v)",desc:{ru:"%%dictGet<i>T</i>('dict_name', 'attr_name', id)%% <br> - получить из словаря dict_name значение атрибута attr_name по ключу id. <br> dict_name и attr_name - константные строки. <br> id должен иметь тип UInt64. <br> Если ключа id нет в словаре - вернуть значение по умолчанию, заданное в описании словаря.",en:'<span class="inline-example">dictGet<i>T</i>(&#39;dict_name&#39;, &#39;attr_name&#39;, id)</span> <br> - Gets the value of the &#39;attr_name&#39; attribute from the &#39;dict_name&#39; dictionary by the &#39;id&#39; key. <br> &#39;dict_name&#39; and &#39;attr_name&#39; are constant strings. <br> &#39;id&#39; must be UInt64. <br> If the &#39;id&#39; key is not in the dictionary, it returns the default value set in the dictionary definition.'}},toInt8:{bracket:"(v)",desc:{ru:"Функции преобразования между числами, строками (но не фиксированными строками), датами и датами-с-временем. <br> Все эти функции принимают один аргумент. <br>  <br> При преобразовании в строку или из строки, производится форматирование или парсинг значения по тем же правилам, что и для формата TabSeparated (и почти всех остальных текстовых форматов). Если распарсить строку не удаётся - кидается исключение и выполнение запроса прерывается. <br>  <br> При преобразовании даты в число или наоборот, дате соответствует число дней от начала unix эпохи. <br> При преобразовании даты-с-временем в число или наоборот, дате-с-временем соответствует число секунд от начала unix эпохи. <br>  <br> Форматы даты и даты-с-временем для функций toDate/toDateTime определены следующим образом: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> В качестве исключения, если делается преобразование из числа типа UInt32, Int32, UInt64, Int64 в Date, и если число больше или равно 65536, то число рассматривается как unix timestamp (а не как число дней) и округляется до даты. Это позволяет поддержать распространённый случай, когда пишут toDate(unix_timestamp), что иначе было бы ошибкой и требовало бы написания более громоздкого toDate(toDateTime(unix_timestamp)) <br>  <br> Преобразование между датой и датой-с-временем производится естественным образом: добавлением нулевого времени или отбрасыванием времени. <br>  <br> Преобразование между чи",en:"Functions for converting between numbers, strings (but not fixed strings), dates, and dates with times. All these functions accept one argument. <br>  <br> When converting to or from a string, the value is formatted or parsed using the same rules as for the TabSeparated format (and almost all other text formats). If the string can&#39;t be parsed, an exception is thrown and the request is canceled. <br>  <br> When converting dates to numbers or vice versa, the date corresponds to the number of days since the beginning of the Unix epoch. <br> When converting dates with times to numbers or vice versa, the date with time corresponds to the number of seconds since the beginning of the Unix epoch. <br>  <br> Formats of date and date with time for toDate/toDateTime functions are defined as follows: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> As an exception, if converting from UInt32, Int32, UInt64, or Int64 type numbers to Date, and if the number is greater than or equal to 65536, the number is interpreted as a Unix timestamp (and not as the number of days) and is rounded to the date. This allows support for the common occurrence of writing &#39;toDate(unix_timestamp)&#39;, which otherwise would be an error and would require writing the more cumbersome &#39;toDate(toDateTime(unix_timestamp))&#39;. <br>  <br> Conversion between a date and date with time is performed the natural way: by adding a null time or d"}},materialize:{bracket:"(x)",desc:{ru:"Превращает константу в полноценный столбец, содержащий только одно значение. <br> В ClickHouse полноценные столбцы и константы представлены в памяти по-разному. Функции по-разному работают для аргументов-констант и обычных аргументов (выполняется разный код), хотя результат почти всегда должен быть одинаковым. Эта функция предназначена для отладки такого поведения.",en:"Turns a constant into a full column containing just one value. <br> In ClickHouse, full columns and constants are represented differently in memory. Functions work differently for constant arguments and normal arguments (different code is executed), although the result is almost always the same. This function is for debugging this behavior."}},regionToCountry:{bracket:"(id[, geobase])",desc:{ru:"Переводит регион в страну. В остальном, аналогично функции regionToCity. <br> Пример: %%regionToCountry(toUInt32(213)) = 225%% - преобразовали Москву (213) в Россию (225).",en:"Converts a region to a country. In every other way, this function is the same as &#39;regionToCity&#39;. <br> Example: %%regionToCountry(toUInt32(213)) = 225%% converts Moscow (213) to Russia (225)."}},dictGetDateTime:{bracket:"(v)",desc:{ru:"%%dictGet<i>T</i>('dict_name', 'attr_name', id)%% <br> - получить из словаря dict_name значение атрибута attr_name по ключу id. <br> dict_name и attr_name - константные строки. <br> id должен иметь тип UInt64. <br> Если ключа id нет в словаре - вернуть значение по умолчанию, заданное в описании словаря.",en:'<span class="inline-example">dictGet<i>T</i>(&#39;dict_name&#39;, &#39;attr_name&#39;, id)</span> <br> - Gets the value of the &#39;attr_name&#39; attribute from the &#39;dict_name&#39; dictionary by the &#39;id&#39; key. <br> &#39;dict_name&#39; and &#39;attr_name&#39; are constant strings. <br> &#39;id&#39; must be UInt64. <br> If the &#39;id&#39; key is not in the dictionary, it returns the default value set in the dictionary definition.'}},xor:{bracket:"(v)",desc:{ru:"",en:""}},regionToCity:{bracket:"(id[, geobase])",desc:{ru:"Принимает число типа UInt32 - идентификатор региона из геобазы Яндекса. Если регион является городом или входит в некоторый город, то возвращает идентификатор региона - соответствующего города. Иначе возвращает 0.",en:"Accepts a UInt32 number - the region ID from the Yandex geobase. If this region is a city or part of a city, it returns the region ID for the appropriate city. Otherwise, returns 0."}},dictGetFloat64:{bracket:"(v)",desc:{ru:"%%dictGet<i>T</i>('dict_name', 'attr_name', id)%% <br> - получить из словаря dict_name значение атрибута attr_name по ключу id. <br> dict_name и attr_name - константные строки. <br> id должен иметь тип UInt64. <br> Если ключа id нет в словаре - вернуть значение по умолчанию, заданное в описании словаря.",en:'<span class="inline-example">dictGet<i>T</i>(&#39;dict_name&#39;, &#39;attr_name&#39;, id)</span> <br> - Gets the value of the &#39;attr_name&#39; attribute from the &#39;dict_name&#39; dictionary by the &#39;id&#39; key. <br> &#39;dict_name&#39; and &#39;attr_name&#39; are constant strings. <br> &#39;id&#39; must be UInt64. <br> If the &#39;id&#39; key is not in the dictionary, it returns the default value set in the dictionary definition.'}},timeSlot:{bracket:"(StartTime, Duration)",desc:{ru:"Для интервала времени, начинающегося в StartTime и продолжающегося Duration секунд, возвращает массив моментов времени, состоящий из округлений вниз до получаса точек из этого интервала. <br> Например, %%timeSlots(toDateTime('2012-01-01 12:20:00'), toUInt32(600)) = [toDateTime('2012-01-01 12:00:00'), toDateTime('2012-01-01 12:30:00')]%%. <br> Это нужно для поиска хитов, входящих в соответствующий визит.",en:"For a time interval starting at &#39;StartTime&#39; and continuing for &#39;Duration&#39; seconds, it returns an array of moments in time, consisting of points from this interval rounded down to the half hour. <br> For example, %%timeSlots(toDateTime(&#39;2012-01-01 12:20:00&#39;), toUInt32(600)) = [toDateTime(&#39;2012-01-01 12:00:00&#39;), toDateTime(&#39;2012-01-01 12:30:00&#39;)]%%. <br> This is necessary for searching for pageviews in the corresponding session."}},toTime:{bracket:"(v)",desc:{ru:"Переводит дату-с-временем на дату начала unix-эпохи, сохраняя при этом время.",en:"Converts a date with time to the date of the start of the Unix Epoch, while preserving the time."}},log2:{bracket:"(x)",desc:{ru:"Принимает числовой аргумент, возвращает число типа Float64, близкое к двоичному логарифму от аргумента.",en:"Accepts a numeric argument and returns a Float64 number close to the binary logarithm of the argument."}},toRelativeHourNum:{bracket:"(v)",desc:{ru:"Переводит дату-с-временем в номер часа, начиная с некоторого фиксированного момента в прошлом.",en:"Converts a date with time or date to the number of the hour, starting from a certain fixed point in the past."}},toRelativeDayNum:{bracket:"(v)",desc:{ru:"Переводит дату-с-временем или дату в номер дня, начиная с некоторого фиксированного момента в прошлом.",en:"Converts a date with time or date to the number of the day, starting from a certain fixed point in the past."}},toRelativeWeekNum:{bracket:"(v)",desc:{ru:"Переводит дату-с-временем или дату в номер недели, начиная с некоторого фиксированного момента в прошлом.",en:"Converts a date with time or date to the number of the week, starting from a certain fixed point in the past."}},splitByString:{bracket:"(separator, s)",desc:{ru:"То же самое, но использует строку из нескольких символов в качестве разделителя. Строка должна быть непустой.",en:"The same as above, but it uses a string of multiple characters as the separator. The string must be non-empty."}},currentDatabase:{bracket:"()",desc:{ru:"Возвращает имя текущей базы данных. <br> Эта функция может использоваться в параметрах движка таблицы в запросе CREATE TABLE там, где нужно указать базу данных.",en:"Returns the name of the current database. <br> You can use this function in table engine parameters in a CREATE TABLE query where you need to specify the database."}},toRelativeMonthNum:{bracket:"(v)",desc:{ru:"Переводит дату-с-временем или дату в номер месяца, начиная с некоторого фиксированного момента в прошлом.",en:"Converts a date with time or date to the number of the month, starting from a certain fixed point in the past."}},visibleWidth:{bracket:"(x)",desc:{ru:"Вычисляет приблизительную ширину при выводе значения в текстовом (tab-separated) виде на консоль. <br> Функция используется системой для реализации Pretty форматов.",en:"Calculates the approximate width when outputting values to the console in text format (tab-separated). This function is used by the system for implementing Pretty formats."}},bitShiftRight:{bracket:"(a, b)",desc:{ru:"",en:""}},toRelativeYearNum:{bracket:"(v)",desc:{ru:"Переводит дату-с-временем или дату в номер года, начиная с некоторого фиксированного момента в прошлом.",en:"Converts a date with time or date to the number of the year, starting from a certain fixed point in the past."}},toStartOfHour:{bracket:"(v)",desc:{ru:"Округляет дату-с-временем вниз до начала часа.",en:"Rounds down a date with time to the start of the hour."}},halfMD5:{bracket:"(v)",desc:{ru:"Вычисляет MD5 от строки. Затем берёт первые 8 байт от хэша и интерпретирует их как UInt64 в big endian. <br> Принимает аргумент типа String. Возвращает UInt64. <br> Функция работает достаточно медленно (5 миллионов коротких строк в секунду на одном процессорном ядре). <br> Если вам не нужен конкретно MD5, то используйте вместо этого функцию sipHash64.",en:"Calculates the MD5 from a string. Then it takes the first 8 bytes of the hash and interprets them as UInt64 in big endian. <br> Accepts a String-type argument. Returns UInt64. <br> This function works fairly slowly (5 million short strings per second per processor core). <br> If you don&#39;t need MD5 in particular, use the &#39;sipHash64&#39; function instead."}},toStartOfFiveMinute:{bracket:"(v)",desc:{ru:"Округляет дату-с-временем вниз до начала пятиминутного интервала. <br>  <br> Замечание: если вам нужно округлить дату-с-временем до какого-либо другого количества секунд, минут или часов, вы можете перевести её в число с помощью функции %%toUInt32%%, затем округлить число с помощью функции %%intDiv%% и умножения, а затем перевести обратно, с помощью функции %%toDateTime%%.",en:""}},toUInt16OrZero:{bracket:"(v)",desc:{ru:"Функции преобразования между числами, строками (но не фиксированными строками), датами и датами-с-временем. <br> Все эти функции принимают один аргумент. <br>  <br> При преобразовании в строку или из строки, производится форматирование или парсинг значения по тем же правилам, что и для формата TabSeparated (и почти всех остальных текстовых форматов). Если распарсить строку не удаётся - кидается исключение и выполнение запроса прерывается. <br>  <br> При преобразовании даты в число или наоборот, дате соответствует число дней от начала unix эпохи. <br> При преобразовании даты-с-временем в число или наоборот, дате-с-временем соответствует число секунд от начала unix эпохи. <br>  <br> Форматы даты и даты-с-временем для функций toDate/toDateTime определены следующим образом: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> В качестве исключения, если делается преобразование из числа типа UInt32, Int32, UInt64, Int64 в Date, и если число больше или равно 65536, то число рассматривается как unix timestamp (а не как число дней) и округляется до даты. Это позволяет поддержать распространённый случай, когда пишут toDate(unix_timestamp), что иначе было бы ошибкой и требовало бы написания более громоздкого toDate(toDateTime(unix_timestamp)) <br>  <br> Преобразование между датой и датой-с-временем производится естественным образом: добавлением нулевого времени или отбрасыванием времени. <br>  <br> Преобразование между чи",en:"Functions for converting between numbers, strings (but not fixed strings), dates, and dates with times. All these functions accept one argument. <br>  <br> When converting to or from a string, the value is formatted or parsed using the same rules as for the TabSeparated format (and almost all other text formats). If the string can&#39;t be parsed, an exception is thrown and the request is canceled. <br>  <br> When converting dates to numbers or vice versa, the date corresponds to the number of days since the beginning of the Unix epoch. <br> When converting dates with times to numbers or vice versa, the date with time corresponds to the number of seconds since the beginning of the Unix epoch. <br>  <br> Formats of date and date with time for toDate/toDateTime functions are defined as follows: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> As an exception, if converting from UInt32, Int32, UInt64, or Int64 type numbers to Date, and if the number is greater than or equal to 65536, the number is interpreted as a Unix timestamp (and not as the number of days) and is rounded to the date. This allows support for the common occurrence of writing &#39;toDate(unix_timestamp)&#39;, which otherwise would be an error and would require writing the more cumbersome &#39;toDate(toDateTime(unix_timestamp))&#39;. <br>  <br> Conversion between a date and date with time is performed the natural way: by adding a null time or d"}},toMonday:{bracket:"(v)",desc:{ru:"Округляет дату или дату-с-временем вниз до ближайшего понедельника. <br> Возвращается дата.",en:"Rounds down a date or date with time to the nearest Monday. <br> Returns the date."}},IPv6NumToString:{bracket:"(x)",desc:{ru:"Принимает значение типа FixedString(16), содержащее IPv6-адрес в бинарном виде. Возвращает строку, содержащую этот адрес в текстовом виде. <br> IPv6-mapped IPv4 адреса выводится в формате %%::ffff:111.222.33.44%%. Примеры: <br>  <br> %% <br> SELECT IPv6NumToString(toFixedString(unhex('2A0206B8000000000000000000000011'), 16)) AS addr <br>  <br> ┌─addr─────────┐ <br> │ 2a02:6b8::11 │ <br> └──────────────┘ <br> %% <br>  <br> %% <br> SELECT <br>     IPv6NumToString(ClientIP6 AS k), <br>     count() AS c <br> FROM hits_all <br> WHERE EventDate = today() AND substring(ClientIP6, 1, 12) != unhex('00000000000000000000FFFF') <br> GROUP BY k <br> ORDER BY c DESC <br> LIMIT 10 <br>  <br> ┌─IPv6NumToString(ClientIP6)──────────────┬─────c─┐ <br> │ 2a02:2168:aaa:bbbb::2                   │ 24695 │ <br> │ 2a02:2698:abcd:abcd:abcd:abcd:8888:5555 │ 22408 │ <br> │ 2a02:6b8:0:fff::ff                      │ 16389 │ <br> │ 2a01:4f8:111:6666::2                    │ 16016 │ <br> │ 2a02:2168:888:222::1                    │ 15896 │ <br> │ 2a01:7e00::ffff:ffff:ffff:222           │ 14774 │ <br> │ 2a02:8109:eee:ee:eeee:eeee:eeee:eeee    │ 14443 │ <br> │ 2a02:810b:8888:888:8888:8888:8888:8888  │ 14345 │ <br> │ 2a02:6b8:0:444:4444:4444:4444:4444      │ 14279 │ <br> │ 2a01:7e00::ffff:ffff:ffff:ffff          │ 13880 │ <br> └─────────────────────────────────────────┴───────┘ <br> %% <br>  <br> %% <br> SELECT <br>     IPv6NumToString(ClientIP6 AS k), <br>     ",en:"Accepts a FixedString(16) value containing the IPv6 address in binary format. Returns a string containing this address in text format. <br> IPv6-mapped IPv4 addresses are output in the format %%::ffff:111.222.33.44%%. Examples: <br>  <br> %% <br> SELECT IPv6NumToString(toFixedString(unhex(&#39;2A0206B8000000000000000000000011&#39;), 16)) AS addr <br>  <br> ┌─addr─────────┐ <br> │ 2a02:6b8::11 │ <br> └──────────────┘ <br> %% <br>  <br> %% <br> SELECT <br>     IPv6NumToString(ClientIP6 AS k), <br>     count() AS c <br> FROM hits_all <br> WHERE EventDate = today() AND substring(ClientIP6, 1, 12) != unhex(&#39;00000000000000000000FFFF&#39;) <br> GROUP BY k <br> ORDER BY c DESC <br> LIMIT 10 <br>  <br> ┌─IPv6NumToString(ClientIP6)──────────────┬─────c─┐ <br> │ 2a02:2168:aaa:bbbb::2                   │ 24695 │ <br> │ 2a02:2698:abcd:abcd:abcd:abcd:8888:5555 │ 22408 │ <br> │ 2a02:6b8:0:fff::ff                      │ 16389 │ <br> │ 2a01:4f8:111:6666::2                    │ 16016 │ <br> │ 2a02:2168:888:222::1                    │ 15896 │ <br> │ 2a01:7e00::ffff:ffff:ffff:222           │ 14774 │ <br> │ 2a02:8109:eee:ee:eeee:eeee:eeee:eeee    │ 14443 │ <br> │ 2a02:810b:8888:888:8888:8888:8888:8888  │ 14345 │ <br> │ 2a02:6b8:0:444:4444:4444:4444:4444      │ 14279 │ <br> │ 2a01:7e00::ffff:ffff:ffff:ffff          │ 13880 │ <br> └─────────────────────────────────────────┴───────┘ <br> %% <br>  <br> %% <br> SELECT <br>     IPv6NumToString(Clien"}},indexOf:{bracket:"(arr, x)",desc:{ru:"Возвращает индекс элемента x (начиная с 1), если он есть в массиве, или 0, если его нет.",en:"Returns the index of the &#39;x&#39; element (starting from 1) if it is in the array, or 0 if it is not."}},today:{bracket:"(v)",desc:{ru:"Принимает ноль аргументов и возвращает текущую дату на один из моментов выполнения запроса. <br> То же самое, что toDate(now())",en:"Accepts zero arguments and returns the current date at one of the moments of request execution. <br> The same as &#39;toDate(now())&#39;."}},emptyArrayToSingle:{bracket:"(v)",desc:{ru:"Принимает пустой массив и возвращает массив из одного элемента, равного значению по умолчанию.",en:"Accepts an empty array as argument and returns an array of one element equal to the default value."}},sleep:{bracket:"(seconds)",desc:{ru:"Спит seconds секунд на каждый блок данных. Можно указать как целое число, так и число с плавающей запятой.",en:"Sleeps &#39;seconds&#39; seconds on each data block. You can specify an integer or a floating-point number."}},extract:{bracket:"(params, name)",desc:{ru:"Распарсить строку в двойных кавычках. У значения убирается экранирование. Если убрать экранированные символы не удалось, то возвращается пустая строка. Примеры: <br> %%visitParamExtractString('{\"abc\":\"\\\\n\\\\u0000\"}', 'abc') = '\\n\\0'%% <br> %%visitParamExtractString('{\"abc\":\"\\\\u263a\"}', 'abc') = '☺'%% <br> %%visitParamExtractString('{\"abc\":\"\\\\u263\"}', 'abc') = ''%% <br> %%visitParamExtractString('{\"abc\":\"hello}', 'abc') = ''%% <br> На данный момент, не поддерживаются записанные в формате \\uXXXX\\uYYYY кодовые точки не из basic multilingual plane (они переводятся не в UTF-8, а в CESU-8).",en:"Parses the string in double quotes. The value is unescaped. If unescaping failed, it returns an empty string. Examples: <br> %%visitParamExtractString(&#39;{&quot;abc&quot;:&quot;\\\\n\\\\u0000&quot;}&#39;, &#39;abc&#39;) = &#39;\\n\\0&#39;%% <br> %%visitParamExtractString(&#39;{&quot;abc&quot;:&quot;\\\\u263a&quot;}&#39;, &#39;abc&#39;) = &#39;☺&#39;%% <br> %%visitParamExtractString(&#39;{&quot;abc&quot;:&quot;\\\\u263&quot;}&#39;, &#39;abc&#39;) = &#39;&#39;%% <br> %%visitParamExtractString(&#39;{&quot;abc&quot;:&quot;hello}&#39;, &#39;abc&#39;) = &#39;&#39;%% <br> Currently, there is no support for code points not from the basic multilingual plane written in the format \\uXXXX\\uYYYY (they are converted to CESU-8 instead of UTF-8)."}},emptyArrayInt8:{bracket:"(v)",desc:{ru:"Принимает ноль аргументов и возвращает пустой массив соответствующего типа.",en:"Accepts zero arguments and returns an empty array of the appropriate type."}},regionToName:{bracket:"(id[, lang])",desc:{ru:"Принимает число типа UInt32 - идентификатор региона из геобазы Яндекса. Вторым аргументом может быть передана строка - название языка. Поддерживаются языки ru, en, ua, uk, by, kz, tr. Если второй аргумент отсутствует - используется язык ru. Если язык не поддерживается - кидается исключение. Возвращает строку - название региона на соответствующем языке. Если региона с указанным идентификатором не существует - возвращается пустая строка. <br>  <br> ua и uk обозначают одно и то же - украинский язык.",en:"Accepts a UInt32 number - the region ID from the Yandex geobase. A string with the name of the language can be passed as a second argument. Supported languages are: ru, en, ua, uk, by, kz, tr. If the second argument is omitted, the language &#39;ru&#39; is used. If the language is not supported, an exception is thrown. Returns a string - the name of the region in the corresponding language. If the region with the specified ID doesn&#39;t exist, an empty string is returned. <br>  <br> &#39;ua&#39; and &#39;uk&#39; mean the same thing - Ukrainian."}},concat:{bracket:"(arr[, separator])",desc:{ru:"Склеивает строки, перечисленные в массиве, с разделителем separator. <br> separator - необязательный параметр, константная строка, по умолчанию равен пустой строке. <br> Возвращается строка.",en:"Concatenates strings from the array elements, using &#39;separator&#39; as the separator. <br> &#39;separator&#39; is a string constant, an optional parameter. By default it is an empty string. <br> Returns a string."}},convertCharset:{bracket:"(s, from, to)",desc:{ru:"Возвращает сконвертированную из кодировки from в кодировку to строку s.",en:"Returns a string with the data %%s%% (encoded as %%from%% charset) that was converted to the %%to%% charset."}},toMonth:{bracket:"(v)",desc:{ru:"Переводит дату или дату-с-временем в число типа UInt8, содержащее номер месяца (1-12).",en:"Converts a date or date with time to a UInt8 number containing the month number (1-12)."}},IPv6StringToNum:{bracket:"(s)",desc:{ru:"Функция, обратная к IPv6NumToString. Если IPv6 адрес в неправильном формате, то возвращает строку из нулевых байт. <br> HEX может быть в любом регистре.",
en:"The reverse function of IPv6NumToString. If the IPv6 address has an invalid format, it returns a string of null bytes. <br> HEX can be uppercase or lowercase."}},emptyArrayString:{bracket:"(v)",desc:{ru:"Принимает ноль аргументов и возвращает пустой массив соответствующего типа.",en:"Accepts zero arguments and returns an empty array of the appropriate type."}},uptime:{bracket:"()",desc:{ru:"Возвращает аптайм сервера в секундах.",en:"Returns server's uptime in seconds."}},blockSize:{bracket:"()",desc:{ru:"Получить размер блока. <br> В ClickHouse выполнение запроса всегда идёт по блокам (наборам кусочков столбцов). Функция позволяет получить размер блока, для которого её вызвали.",en:"Gets the size of the block. <br> In ClickHouse, queries are always run on blocks (sets of column parts). This function allows getting the size of the block that you called it for."}},toInt64OrZero:{bracket:"(v)",desc:{ru:"Функции преобразования между числами, строками (но не фиксированными строками), датами и датами-с-временем. <br> Все эти функции принимают один аргумент. <br>  <br> При преобразовании в строку или из строки, производится форматирование или парсинг значения по тем же правилам, что и для формата TabSeparated (и почти всех остальных текстовых форматов). Если распарсить строку не удаётся - кидается исключение и выполнение запроса прерывается. <br>  <br> При преобразовании даты в число или наоборот, дате соответствует число дней от начала unix эпохи. <br> При преобразовании даты-с-временем в число или наоборот, дате-с-временем соответствует число секунд от начала unix эпохи. <br>  <br> Форматы даты и даты-с-временем для функций toDate/toDateTime определены следующим образом: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> В качестве исключения, если делается преобразование из числа типа UInt32, Int32, UInt64, Int64 в Date, и если число больше или равно 65536, то число рассматривается как unix timestamp (а не как число дней) и округляется до даты. Это позволяет поддержать распространённый случай, когда пишут toDate(unix_timestamp), что иначе было бы ошибкой и требовало бы написания более громоздкого toDate(toDateTime(unix_timestamp)) <br>  <br> Преобразование между датой и датой-с-временем производится естественным образом: добавлением нулевого времени или отбрасыванием времени. <br>  <br> Преобразование между чи",en:"Functions for converting between numbers, strings (but not fixed strings), dates, and dates with times. All these functions accept one argument. <br>  <br> When converting to or from a string, the value is formatted or parsed using the same rules as for the TabSeparated format (and almost all other text formats). If the string can&#39;t be parsed, an exception is thrown and the request is canceled. <br>  <br> When converting dates to numbers or vice versa, the date corresponds to the number of days since the beginning of the Unix epoch. <br> When converting dates with times to numbers or vice versa, the date with time corresponds to the number of seconds since the beginning of the Unix epoch. <br>  <br> Formats of date and date with time for toDate/toDateTime functions are defined as follows: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> As an exception, if converting from UInt32, Int32, UInt64, or Int64 type numbers to Date, and if the number is greater than or equal to 65536, the number is interpreted as a Unix timestamp (and not as the number of days) and is rounded to the date. This allows support for the common occurrence of writing &#39;toDate(unix_timestamp)&#39;, which otherwise would be an error and would require writing the more cumbersome &#39;toDate(toDateTime(unix_timestamp))&#39;. <br>  <br> Conversion between a date and date with time is performed the natural way: by adding a null time or d"}},pathFull:{bracket:"(v)",desc:{ru:"То же самое, но включая query string и fragment. Пример: /top/news.html?page=2#comments",en:"- The same as above, but including query-string and fragment. Example: /top/news.html?page=2#comments"}},emptyArrayDate:{bracket:"(v)",desc:{ru:"Принимает ноль аргументов и возвращает пустой массив соответствующего типа.",en:"Accepts zero arguments and returns an empty array of the appropriate type."}},emptyArrayInt64:{bracket:"(v)",desc:{ru:"Принимает ноль аргументов и возвращает пустой массив соответствующего типа.",en:"Accepts zero arguments and returns an empty array of the appropriate type."}},toInt32OrZero:{bracket:"(v)",desc:{ru:"Функции преобразования между числами, строками (но не фиксированными строками), датами и датами-с-временем. <br> Все эти функции принимают один аргумент. <br>  <br> При преобразовании в строку или из строки, производится форматирование или парсинг значения по тем же правилам, что и для формата TabSeparated (и почти всех остальных текстовых форматов). Если распарсить строку не удаётся - кидается исключение и выполнение запроса прерывается. <br>  <br> При преобразовании даты в число или наоборот, дате соответствует число дней от начала unix эпохи. <br> При преобразовании даты-с-временем в число или наоборот, дате-с-временем соответствует число секунд от начала unix эпохи. <br>  <br> Форматы даты и даты-с-временем для функций toDate/toDateTime определены следующим образом: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> В качестве исключения, если делается преобразование из числа типа UInt32, Int32, UInt64, Int64 в Date, и если число больше или равно 65536, то число рассматривается как unix timestamp (а не как число дней) и округляется до даты. Это позволяет поддержать распространённый случай, когда пишут toDate(unix_timestamp), что иначе было бы ошибкой и требовало бы написания более громоздкого toDate(toDateTime(unix_timestamp)) <br>  <br> Преобразование между датой и датой-с-временем производится естественным образом: добавлением нулевого времени или отбрасыванием времени. <br>  <br> Преобразование между чи",en:"Functions for converting between numbers, strings (but not fixed strings), dates, and dates with times. All these functions accept one argument. <br>  <br> When converting to or from a string, the value is formatted or parsed using the same rules as for the TabSeparated format (and almost all other text formats). If the string can&#39;t be parsed, an exception is thrown and the request is canceled. <br>  <br> When converting dates to numbers or vice versa, the date corresponds to the number of days since the beginning of the Unix epoch. <br> When converting dates with times to numbers or vice versa, the date with time corresponds to the number of seconds since the beginning of the Unix epoch. <br>  <br> Formats of date and date with time for toDate/toDateTime functions are defined as follows: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> As an exception, if converting from UInt32, Int32, UInt64, or Int64 type numbers to Date, and if the number is greater than or equal to 65536, the number is interpreted as a Unix timestamp (and not as the number of days) and is rounded to the date. This allows support for the common occurrence of writing &#39;toDate(unix_timestamp)&#39;, which otherwise would be an error and would require writing the more cumbersome &#39;toDate(toDateTime(unix_timestamp))&#39;. <br>  <br> Conversion between a date and date with time is performed the natural way: by adding a null time or d"}},greater:{bracket:"(v)",desc:{ru:"",en:""}},emptyArrayInt32:{bracket:"(v)",desc:{ru:"Принимает ноль аргументов и возвращает пустой массив соответствующего типа.",en:"Accepts zero arguments and returns an empty array of the appropriate type."}},toString:{bracket:"(str)",desc:{ru:"Принимает значение типа FixedString(16). Возвращает строку из 36 символов в текстовом виде.",en:"Accepts a FixedString(16) value containing the UUID in the binary format. Returns a readable string containing the UUID in the text format."}},greatest:{bracket:"(a, b)",desc:{ru:"Возвращает наибольшее значение из a и b.",en:"Returns the greatest element of a and b."}},emptyArrayUInt64:{bracket:"(v)",desc:{ru:"Принимает ноль аргументов и возвращает пустой массив соответствующего типа.",en:"Accepts zero arguments and returns an empty array of the appropriate type."}},emptyArrayUInt32:{bracket:"(v)",desc:{ru:"Принимает ноль аргументов и возвращает пустой массив соответствующего типа.",en:"Accepts zero arguments and returns an empty array of the appropriate type."}},formatReadableSize:{bracket:"(x)",desc:{ru:"Принимает размер (число байт). Возвращает округленный размер с суффиксом (KiB, MiB и т.д.) в виде строки. <br>  <br> Пример: <br>  <br> %% <br> SELECT <br>     arrayJoin([1, 1024, 1024*1024, 192851925]) AS filesize_bytes, <br>     formatReadableSize(filesize_bytes) AS filesize <br>  <br> ┌─filesize_bytes─┬─filesize───┐ <br> │              1 │ 1.00 B     │ <br> │           1024 │ 1.00 KiB   │ <br> │        1048576 │ 1.00 MiB   │ <br> │      192851925 │ 183.92 MiB │ <br> └────────────────┴────────────┘ <br> %%",en:"Gets a size (number of bytes). Returns a string that contains rounded size with the suffix (KiB, MiB etc.). <br>  <br> Example: <br>  <br> %% <br> SELECT <br>     arrayJoin([1, 1024, 1024*1024, 192851925]) AS filesize_bytes, <br>     formatReadableSize(filesize_bytes) AS filesize <br>  <br> ┌─filesize_bytes─┬─filesize───┐ <br> │              1 │ 1.00 B     │ <br> │           1024 │ 1.00 KiB   │ <br> │        1048576 │ 1.00 MiB   │ <br> │      192851925 │ 183.92 MiB │ <br> └────────────────┴────────────┘ <br> %%"}},toInt16OrZero:{bracket:"(v)",desc:{ru:"Функции преобразования между числами, строками (но не фиксированными строками), датами и датами-с-временем. <br> Все эти функции принимают один аргумент. <br>  <br> При преобразовании в строку или из строки, производится форматирование или парсинг значения по тем же правилам, что и для формата TabSeparated (и почти всех остальных текстовых форматов). Если распарсить строку не удаётся - кидается исключение и выполнение запроса прерывается. <br>  <br> При преобразовании даты в число или наоборот, дате соответствует число дней от начала unix эпохи. <br> При преобразовании даты-с-временем в число или наоборот, дате-с-временем соответствует число секунд от начала unix эпохи. <br>  <br> Форматы даты и даты-с-временем для функций toDate/toDateTime определены следующим образом: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> В качестве исключения, если делается преобразование из числа типа UInt32, Int32, UInt64, Int64 в Date, и если число больше или равно 65536, то число рассматривается как unix timestamp (а не как число дней) и округляется до даты. Это позволяет поддержать распространённый случай, когда пишут toDate(unix_timestamp), что иначе было бы ошибкой и требовало бы написания более громоздкого toDate(toDateTime(unix_timestamp)) <br>  <br> Преобразование между датой и датой-с-временем производится естественным образом: добавлением нулевого времени или отбрасыванием времени. <br>  <br> Преобразование между чи",en:"Functions for converting between numbers, strings (but not fixed strings), dates, and dates with times. All these functions accept one argument. <br>  <br> When converting to or from a string, the value is formatted or parsed using the same rules as for the TabSeparated format (and almost all other text formats). If the string can&#39;t be parsed, an exception is thrown and the request is canceled. <br>  <br> When converting dates to numbers or vice versa, the date corresponds to the number of days since the beginning of the Unix epoch. <br> When converting dates with times to numbers or vice versa, the date with time corresponds to the number of seconds since the beginning of the Unix epoch. <br>  <br> Formats of date and date with time for toDate/toDateTime functions are defined as follows: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> As an exception, if converting from UInt32, Int32, UInt64, or Int64 type numbers to Date, and if the number is greater than or equal to 65536, the number is interpreted as a Unix timestamp (and not as the number of days) and is rounded to the date. This allows support for the common occurrence of writing &#39;toDate(unix_timestamp)&#39;, which otherwise would be an error and would require writing the more cumbersome &#39;toDate(toDateTime(unix_timestamp))&#39;. <br>  <br> Conversion between a date and date with time is performed the natural way: by adding a null time or d"}},emptyArrayUInt8:{bracket:"(v)",desc:{ru:"Принимает ноль аргументов и возвращает пустой массив соответствующего типа.",en:"Accepts zero arguments and returns an empty array of the appropriate type."}},protocol:{bracket:"(v)",desc:{ru:"Возвращает протокол. Примеры: http, ftp, mailto, magnet...",en:"- Selects the protocol. Examples: http, ftp, mailto, magnet..."}},regionToPopulation:{bracket:"(id[, geobase])",desc:{ru:'Получает население для региона. <br> Население может быть прописано в файлах с геобазой. Смотрите в разделе "Встроенные словари". <br> Если для региона не прописано население, возвращается 0. <br> В геобазе Яндекса, население может быть прописано для дочерних регионов, но не прописано для родительских.',en:"Gets the population for a region. <br> The population can be recorded in files with the geobase. See the section &quot;External dictionaries&quot;. <br> If the population is not recorded for the region, it returns 0. <br> In the Yandex geobase, the population might be recorded for child regions, but not for parent regions."}},notIn:{bracket:"(v)",desc:{ru:'Смотрите раздел "Операторы IN".',en:"See the section &quot;IN operators&quot;."}},position:{bracket:"(haystack, needle)",desc:{ru:"Так же, как position, но позиция возвращается в кодовых точках Unicode. Работает при допущении, что строка содержит набор байт, представляющий текст в кодировке UTF-8. Если допущение не выполнено - то возвращает какой-нибудь результат (не кидает исключение). <br> Есть также функция positionCaseInsensitiveUTF8.",en:"The same as &#39;position&#39;, but the position is returned in Unicode code points. Works under the assumption that the string contains a set of bytes representing a UTF-8 encoded text. If this assumption is not met, it returns some result (it doesn&#39;t throw an exception). <br> There's also positionCaseInsensitiveUTF8 function."}},arrayElement:{bracket:"(arr, n), arr[n] operator",desc:{ru:"Достаёт элемент с индексом n из массива arr. <br> n должен быть любым целочисленным типом. <br> Индексы в массиве начинаются с единицы. <br> Поддерживаются отрицательные индексы - в этом случае, будет выбран соответствующий по номеру элемент с конца. Например, arr[-1] - последний элемент массива. <br>  <br> Если индекс выходит за границы массива, то <br> - если оба аргумента - константы, то кидается исключение; <br> - иначе, возвращается некоторое значение по умолчанию (0 для чисел, пустая строка для строк и т. п.).",en:"Get the element with the index &#39;n&#39; from the array &#39;arr&#39;. <br> &#39;n&#39; should be any integer type. <br> Indexes in an array begin from one. <br> Negative indexes are supported - in this case, it selects the corresponding element numbered from the end. For example, &#39;arr[-1]&#39; is the last item in the array. <br>  <br> If the index goes beyond the array bounds: <br> - if both arguments are constants, an exception is thrown. <br> - otherwise, a default value is returned (0 for numbers, an empty string for strings, etc.)."}},toStringCutToZero:{bracket:"(s)",desc:{ru:"Принимает аргумент типа String или FixedString. Возвращает String, вырезая содержимое строки до первого найденного нулевого байта. <br>  <br> Пример: <br> %% <br> :) SELECT toFixedString('foo', 8) AS s, toStringCutToZero(s) AS s_cut <br>  <br> ┌─s─────────────┬─s_cut─┐ <br> │ foo\\0\\0\\0\\0\\0 │ foo   │ <br> └───────────────┴───────┘ <br>  <br> :) SELECT toFixedString('foo\\0bar', 8) AS s, toStringCutToZero(s) AS s_cut <br>  <br> ┌─s──────────┬─s_cut─┐ <br> │ foo\\0bar\\0 │ foo   │ <br> └────────────┴───────┘ <br> %%",en:"Accepts a String or FixedString argument. Returns a String that is cut to a first null byte occurrence. <br>  <br> Example: <br> %% <br> :) SELECT toFixedString('foo', 8) AS s, toStringCutToZero(s) AS s_cut <br>  <br> ┌─s─────────────┬─s_cut─┐ <br> │ foo\\0\\0\\0\\0\\0 │ foo   │ <br> └───────────────┴───────┘ <br>  <br> :) SELECT toFixedString('foo\\0bar', 8) AS s, toStringCutToZero(s) AS s_cut <br>  <br> ┌─s──────────┬─s_cut─┐ <br> │ foo\\0bar\\0 │ foo   │ <br> └────────────┴───────┘ <br> %%"}},log:{bracket:"(x)",desc:{ru:"Принимает числовой аргумент, возвращает число типа Float64, близкое к десятичному логарифму от аргумента.",en:"Accepts a numeric argument and returns a Float64 number close to the decimal logarithm of the argument."}},SEIn:{bracket:"(lhs, rhs)",desc:{ru:"Проверяет принадлежность поисковой системы lhs поисковой системе rhs.",en:"Checks whether the &#39;lhs&#39; search engine belongs to the &#39;rhs&#39; search engine."}},replicate:{bracket:"(v)",desc:{ru:'Создайте таблицу типа MergeTree с другим именем. Перенесите в её директорию с данными все данные из директории с данными таблицы типа ReplicatedMergeTree. Затем удалите таблицу типа ReplicatedMergeTree и перезапустите сервер. <br>  <br> Если вы хотите избавиться от таблицы ReplicatedMergeTree, не запуская сервер, то <br> - удалите соответствующий файл .sql в директории с метаданными (%%/opt/clickhouse/metadata/%%); <br> - удалите соответствующий путь в ZooKeeper (<span class="inline-example">/<i>path_to_table</i>/<i>replica_name</i></span>); <br> После этого, вы можете запустить сервер, создать таблицу типа MergeTree, перенести данные в её директорию, и перезапустить сервер.',en:'Create a MergeTree table with a different name. Move all the data from the directory with the ReplicatedMergeTree table data to the new table&#39;s data directory. Then delete the ReplicatedMergeTree table and restart the server. <br>  <br> If you want to get rid of a ReplicatedMergeTree table without launching the server: <br> - Delete the corresponding .sql file in the metadata directory (%%/opt/clickhouse/metadata/%%). <br> - Delete the corresponding path in ZooKeeper (<span class="inline-example">/<i>path_to_table</i>/<i>replica_name</i></span>). <br> After this, you can launch the server, create a MergeTree table, move the data to its directory, and then restart the server.'}},sipHash64:{bracket:"(v)",desc:{ru:'Вычисляет SipHash от строки. <br> Принимает аргумент типа String. Возвращает UInt64. <br> SipHash - криптографическая хэш-функция. Работает быстрее чем MD5 не менее чем в 3 раза. <br> Подробнее смотрите по ссылке: <a href="https://131002.net/siphash/">https://131002.net/siphash/</a>',en:'Calculates SipHash from a string. <br> Accepts a String-type argument. Returns UInt64. <br> SipHash is a cryptographic hash function. It works at least three times faster than MD5. For more information, see <a href="https://131002.net/siphash/">https://131002.net/siphash/</a>'}},emptyArrayUInt16:{bracket:"(v)",desc:{ru:"Принимает ноль аргументов и возвращает пустой массив соответствующего типа.",en:"Accepts zero arguments and returns an empty array of the appropriate type."}},hex:{bracket:"(str)",desc:{ru:"Принимает строку, содержащую произвольное количество шестнадцатеричных цифр, и возвращает строку, содержащую соответствующие байты. Поддерживаются как строчные, так и заглавные буквы A-F. Число шестнадцатеричных цифр не обязано быть чётным. Если оно нечётное - последняя цифра интерпретируется как младшая половинка байта 00-0F. Если строка-аргумент содержит что-либо кроме шестнадцатеричных цифр, то будет возвращён какой-либо implementation-defined результат (не кидается исключение). <br> Если вы хотите преобразовать результат в число, то вы можете использовать функции reverse и reinterpretAs<i>Type</i>.",en:"Accepts a string containing any number of hexadecimal digits, and returns a string containing the corresponding bytes. Supports both uppercase and lowercase letters A-F. The number of hexadecimal digits doesn&#39;t have to be even. If it is odd, the last digit is interpreted as the younger half of the 00-0F byte. If the argument string contains anything other than hexadecimal digits, some implementation-defined result is returned (an exception isn&#39;t thrown). <br> If you want to convert the result to a number, you can use the functions &#39;reverse&#39; and &#39;reinterpretAs<i>Type</i>&#39;."}},regionToDistrict:{bracket:"(id[, geobase])",desc:{ru:"Переводит регион в федеральный округ (тип в геобазе - 4). В остальном, аналогично функции regionToCity. <br>  <br> %% <br> SELECT DISTINCT regionToName(regionToDistrict(toUInt32(number), 'ua')) <br> FROM system.numbers <br> LIMIT 15 <br>  <br> ┌─regionToName(regionToDistrict(toUInt32(number), \\'ua\\'))─┐ <br> │                                                          │ <br> │ Центральный федеральный округ                            │ <br> │ Северо-Западный федеральный округ                        │ <br> │ Южный федеральный округ                                  │ <br> │ Северо-Кавказский федеральный округ                      │ <br> │ Приволжский федеральный округ                            │ <br> │ Уральский федеральный округ                              │ <br> │ Сибирский федеральный округ                              │ <br> │ Дальневосточный федеральный округ                        │ <br> │ Шотландия                                                │ <br> │ Фарерские острова                                        │ <br> │ Фламандский регион                                       │ <br> │ Брюссельский столичный регион                            │ <br> │ Валлония                                                 │ <br> │ Федерация Боснии и Герцеговины                           │ <br> └──────────────────────────────────────────────────────────┘ <br> %%",en:"Converts a region to a federal district (type 4 in the geobase). In every other way, this function is the same as &#39;regionToCity&#39;. <br>  <br> %% <br> SELECT DISTINCT regionToName(regionToDistrict(toUInt32(number), 'ua'), 'en') <br> FROM system.numbers <br> LIMIT 15 <br>  <br> ┌─regionToName(regionToDistrict(toUInt32(number), \\'ua\\'), \\'en\\')─┐ <br> │                                                                  │ <br> │ Central                                                          │ <br> │ Northwest                                                        │ <br> │ South                                                            │ <br> │ North Kavkaz                                                     │ <br> │ Volga Region                                                     │ <br> │ Ural                                                             │ <br> │ Siberian                                                         │ <br> │ Far East                                                         │ <br> │ Scotland                                                         │ <br> │ Faroe Islands                                                    │ <br> │ Flemish Region                                                   │ <br> │ Brussels-Capital Region                                          │ <br> │ Wallonia                                                         │ <br> │ Federation of Bosnia and Herzegovina                  "}},arrayFilter:{bracket:"(func, arr1, ...)",desc:{ru:"Вернуть массив, содержащий только те элементы массива arr1, для которых функция func возвращает не 0. <br>  <br> Примеры: <br>  <br> %% <br> SELECT arrayFilter(x -> x LIKE '%World%', ['Hello', 'abc World']) AS res <br>  <br> ┌─res───────────┐ <br> │ ['abc World'] │ <br> └───────────────┘ <br>  <br> SELECT <br>     arrayFilter( <br>         (i, x) -> x LIKE '%World%', <br>         arrayEnumerate(arr), <br>         ['Hello', 'abc World'] AS arr) <br>     AS res <br>  <br> ┌─res─┐ <br> │ [2] │ <br> └─────┘ <br> %%",en:"Returns an array containing only the elements in &#39;arr1&#39; for which &#39;func&#39; returns something other than 0. <br>  <br> Examples: <br>  <br> %% <br> SELECT arrayFilter(x -> x LIKE &#39;%World%&#39;, [&#39;Hello&#39;, &#39;abc World&#39;]) AS res <br>  <br> ┌─res───────────┐ <br> │ [&#39;abc World&#39;] │ <br> └───────────────┘ <br>  <br> SELECT <br>     arrayFilter( <br>         (i, x) -> x LIKE &#39;%World%&#39;, <br>         arrayEnumerate(arr), <br>         [&#39;Hello&#39;, &#39;abc World&#39;] AS arr) <br>     AS res <br>  <br> ┌─res─┐ <br> │ [2] │ <br> └─────┘ <br> %%"}},toStartOfQuarter:{bracket:"(v)",desc:{ru:"Округляет дату или дату-с-временем вниз до первого дня квартала. <br> Первый день квартала - это одно из 1 января, 1 апреля, 1 июля, 1 октября. <br> Возвращается дата.",en:"Rounds down a date or date with time to the first day of the quarter. <br> The first day of the quarter is either 1 January, 1 April, 1 July, or 1 October. Returns the date."}},divide:{bracket:"(a, b), a / b operator",desc:{ru:"Вычисляет частное чисел. Тип результата всегда является типом с плавающей запятой. <br> То есть, деление не целочисленное. Для целочисленного деления, используйте функцию intDiv. <br> При делении на ноль получится inf, -inf или nan.",en:"Calculates the quotient of the numbers. The result type is always a floating-point type. <br> It is not integer division. For integer division, use the &#39;intDiv&#39; function. <br> When dividing by zero you get &#39;inf&#39;, &#39;-inf&#39;, or &#39;nan&#39;."}},reverseUTF8:{bracket:"(v)",desc:{ru:"Разворачивает последовательность кодовых точек Unicode, при допущении, что строка содержит набор байт, представляющий текст в кодировке UTF-8. Иначе - что-то делает (не кидает исключение).",en:"Reverses a sequence of Unicode code points, assuming that the string contains a set of bytes representing a UTF-8 text. Otherwise, it does something else (it doesn&#39;t throw an exception)."}},toDate:{bracket:"(v)",desc:{ru:"Функции преобразования между числами, строками (но не фиксированными строками), датами и датами-с-временем. <br> Все эти функции принимают один аргумент. <br>  <br> При преобразовании в строку или из строки, производится форматирование или парсинг значения по тем же правилам, что и для формата TabSeparated (и почти всех остальных текстовых форматов). Если распарсить строку не удаётся - кидается исключение и выполнение запроса прерывается. <br>  <br> При преобразовании даты в число или наоборот, дате соответствует число дней от начала unix эпохи. <br> При преобразовании даты-с-временем в число или наоборот, дате-с-временем соответствует число секунд от начала unix эпохи. <br>  <br> Форматы даты и даты-с-временем для функций toDate/toDateTime определены следующим образом: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> В качестве исключения, если делается преобразование из числа типа UInt32, Int32, UInt64, Int64 в Date, и если число больше или равно 65536, то число рассматривается как unix timestamp (а не как число дней) и округляется до даты. Это позволяет поддержать распространённый случай, когда пишут toDate(unix_timestamp), что иначе было бы ошибкой и требовало бы написания более громоздкого toDate(toDateTime(unix_timestamp)) <br>  <br> Преобразование между датой и датой-с-временем производится естественным образом: добавлением нулевого времени или отбрасыванием времени. <br>  <br> Преобразование между чи",en:"Functions for converting between numbers, strings (but not fixed strings), dates, and dates with times. All these functions accept one argument. <br>  <br> When converting to or from a string, the value is formatted or parsed using the same rules as for the TabSeparated format (and almost all other text formats). If the string can&#39;t be parsed, an exception is thrown and the request is canceled. <br>  <br> When converting dates to numbers or vice versa, the date corresponds to the number of days since the beginning of the Unix epoch. <br> When converting dates with times to numbers or vice versa, the date with time corresponds to the number of seconds since the beginning of the Unix epoch. <br>  <br> Formats of date and date with time for toDate/toDateTime functions are defined as follows: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> As an exception, if converting from UInt32, Int32, UInt64, or Int64 type numbers to Date, and if the number is greater than or equal to 65536, the number is interpreted as a Unix timestamp (and not as the number of days) and is rounded to the date. This allows support for the common occurrence of writing &#39;toDate(unix_timestamp)&#39;, which otherwise would be an error and would require writing the more cumbersome &#39;toDate(toDateTime(unix_timestamp))&#39;. <br>  <br> Conversion between a date and date with time is performed the natural way: by adding a null time or d"}},emptyArrayFloat64:{bracket:"(v)",desc:{ru:"Принимает ноль аргументов и возвращает пустой массив соответствующего типа.",en:"Accepts zero arguments and returns an empty array of the appropriate type."}},abs:{bracket:"(s, c)",desc:{ru:"Если строка %%s%% непустая и не содержит символ %%c%% на конце, то добавляет символ %%c%% в конец.",en:"If the %%s%% string is non-empty and does not contain the %%c%% character at the end, it appends the %%c%% character to the end."}},yesterday:{bracket:"(v)",desc:{ru:"Принимает ноль аргументов и возвращает вчерашнюю дату на один из моментов выполнения запроса. <br> Делает то же самое, что today() - 1.",en:"Accepts zero arguments and returns yesterday&#39;s date at one of the moments of request execution. <br> The same as &#39;today() - 1&#39;."}},toMinute:{bracket:"(v)",desc:{ru:"Переводит дату-с-временем в число типа UInt8, содержащее номер минуты в часе (0-59).",en:"Converts a date with time to a UInt8 number containing the number of the minute of the hour (0-59)."}},bitXor:{bracket:"(a, b)",desc:{ru:"",en:""}},minus:{bracket:"(a, b), a - b operator",desc:{ru:"Вычисляет разность чисел. Результат всегда имеет знаковый тип. <br>  <br> Также можно вычитать целые числа из даты и даты-с-временем. Смысл аналогичен - смотрите выше для plus.",en:"Calculates the difference. The result is always signed. <br>  <br> You can also calculate whole numbers from a date or date with time. The idea is the same - see above for &#39;plus&#39;."}},toDateTime:{bracket:"(v)",desc:{ru:"Функции преобразования между числами, строками (но не фиксированными строками), датами и датами-с-временем. <br> Все эти функции принимают один аргумент. <br>  <br> При преобразовании в строку или из строки, производится форматирование или парсинг значения по тем же правилам, что и для формата TabSeparated (и почти всех остальных текстовых форматов). Если распарсить строку не удаётся - кидается исключение и выполнение запроса прерывается. <br>  <br> При преобразовании даты в число или наоборот, дате соответствует число дней от начала unix эпохи. <br> При преобразовании даты-с-временем в число или наоборот, дате-с-временем соответствует число секунд от начала unix эпохи. <br>  <br> Форматы даты и даты-с-временем для функций toDate/toDateTime определены следующим образом: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> В качестве исключения, если делается преобразование из числа типа UInt32, Int32, UInt64, Int64 в Date, и если число больше или равно 65536, то число рассматривается как unix timestamp (а не как число дней) и округляется до даты. Это позволяет поддержать распространённый случай, когда пишут toDate(unix_timestamp), что иначе было бы ошибкой и требовало бы написания более громоздкого toDate(toDateTime(unix_timestamp)) <br>  <br> Преобразование между датой и датой-с-временем производится естественным образом: добавлением нулевого времени или отбрасыванием времени. <br>  <br> Преобразование между чи",en:"Functions for converting between numbers, strings (but not fixed strings), dates, and dates with times. All these functions accept one argument. <br>  <br> When converting to or from a string, the value is formatted or parsed using the same rules as for the TabSeparated format (and almost all other text formats). If the string can&#39;t be parsed, an exception is thrown and the request is canceled. <br>  <br> When converting dates to numbers or vice versa, the date corresponds to the number of days since the beginning of the Unix epoch. <br> When converting dates with times to numbers or vice versa, the date with time corresponds to the number of seconds since the beginning of the Unix epoch. <br>  <br> Formats of date and date with time for toDate/toDateTime functions are defined as follows: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> As an exception, if converting from UInt32, Int32, UInt64, or Int64 type numbers to Date, and if the number is greater than or equal to 65536, the number is interpreted as a Unix timestamp (and not as the number of days) and is rounded to the date. This allows support for the common occurrence of writing &#39;toDate(unix_timestamp)&#39;, which otherwise would be an error and would require writing the more cumbersome &#39;toDate(toDateTime(unix_timestamp))&#39;. <br>  <br> Conversion between a date and date with time is performed the natural way: by adding a null time or d"
}},modulo:{bracket:"(a, b), a % b operator",desc:{ru:"Вычисляет остаток от деления. <br> Если аргументы - числа с плавающей запятой, то они предварительно преобразуются в целые числа, путём отбрасывания дробной части. <br> Берётся остаток в том же смысле, как это делается в C++. По факту, для отрицательных чисел, используется truncated division. <br> При делении на ноль или при делении минимального отрицательного числа на минус единицу, кидается исключение.",en:"Calculates the remainder after division. <br> If arguments are floating-point numbers, they are pre-converted to integers by dropping the decimal portion. The remainder is taken in the same sense as in C++. Truncated division is used for negative numbers. <br> An exception is thrown when dividing by zero or when dividing a minimal negative number by minus one."}},bitmaskToArray:{bracket:"(num)",desc:{ru:"Принимает целое число. Возвращает массив чисел типа UInt64, содержащий степени двойки, в сумме дающих исходное число; числа в массиве идут по возрастанию.",en:"Accepts an integer. Returns an array of UInt64 numbers containing the list of powers of two that total the source number when summed. Numbers in the array are in ascending order."}},negate:{bracket:"(a), -a operator",desc:{ru:"Вычисляет число, обратное по знаку. Результат всегда имеет знаковый тип.",en:"Calculates a number with the reverse sign. The result is always signed."}},emptyArrayFloat32:{bracket:"(v)",desc:{ru:"Принимает ноль аргументов и возвращает пустой массив соответствующего типа.",en:"Accepts zero arguments and returns an empty array of the appropriate type."}},range:{bracket:"(N)",desc:{ru:"Возвращает массив чисел от 0 до N-1. <br> На всякий случай, если на блок данных, создаются массивы суммарной длины больше 100 000 000 элементов, то кидается исключение.",en:"Returns an array of numbers from 0 to N-1. <br> Just in case, an exception is thrown if arrays with a total length of more than 100,000,000 elements are created in a data block."}},arrayAll:{bracket:"([func,] arr1, ...)",desc:{ru:"Вернуть 1, если для всех элементов массива arr, функция func возвращает не 0. Иначе вернуть 0.",en:"Returns 1 if &#39;func&#39; returns something other than 0 for all the elements in &#39;arr&#39;. Otherwise, it returns 0."}},toInt32:{bracket:"(v)",desc:{ru:"Функции преобразования между числами, строками (но не фиксированными строками), датами и датами-с-временем. <br> Все эти функции принимают один аргумент. <br>  <br> При преобразовании в строку или из строки, производится форматирование или парсинг значения по тем же правилам, что и для формата TabSeparated (и почти всех остальных текстовых форматов). Если распарсить строку не удаётся - кидается исключение и выполнение запроса прерывается. <br>  <br> При преобразовании даты в число или наоборот, дате соответствует число дней от начала unix эпохи. <br> При преобразовании даты-с-временем в число или наоборот, дате-с-временем соответствует число секунд от начала unix эпохи. <br>  <br> Форматы даты и даты-с-временем для функций toDate/toDateTime определены следующим образом: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> В качестве исключения, если делается преобразование из числа типа UInt32, Int32, UInt64, Int64 в Date, и если число больше или равно 65536, то число рассматривается как unix timestamp (а не как число дней) и округляется до даты. Это позволяет поддержать распространённый случай, когда пишут toDate(unix_timestamp), что иначе было бы ошибкой и требовало бы написания более громоздкого toDate(toDateTime(unix_timestamp)) <br>  <br> Преобразование между датой и датой-с-временем производится естественным образом: добавлением нулевого времени или отбрасыванием времени. <br>  <br> Преобразование между чи",en:"Functions for converting between numbers, strings (but not fixed strings), dates, and dates with times. All these functions accept one argument. <br>  <br> When converting to or from a string, the value is formatted or parsed using the same rules as for the TabSeparated format (and almost all other text formats). If the string can&#39;t be parsed, an exception is thrown and the request is canceled. <br>  <br> When converting dates to numbers or vice versa, the date corresponds to the number of days since the beginning of the Unix epoch. <br> When converting dates with times to numbers or vice versa, the date with time corresponds to the number of seconds since the beginning of the Unix epoch. <br>  <br> Formats of date and date with time for toDate/toDateTime functions are defined as follows: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> As an exception, if converting from UInt32, Int32, UInt64, or Int64 type numbers to Date, and if the number is greater than or equal to 65536, the number is interpreted as a Unix timestamp (and not as the number of days) and is rounded to the date. This allows support for the common occurrence of writing &#39;toDate(unix_timestamp)&#39;, which otherwise would be an error and would require writing the more cumbersome &#39;toDate(toDateTime(unix_timestamp))&#39;. <br>  <br> Conversion between a date and date with time is performed the natural way: by adding a null time or d"}},unhex:{bracket:"(str)",desc:{ru:"Принимает строку, содержащую произвольное количество шестнадцатеричных цифр, и возвращает строку, содержащую соответствующие байты. Поддерживаются как строчные, так и заглавные буквы A-F. Число шестнадцатеричных цифр не обязано быть чётным. Если оно нечётное - последняя цифра интерпретируется как младшая половинка байта 00-0F. Если строка-аргумент содержит что-либо кроме шестнадцатеричных цифр, то будет возвращён какой-либо implementation-defined результат (не кидается исключение). <br> Если вы хотите преобразовать результат в число, то вы можете использовать функции reverse и reinterpretAs<i>Type</i>.",en:"Accepts a string containing any number of hexadecimal digits, and returns a string containing the corresponding bytes. Supports both uppercase and lowercase letters A-F. The number of hexadecimal digits doesn&#39;t have to be even. If it is odd, the last digit is interpreted as the younger half of the 00-0F byte. If the argument string contains anything other than hexadecimal digits, some implementation-defined result is returned (an exception isn&#39;t thrown). <br> If you want to convert the result to a number, you can use the functions &#39;reverse&#39; and &#39;reinterpretAs<i>Type</i>&#39;."}},toFloat64:{bracket:"(v)",desc:{ru:"Функции преобразования между числами, строками (но не фиксированными строками), датами и датами-с-временем. <br> Все эти функции принимают один аргумент. <br>  <br> При преобразовании в строку или из строки, производится форматирование или парсинг значения по тем же правилам, что и для формата TabSeparated (и почти всех остальных текстовых форматов). Если распарсить строку не удаётся - кидается исключение и выполнение запроса прерывается. <br>  <br> При преобразовании даты в число или наоборот, дате соответствует число дней от начала unix эпохи. <br> При преобразовании даты-с-временем в число или наоборот, дате-с-временем соответствует число секунд от начала unix эпохи. <br>  <br> Форматы даты и даты-с-временем для функций toDate/toDateTime определены следующим образом: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> В качестве исключения, если делается преобразование из числа типа UInt32, Int32, UInt64, Int64 в Date, и если число больше или равно 65536, то число рассматривается как unix timestamp (а не как число дней) и округляется до даты. Это позволяет поддержать распространённый случай, когда пишут toDate(unix_timestamp), что иначе было бы ошибкой и требовало бы написания более громоздкого toDate(toDateTime(unix_timestamp)) <br>  <br> Преобразование между датой и датой-с-временем производится естественным образом: добавлением нулевого времени или отбрасыванием времени. <br>  <br> Преобразование между чи",en:"Functions for converting between numbers, strings (but not fixed strings), dates, and dates with times. All these functions accept one argument. <br>  <br> When converting to or from a string, the value is formatted or parsed using the same rules as for the TabSeparated format (and almost all other text formats). If the string can&#39;t be parsed, an exception is thrown and the request is canceled. <br>  <br> When converting dates to numbers or vice versa, the date corresponds to the number of days since the beginning of the Unix epoch. <br> When converting dates with times to numbers or vice versa, the date with time corresponds to the number of seconds since the beginning of the Unix epoch. <br>  <br> Formats of date and date with time for toDate/toDateTime functions are defined as follows: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> As an exception, if converting from UInt32, Int32, UInt64, or Int64 type numbers to Date, and if the number is greater than or equal to 65536, the number is interpreted as a Unix timestamp (and not as the number of days) and is rounded to the date. This allows support for the common occurrence of writing &#39;toDate(unix_timestamp)&#39;, which otherwise would be an error and would require writing the more cumbersome &#39;toDate(toDateTime(unix_timestamp))&#39;. <br>  <br> Conversion between a date and date with time is performed the natural way: by adding a null time or d"}},bitAnd:{bracket:"(a, b)",desc:{ru:"",en:""}},toStartOfYear:{bracket:"(v)",desc:{ru:"Округляет дату или дату-с-временем вниз до первого дня года. <br> Возвращается дата.",en:"Rounds down a date or date with time to the first day of the year. <br> Returns the date."}},bitOr:{bracket:"(a, b)",desc:{ru:"",en:""}},SEToRoot:{bracket:"(v)",desc:{ru:"Принимает число типа UInt8 - идентификатор поисковой системы из словаря Яндекс.Метрики. Если переданному числу соответствует какая-либо поисковая система - возвращает число типа UInt8 - идентификатор соответствующей корневой поисковой системы (например, переводит Яндекс.Картинки в Яндекс). Иначе возвращает 0.",en:"Accepts a UInt8 number - the ID of the search engine from the Yandex.Metrica dictionary. If any search engine matches the passed number, it returns a UInt8 number - the ID of the corresponding root search engine (for example, it converts Yandex.Images to Yandex). Otherwise, returns 0."}},toRelativeMinuteNum:{bracket:"(v)",desc:{ru:"Переводит дату-с-временем в номер минуты, начиная с некоторого фиксированного момента в прошлом.",en:"Converts a date with time or date to the number of the minute, starting from a certain fixed point in the past."}},visitParamExtractInt:{bracket:"(params, name)",desc:{ru:"Аналогично для Int64.",en:"The same as for Int64."}},emptyArrayInt16:{bracket:"(v)",desc:{ru:"Принимает ноль аргументов и возвращает пустой массив соответствующего типа.",en:"Accepts zero arguments and returns an empty array of the appropriate type."}},visitParamExtractString:{bracket:"(params, name)",desc:{ru:"Распарсить строку в двойных кавычках. У значения убирается экранирование. Если убрать экранированные символы не удалось, то возвращается пустая строка. Примеры: <br> %%visitParamExtractString('{\"abc\":\"\\\\n\\\\u0000\"}', 'abc') = '\\n\\0'%% <br> %%visitParamExtractString('{\"abc\":\"\\\\u263a\"}', 'abc') = '☺'%% <br> %%visitParamExtractString('{\"abc\":\"\\\\u263\"}', 'abc') = ''%% <br> %%visitParamExtractString('{\"abc\":\"hello}', 'abc') = ''%% <br> На данный момент, не поддерживаются записанные в формате \\uXXXX\\uYYYY кодовые точки не из basic multilingual plane (они переводятся не в UTF-8, а в CESU-8).",en:"Parses the string in double quotes. The value is unescaped. If unescaping failed, it returns an empty string. Examples: <br> %%visitParamExtractString(&#39;{&quot;abc&quot;:&quot;\\\\n\\\\u0000&quot;}&#39;, &#39;abc&#39;) = &#39;\\n\\0&#39;%% <br> %%visitParamExtractString(&#39;{&quot;abc&quot;:&quot;\\\\u263a&quot;}&#39;, &#39;abc&#39;) = &#39;☺&#39;%% <br> %%visitParamExtractString(&#39;{&quot;abc&quot;:&quot;\\\\u263&quot;}&#39;, &#39;abc&#39;) = &#39;&#39;%% <br> %%visitParamExtractString(&#39;{&quot;abc&quot;:&quot;hello}&#39;, &#39;abc&#39;) = &#39;&#39;%% <br> Currently, there is no support for code points not from the basic multilingual plane written in the format \\uXXXX\\uYYYY (they are converted to CESU-8 instead of UTF-8)."}},arrayEnumerateUniq:{bracket:"(arr, ...)",desc:{ru:"Возвращает массив, такого же размера, как исходный, где для каждого элемента указано, какой он по счету среди элементов с таким же значением. <br> Например: %%arrayEnumerateUniq([10, 20, 10, 30]) = [1,  1,  2,  1]%%. <br>  <br> Эта функция полезна при использовании ARRAY JOIN и агрегации по элементам массива. Пример: <br>  <br> %% <br> SELECT <br>     Goals.ID AS GoalID, <br>     sum(Sign) AS Reaches, <br>     sumIf(Sign, num = 1) AS Visits <br> FROM test.visits <br> ARRAY JOIN <br>     Goals, <br>     arrayEnumerateUniq(Goals.ID) AS num <br> WHERE CounterID = 160656 <br> GROUP BY GoalID <br> ORDER BY Reaches DESC <br> LIMIT 10 <br>  <br> ┌──GoalID─┬─Reaches─┬─Visits─┐ <br> │   53225 │    3214 │   1097 │ <br> │ 2825062 │    3188 │   1097 │ <br> │   56600 │    2803 │    488 │ <br> │ 1989037 │    2401 │    365 │ <br> │ 2830064 │    2396 │    910 │ <br> │ 1113562 │    2372 │    373 │ <br> │ 3270895 │    2262 │    812 │ <br> │ 1084657 │    2262 │    345 │ <br> │   56599 │    2260 │    799 │ <br> │ 3271094 │    2256 │    812 │ <br> └─────────┴─────────┴────────┘ <br> %% <br>  <br> В этом примере, для каждого идентификатора цели, посчитано количество достижений целей (каждый элемент вложенной структуры данных Goals является достижением целей) и количество визитов. Если бы не было ARRAY JOIN, мы бы считали количество визитов как %%sum(Sign)%%. Но в данном случае, строчки были размножены по вложенной структуре Goals, и чтобы после это",en:"Returns an array the same size as the source array, indicating for each element what its position is among elements with the same value. <br> For example: %%arrayEnumerateUniq([10, 20, 10, 30]) = [1,  1,  2,  1]%%. <br>  <br> This function is useful when using ARRAY JOIN and aggregation of array elements. Example: <br>  <br> %% <br> SELECT <br>     Goals.ID AS GoalID, <br>     sum(Sign) AS Reaches, <br>     sumIf(Sign, num = 1) AS Visits <br> FROM test.visits <br> ARRAY JOIN <br>     Goals, <br>     arrayEnumerateUniq(Goals.ID) AS num <br> WHERE CounterID = 160656 <br> GROUP BY GoalID <br> ORDER BY Reaches DESC <br> LIMIT 10 <br>  <br> ┌──GoalID─┬─Reaches─┬─Visits─┐ <br> │   53225 │    3214 │   1097 │ <br> │ 2825062 │    3188 │   1097 │ <br> │   56600 │    2803 │    488 │ <br> │ 1989037 │    2401 │    365 │ <br> │ 2830064 │    2396 │    910 │ <br> │ 1113562 │    2372 │    373 │ <br> │ 3270895 │    2262 │    812 │ <br> │ 1084657 │    2262 │    345 │ <br> │   56599 │    2260 │    799 │ <br> │ 3271094 │    2256 │    812 │ <br> └─────────┴─────────┴────────┘ <br> %% <br>  <br> In this example, each goal ID has a calculation of the number of conversions (each element in the Goals nested data structure is a goal that was reached, which we refer to as a conversion) and the number of sessions. Without ARRAY JOIN, we would have counted the number of sessions as %%sum(Sign)%%. But in this particular case, the rows were multiplied by the"}},visitParamExtractUInt:{bracket:"(params, name)",desc:{ru:"Распарсить UInt64 из значения поля с именем name. Если поле строковое - попытаться распарсить число из начала строки. Если такого поля нет, или если оно есть, но содержит не число, то вернуть 0.",en:"Parses UInt64 from the value of the field named &#39;name&#39;. If this is a string field, it tries to parse a number from the beginning of the string. If the field doesn&#39;t exist, or it exists but doesn&#39;t contain a number, it returns 0."}},toTypeName:{bracket:"(x)",desc:{ru:"Возвращает строку, содержащую имя типа переданного аргумента.",en:"Gets the type name. Returns a string containing the type name of the passed argument."}},empty:{bracket:"(v)",desc:{ru:"Принимает пустой массив и возвращает массив из одного элемента, равного значению по умолчанию.",en:"Accepts an empty array as argument and returns an array of one element equal to the default value."}},multiply:{bracket:"(a, b), a * b operator",desc:{ru:"Вычисляет произведение чисел.",en:"Calculates the product of the numbers."}},has:{bracket:"('database', 'table', 'column')",desc:{ru:"",en:"Accepts constant String columns - database name, table name and column name. Returns constant UInt8 value, equal to 1 if column exists, <br> otherwise 0. <br> If table doesn't exist than exception is thrown. <br> For elements of nested data structure function checks existence of column. For nested data structure 0 is returned."}},bitNot:{bracket:"(a)",desc:{ru:"",en:""}},lessOrEquals:{bracket:"(v)",desc:{ru:"",en:"<h3>greaterOrEquals, >= operator</h3>"}},reinterpretAsInt64:{bracket:"(v)",desc:{ru:"Функции принимают строку и интерпретируют байты, расположенные в начале строки, как число в host order (little endian). Если строка имеет недостаточную длину, то функции работают так, как будто строка дополнена необходимым количеством нулевых байт. Если строка длиннее, чем нужно, то лишние байты игнорируются. Дата интерпретируется, как число дней с начала unix-эпохи, а дата-с-временем - как число секунд с начала unix-эпохи.",en:"These functions accept a string and interpret the bytes placed at the beginning of the string as a number in host order (little endian). If the string isn&#39;t long enough, the functions work as if the string is padded with the necessary number of null bytes. If the string is longer than needed, the extra bytes are ignored. A date is interpreted as the number of days since the beginning of the Unix Epoch, and a date with time is interpreted as the number of seconds since the beginning of the Unix Epoch."}},IPv4NumToString:{bracket:"(num)",desc:{ru:"Похоже на IPv4NumToString, но вместо последнего октета используется %%xxx%%. Пример: <br>  <br> %% <br> SELECT <br>     IPv4NumToStringClassC(ClientIP) AS k, <br>     count() AS c <br> FROM test.hits <br> GROUP BY k <br> ORDER BY c DESC <br> LIMIT 10 <br>  <br> ┌─k──────────────┬─────c─┐ <br> │ 83.149.9.xxx   │ 26238 │ <br> │ 217.118.81.xxx │ 26074 │ <br> │ 213.87.129.xxx │ 25481 │ <br> │ 83.149.8.xxx   │ 24984 │ <br> │ 217.118.83.xxx │ 22797 │ <br> │ 78.25.120.xxx  │ 22354 │ <br> │ 213.87.131.xxx │ 21285 │ <br> │ 78.25.121.xxx  │ 20887 │ <br> │ 188.162.65.xxx │ 19694 │ <br> │ 83.149.48.xxx  │ 17406 │ <br> └────────────────┴───────┘ <br> %% <br>  <br> В связи с тем, что использование xxx весьма необычно, это может быть изменено в дальнейшем, и вам не следует полагаться на конкретный вид этого фрагмента.",en:"Similar to IPv4NumToString, but using %%xxx%% instead of the last octet. Example: <br>  <br> %% <br> SELECT <br>     IPv4NumToStringClassC(ClientIP) AS k, <br>     count() AS c <br> FROM test.hits <br> GROUP BY k <br> ORDER BY c DESC <br> LIMIT 10 <br>  <br> ┌─k──────────────┬─────c─┐ <br> │ 83.149.9.xxx   │ 26238 │ <br> │ 217.118.81.xxx │ 26074 │ <br> │ 213.87.129.xxx │ 25481 │ <br> │ 83.149.8.xxx   │ 24984 │ <br> │ 217.118.83.xxx │ 22797 │ <br> │ 78.25.120.xxx  │ 22354 │ <br> │ 213.87.131.xxx │ 21285 │ <br> │ 78.25.121.xxx  │ 20887 │ <br> │ 188.162.65.xxx │ 19694 │ <br> │ 83.149.48.xxx  │ 17406 │ <br> └────────────────┴───────┘ <br> %% <br>  <br> Since using &#39;xxx&#39; is highly unusual, this may be changed in the future. We recommend that you don&#39;t rely on the exact format of this fragment."}},bitShiftLeft:{bracket:"(a, b)",desc:{ru:"",en:""}},dictGetInt16:{bracket:"(v)",desc:{ru:"%%dictGet<i>T</i>('dict_name', 'attr_name', id)%% <br> - получить из словаря dict_name значение атрибута attr_name по ключу id. <br> dict_name и attr_name - константные строки. <br> id должен иметь тип UInt64. <br> Если ключа id нет в словаре - вернуть значение по умолчанию, заданное в описании словаря.",en:'<span class="inline-example">dictGet<i>T</i>(&#39;dict_name&#39;, &#39;attr_name&#39;, id)</span> <br> - Gets the value of the &#39;attr_name&#39; attribute from the &#39;dict_name&#39; dictionary by the &#39;id&#39; key. <br> &#39;dict_name&#39; and &#39;attr_name&#39; are constant strings. <br> &#39;id&#39; must be UInt64. <br> If the &#39;id&#39; key is not in the dictionary, it returns the default value set in the dictionary definition.'}},toUInt32OrZero:{bracket:"(v)",desc:{ru:"Функции преобразования между числами, строками (но не фиксированными строками), датами и датами-с-временем. <br> Все эти функции принимают один аргумент. <br>  <br> При преобразовании в строку или из строки, производится форматирование или парсинг значения по тем же правилам, что и для формата TabSeparated (и почти всех остальных текстовых форматов). Если распарсить строку не удаётся - кидается исключение и выполнение запроса прерывается. <br>  <br> При преобразовании даты в число или наоборот, дате соответствует число дней от начала unix эпохи. <br> При преобразовании даты-с-временем в число или наоборот, дате-с-временем соответствует число секунд от начала unix эпохи. <br>  <br> Форматы даты и даты-с-временем для функций toDate/toDateTime определены следующим образом: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> В качестве исключения, если делается преобразование из числа типа UInt32, Int32, UInt64, Int64 в Date, и если число больше или равно 65536, то число рассматривается как unix timestamp (а не как число дней) и округляется до даты. Это позволяет поддержать распространённый случай, когда пишут toDate(unix_timestamp), что иначе было бы ошибкой и требовало бы написания более громоздкого toDate(toDateTime(unix_timestamp)) <br>  <br> Преобразование между датой и датой-с-временем производится естественным образом: добавлением нулевого времени или отбрасыванием времени. <br>  <br> Преобразование между чи",en:"Functions for converting between numbers, strings (but not fixed strings), dates, and dates with times. All these functions accept one argument. <br>  <br> When converting to or from a string, the value is formatted or parsed using the same rules as for the TabSeparated format (and almost all other text formats). If the string can&#39;t be parsed, an exception is thrown and the request is canceled. <br>  <br> When converting dates to numbers or vice versa, the date corresponds to the number of days since the beginning of the Unix epoch. <br> When converting dates with times to numbers or vice versa, the date with time corresponds to the number of seconds since the beginning of the Unix epoch. <br>  <br> Formats of date and date with time for toDate/toDateTime functions are defined as follows: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> As an exception, if converting from UInt32, Int32, UInt64, or Int64 type numbers to Date, and if the number is greater than or equal to 65536, the number is interpreted as a Unix timestamp (and not as the number of days) and is rounded to the date. This allows support for the common occurrence of writing &#39;toDate(unix_timestamp)&#39;, which otherwise would be an error and would require writing the more cumbersome &#39;toDate(toDateTime(unix_timestamp))&#39;. <br>  <br> Conversion between a date and date with time is performed the natural way: by adding a null time or d"}},regionIn:{bracket:"(lhs, rhs[, geobase])",desc:{ru:"Проверяет принадлежность региона lhs региону rhs. Возвращает число типа UInt8, равное 1, если принадлежит и 0, если не принадлежит. <br> Отношение рефлексивное - любой регион принадлежит также самому себе.",en:"Checks whether a &#39;lhs&#39; region belongs to a &#39;rhs&#39; region. Returns a UInt8 number equal to 1 if it belongs, or 0 if it doesn&#39;t belong. <br> The relationship is reflexive - any region also belongs to itself."}},reinterpretAsUInt8:{bracket:"(v)",desc:{ru:"Функции принимают строку и интерпретируют байты, расположенные в начале строки, как число в host order (little endian). Если строка имеет недостаточную длину, то функции работают так, как будто строка дополнена необходимым количеством нулевых байт. Если строка длиннее, чем нужно, то лишние байты игнорируются. Дата интерпретируется, как число дней с начала unix-эпохи, а дата-с-временем - как число секунд с начала unix-эпохи.",en:"These functions accept a string and interpret the bytes placed at the beginning of the string as a number in host order (little endian). If the string isn&#39;t long enough, the functions work as if the string is padded with the necessary number of null bytes. If the string is longer than needed, the extra bytes are ignored. A date is interpreted as the number of days since the beginning of the Unix Epoch, and a date with time is interpreted as the number of seconds since the beginning of the Unix Epoch."}},dictIsIn:{bracket:"(v)",desc:{ru:"%%dictIsIn('dict_name', child_id, ancestor_id)%% <br> - для иерархического словаря dict_name - узнать, находится ли ключ child_id внутри ancestor_id (или совпадает с ancestor_id). Возвращает UInt8.",en:"%%dictIsIn(&#39;dict_name&#39;, child_id, ancestor_id)%% <br> - For the &#39;dict_name&#39; hierarchical dictionary, finds out whether the &#39;child_id&#39; key is located inside &#39;ancestor_id&#39; (or matches &#39;ancestor_id&#39;). Returns UInt8."}},toSecond:{bracket:"(v)",desc:{ru:"Переводит дату-с-временем в число типа UInt8, содержащее номер секунды в минуте (0-59). <br> Секунды координации не учитываются.",en:"Converts a date with time to a UInt8 number containing the number of the second in the minute (0-59). <br> Leap seconds are not accounted for."}},least:{bracket:"(a, b)",desc:{ru:"Возвращает наименьшее значение из a и b.",en:"Returns the least element of a and b."}},countEqual:{bracket:"(arr, x)",desc:{ru:'Возвращает количество элементов массива, равных x. Эквивалентно <span class="inline-example">arrayCount(elem -> elem = x, arr)</span>.',en:'Returns the number of elements in the array equal to &#39;x&#39;. Equivalent to <span class="inline-example">arrayCount(elem -> elem = x, arr)</span>.'}},IPv4StringToNum:{bracket:"(s)",desc:{ru:"Функция, обратная к IPv4NumToString. Если IPv4 адрес в неправильном формате, то возвращает 0.",en:"The reverse function of IPv4NumToString. If the IPv4 address has an invalid format, it returns 0."}},replaceRegexpAll:{bracket:"(haystack, pattern, replacement)",desc:{ru:"То же самое, но делается замена всех вхождений. Пример: <br>  <br> %% <br> SELECT replaceRegexpAll('Hello, World!', '.', '\\\\0\\\\0') AS res <br>  <br> ┌─res────────────────────────┐ <br> │ HHeelllloo,,  WWoorrlldd!! │ <br> └────────────────────────────┘ <br> %% <br>  <br> В качестве исключения, если регулярное выражение сработало на пустой подстроке, то замена делается не более одного раза. Пример: <br>  <br> %% <br> SELECT replaceRegexpAll('Hello, World!', '^', 'here: ') AS res <br>  <br> ┌─res─────────────────┐ <br> │ here: Hello, World! │ <br> └─────────────────────┘ <br> %%",en:"This does the same thing, but replaces all the occurrences. Example: <br>  <br> %% <br> SELECT replaceRegexpAll(&#39;Hello, World!&#39;, &#39;.&#39;, &#39;\\\\0\\\\0&#39;) AS res <br>  <br> ┌─res────────────────────────┐ <br> │ HHeelllloo,,  WWoorrlldd!! │ <br> └────────────────────────────┘ <br> %% <br>  <br> As an exception, if a regular expression worked on an empty substring, the replacement is not made more than once. Example: <br>  <br> %% <br> SELECT replaceRegexpAll(&#39;Hello, World!&#39;, &#39;^&#39;, &#39;here: &#39;) AS res <br>  <br> ┌─res─────────────────┐ <br> │ here: Hello, World! │ <br> └─────────────────────┘ <br> %%"}},SHA224:{bracket:"(v)",desc:{ru:"Вычисляет SHA-1, SHA-224, SHA-256 от строки и возвращает полученный набор байт в виде FixedString(20), FixedString(28), FixedString(32). <br> Функция работает достаточно медленно (SHA-1 - примерно 5 миллионов коротких строк в секунду на одном процессорном ядре, SHA-224 и SHA-256 - примерно 2.2 миллионов). <br> Рекомендуется использовать эти функции лишь в тех случаях, когда вам нужна конкретная хэш-функция и вы не можете её выбрать. <br> Даже в этих случаях, рекомендуется применять функцию оффлайн - заранее вычисляя значения при вставке в таблицу, вместо того, чтобы применять её при SELECT-ах.",en:"Calculates SHA-1, SHA-224, or SHA-256 from a string and returns the resulting set of bytes as FixedString(20), FixedString(28), or FixedString(32). <br> The function works fairly slowly (SHA-1 processes about 5 million short strings per second per processor core, while SHA-224 and SHA-256 process about 2.2 million). <br> We recommend using this function only in cases when you need a specific hash function and you can&#39;t select it. <br> Even in these cases, we recommend applying the function offline and pre-calculating values when inserting them into the table, instead of applying it in SELECTS."}},URLHash:{bracket:"(url[, N])",desc:{ru:"Быстрая некриптографическая хэш-функция неплохого качества для строки, полученной из URL путём некоторой нормализации. <br> URLHash(s) - вычислить хэш от строки без одного завершающего символа /, ? или # на конце, если такой там есть. <br> URLHash(s, N) - вычислить хэш от строки до N-го уровня в иерархии URL, без одного завершающего символа /, ? или # на конце, если такой там есть. <br> Уровни аналогичные URLHierarchy. Функция специфична для Яндекс.Метрики.",en:"A fast, decent-quality non-cryptographic hash function for a string obtained from a URL using some type of normalization. <br> URLHash(s) - Calculates a hash from a string without one of the trailing symbols /,? or # at the end, if present. <br> URL Hash(s, N) - Calculates a hash from a string up to the N level in the URL hierarchy, without one of the trailing symbols /,? or # at the end, if present. <br> Levels are the same as in URLHierarchy. This function is specific to Yandex.Metrica."}},equals:{bracket:"(v)",desc:{ru:"",en:"<h3>greaterOrEquals, >= operator</h3>"}},plus:{bracket:"(a, b), a + b operator",desc:{ru:"Вычисляет сумму чисел. <br>  <br> Также можно складывать целые числа с датой и датой-с-временем. В случае даты, прибавление целого числа означает прибавление соответствующего количества дней. В случае даты-с-временем - прибавление соответствующего количества секунд.",en:"Calculates the sum of the numbers. <br>  <br> You can also add whole numbers with a date or date and time. In the case of a date, adding a whole number means adding the corresponding number of days. For a date with time, it means adding the corresponding number of seconds."}},less:{bracket:"(v)",desc:{ru:"",en:"<h3>greaterOrEquals, >= operator</h3>"}},regionHierarchy:{bracket:"(id[, geobase])",desc:{ru:"Принимает число типа UInt32 - идентификатор региона из геобазы Яндекса. Возвращает массив идентификаторов регионов, состоящий из переданного региона и всех родителей по цепочке. <br> Пример: %%regionHierarchy(toUInt32(213)) = [213,1,3,225,10001,10000]%%.",en:"Accepts a UInt32 number - the region ID from the Yandex geobase. Returns an array of region IDs consisting of the passed region and all parents along the chain. <br> Example: %%regionHierarchy(toUInt32(213)) = [213,1,3,225,10001,10000]%%."}},toUInt64OrZero:{bracket:"(v)",desc:{ru:"Функции преобразования между числами, строками (но не фиксированными строками), датами и датами-с-временем. <br> Все эти функции принимают один аргумент. <br>  <br> При преобразовании в строку или из строки, производится форматирование или парсинг значения по тем же правилам, что и для формата TabSeparated (и почти всех остальных текстовых форматов). Если распарсить строку не удаётся - кидается исключение и выполнение запроса прерывается. <br>  <br> При преобразовании даты в число или наоборот, дате соответствует число дней от начала unix эпохи. <br> При преобразовании даты-с-временем в число или наоборот, дате-с-временем соответствует число секунд от начала unix эпохи. <br>  <br> Форматы даты и даты-с-временем для функций toDate/toDateTime определены следующим образом: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> В качестве исключения, если делается преобразование из числа типа UInt32, Int32, UInt64, Int64 в Date, и если число больше или равно 65536, то число рассматривается как unix timestamp (а не как число дней) и округляется до даты. Это позволяет поддержать распространённый случай, когда пишут toDate(unix_timestamp), что иначе было бы ошибкой и требовало бы написания более громоздкого toDate(toDateTime(unix_timestamp)) <br>  <br> Преобразование между датой и датой-с-временем производится естественным образом: добавлением нулевого времени или отбрасыванием времени. <br>  <br> Преобразование между чи",
en:"Functions for converting between numbers, strings (but not fixed strings), dates, and dates with times. All these functions accept one argument. <br>  <br> When converting to or from a string, the value is formatted or parsed using the same rules as for the TabSeparated format (and almost all other text formats). If the string can&#39;t be parsed, an exception is thrown and the request is canceled. <br>  <br> When converting dates to numbers or vice versa, the date corresponds to the number of days since the beginning of the Unix epoch. <br> When converting dates with times to numbers or vice versa, the date with time corresponds to the number of seconds since the beginning of the Unix epoch. <br>  <br> Formats of date and date with time for toDate/toDateTime functions are defined as follows: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> As an exception, if converting from UInt32, Int32, UInt64, or Int64 type numbers to Date, and if the number is greater than or equal to 65536, the number is interpreted as a Unix timestamp (and not as the number of days) and is rounded to the date. This allows support for the common occurrence of writing &#39;toDate(unix_timestamp)&#39;, which otherwise would be an error and would require writing the more cumbersome &#39;toDate(toDateTime(unix_timestamp))&#39;. <br>  <br> Conversion between a date and date with time is performed the natural way: by adding a null time or d"}},rowNumberInAllBlocks:{bracket:"()",desc:{ru:"Возвращает порядковый номер строки в блоке данных. Функция учитывает только задействованные блоки данных.",en:"Returns an incremental row number within all blocks that were processed by this function."}},toDayOfWeek:{bracket:"(v)",desc:{ru:"Переводит дату или дату-с-временем в число типа UInt8, содержащее номер дня в неделе (понедельник - 1, воскресенье - 7).",en:"Converts a date or date with time to a UInt8 number containing the number of the day of the week (Monday is 1, and Sunday is 7)."}},bar:{bracket:"(v)",desc:{ru:"Позволяет построить unicode-art диаграмму. <br>  <br> bar(x, min, max, width) - рисует полосу ширины пропорциональной (x - min) и равной width символов при x",en:"Allows building a unicode-art diagram. <br>  <br> bar(x, min, max, width) - Draws a band with a width proportional to (x - min) and equal to &#39;width&#39; characters when x"}},"if":{bracket:"(v)",desc:{ru:"К имени любой агрегатной функции может быть приписан суффикс -%%If%%. В этом случае, агрегатная функция принимает ещё один дополнительный аргумент - условие (типа UInt8). Агрегатная функция будет обрабатывать только те строки, для которых условие сработало. Если условие ни разу не сработало - возвращается некоторое значение по умолчанию (обычно - нули, пустые строки). <br>  <br> Примеры: %%countIf(cond)%%, %%avgIf(x, cond)%%, %%quantilesTimingIf(level1, level2)(x, cond)%%, %%argMinIf(arg, val, cond)%% и т. п. <br>  <br> С помощью условных агрегатных функций, вы можете вычислить агрегаты сразу для нескольких условий, не используя подзапросы и JOIN-ы. <br> Например, в Яндекс.Метрике, условные агрегатные функции используются для реализации функциональности сравнения сегментов.",en:"The suffix -%%If%% can be appended to the name of any aggregate function. In this case, the aggregate function accepts an extra argument - a condition (Uint8 type). The aggregate function processes only the rows that trigger the condition. If the condition was not triggered even once, it returns a default value (usually zeros or empty strings). <br>  <br> Examples: %%countIf(cond)%%, %%avgIf(x, cond)%%, %%quantilesTimingIf(level1, level2)(x, cond)%%, %%argMinIf(arg, val, cond)%% and so on. <br>  <br> You can use aggregate functions to calculate aggregates for multiple conditions at once, without using subqueries and JOINs. <br> For example, in Yandex.Metrica, we use conditional aggregate functions for implementing segment comparison functionality."}},regionToArea:{bracket:"(id[, geobase])",desc:{ru:"Переводит регион в область (тип в геобазе - 5). В остальном, аналогично функции regionToCity. <br>  <br> %% <br> SELECT DISTINCT regionToName(regionToArea(toUInt32(number), 'ua')) <br> FROM system.numbers <br> LIMIT 15 <br>  <br> ┌─regionToName(regionToArea(toUInt32(number), \\'ua\\'))─┐ <br> │                                                      │ <br> │ Москва и Московская область                          │ <br> │ Санкт-Петербург и Ленинградская область              │ <br> │ Белгородская область                                 │ <br> │ Ивановская область                                   │ <br> │ Калужская область                                    │ <br> │ Костромская область                                  │ <br> │ Курская область                                      │ <br> │ Липецкая область                                     │ <br> │ Орловская область                                    │ <br> │ Рязанская область                                    │ <br> │ Смоленская область                                   │ <br> │ Тамбовская область                                   │ <br> │ Тверская область                                     │ <br> │ Тульская область                                     │ <br> └──────────────────────────────────────────────────────┘ <br> %%",en:"Converts a region to an area (type 5 in the geobase). In every other way, this function is the same as &#39;regionToCity&#39;. <br>  <br> %% <br> SELECT DISTINCT regionToName(regionToArea(toUInt32(number), 'ua'), 'en') <br> FROM system.numbers <br> LIMIT 15 <br>  <br> ┌─regionToName(regionToArea(toUInt32(number), \\'ua\\'), \\'en\\')─┐ <br> │                                                              │ <br> │ Moscow and Moscow region                                     │ <br> │ Saint-Petersburg and Leningradskaya oblast                   │ <br> │ Belgorod District                                            │ <br> │ Ivanovo district                                             │ <br> │ Kaluga District                                              │ <br> │ Kostroma District                                            │ <br> │ Kursk District                                               │ <br> │ Lipetsk District                                             │ <br> │ Orel District                                                │ <br> │ Ryazhan District                                             │ <br> │ Smolensk District                                            │ <br> │ Tambov District                                              │ <br> │ Tver District                                                │ <br> │ Tula District                                                │ <br> └────────────────────────────────────────────────────────────"}},dictGetUInt16:{bracket:"(v)",desc:{ru:"%%dictGet<i>T</i>('dict_name', 'attr_name', id)%% <br> - получить из словаря dict_name значение атрибута attr_name по ключу id. <br> dict_name и attr_name - константные строки. <br> id должен иметь тип UInt64. <br> Если ключа id нет в словаре - вернуть значение по умолчанию, заданное в описании словаря.",en:'<span class="inline-example">dictGet<i>T</i>(&#39;dict_name&#39;, &#39;attr_name&#39;, id)</span> <br> - Gets the value of the &#39;attr_name&#39; attribute from the &#39;dict_name&#39; dictionary by the &#39;id&#39; key. <br> &#39;dict_name&#39; and &#39;attr_name&#39; are constant strings. <br> &#39;id&#39; must be UInt64. <br> If the &#39;id&#39; key is not in the dictionary, it returns the default value set in the dictionary definition.'}},toUInt8:{bracket:"(v)",desc:{ru:"Функции преобразования между числами, строками (но не фиксированными строками), датами и датами-с-временем. <br> Все эти функции принимают один аргумент. <br>  <br> При преобразовании в строку или из строки, производится форматирование или парсинг значения по тем же правилам, что и для формата TabSeparated (и почти всех остальных текстовых форматов). Если распарсить строку не удаётся - кидается исключение и выполнение запроса прерывается. <br>  <br> При преобразовании даты в число или наоборот, дате соответствует число дней от начала unix эпохи. <br> При преобразовании даты-с-временем в число или наоборот, дате-с-временем соответствует число секунд от начала unix эпохи. <br>  <br> Форматы даты и даты-с-временем для функций toDate/toDateTime определены следующим образом: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> В качестве исключения, если делается преобразование из числа типа UInt32, Int32, UInt64, Int64 в Date, и если число больше или равно 65536, то число рассматривается как unix timestamp (а не как число дней) и округляется до даты. Это позволяет поддержать распространённый случай, когда пишут toDate(unix_timestamp), что иначе было бы ошибкой и требовало бы написания более громоздкого toDate(toDateTime(unix_timestamp)) <br>  <br> Преобразование между датой и датой-с-временем производится естественным образом: добавлением нулевого времени или отбрасыванием времени. <br>  <br> Преобразование между чи",en:"Functions for converting between numbers, strings (but not fixed strings), dates, and dates with times. All these functions accept one argument. <br>  <br> When converting to or from a string, the value is formatted or parsed using the same rules as for the TabSeparated format (and almost all other text formats). If the string can&#39;t be parsed, an exception is thrown and the request is canceled. <br>  <br> When converting dates to numbers or vice versa, the date corresponds to the number of days since the beginning of the Unix epoch. <br> When converting dates with times to numbers or vice versa, the date with time corresponds to the number of seconds since the beginning of the Unix epoch. <br>  <br> Formats of date and date with time for toDate/toDateTime functions are defined as follows: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> As an exception, if converting from UInt32, Int32, UInt64, or Int64 type numbers to Date, and if the number is greater than or equal to 65536, the number is interpreted as a Unix timestamp (and not as the number of days) and is rounded to the date. This allows support for the common occurrence of writing &#39;toDate(unix_timestamp)&#39;, which otherwise would be an error and would require writing the more cumbersome &#39;toDate(toDateTime(unix_timestamp))&#39;. <br>  <br> Conversion between a date and date with time is performed the natural way: by adding a null time or d"}},toUInt16:{bracket:"(v)",desc:{ru:"Функции преобразования между числами, строками (но не фиксированными строками), датами и датами-с-временем. <br> Все эти функции принимают один аргумент. <br>  <br> При преобразовании в строку или из строки, производится форматирование или парсинг значения по тем же правилам, что и для формата TabSeparated (и почти всех остальных текстовых форматов). Если распарсить строку не удаётся - кидается исключение и выполнение запроса прерывается. <br>  <br> При преобразовании даты в число или наоборот, дате соответствует число дней от начала unix эпохи. <br> При преобразовании даты-с-временем в число или наоборот, дате-с-временем соответствует число секунд от начала unix эпохи. <br>  <br> Форматы даты и даты-с-временем для функций toDate/toDateTime определены следующим образом: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> В качестве исключения, если делается преобразование из числа типа UInt32, Int32, UInt64, Int64 в Date, и если число больше или равно 65536, то число рассматривается как unix timestamp (а не как число дней) и округляется до даты. Это позволяет поддержать распространённый случай, когда пишут toDate(unix_timestamp), что иначе было бы ошибкой и требовало бы написания более громоздкого toDate(toDateTime(unix_timestamp)) <br>  <br> Преобразование между датой и датой-с-временем производится естественным образом: добавлением нулевого времени или отбрасыванием времени. <br>  <br> Преобразование между чи",en:"Functions for converting between numbers, strings (but not fixed strings), dates, and dates with times. All these functions accept one argument. <br>  <br> When converting to or from a string, the value is formatted or parsed using the same rules as for the TabSeparated format (and almost all other text formats). If the string can&#39;t be parsed, an exception is thrown and the request is canceled. <br>  <br> When converting dates to numbers or vice versa, the date corresponds to the number of days since the beginning of the Unix epoch. <br> When converting dates with times to numbers or vice versa, the date with time corresponds to the number of seconds since the beginning of the Unix epoch. <br>  <br> Formats of date and date with time for toDate/toDateTime functions are defined as follows: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> As an exception, if converting from UInt32, Int32, UInt64, or Int64 type numbers to Date, and if the number is greater than or equal to 65536, the number is interpreted as a Unix timestamp (and not as the number of days) and is rounded to the date. This allows support for the common occurrence of writing &#39;toDate(unix_timestamp)&#39;, which otherwise would be an error and would require writing the more cumbersome &#39;toDate(toDateTime(unix_timestamp))&#39;. <br>  <br> Conversion between a date and date with time is performed the natural way: by adding a null time or d"}},path:{bracket:"(URL)",desc:{ru:"То же самое, но без протокола и хоста в результате. Элемент / (корень) не включается. Пример: <br>  <br> Функция используется для реализации древовидных отчётов по URL в Яндекс.Метрике. <br>  <br> %% <br> URLPathHierarchy('https://example.com/browse/CONV-6788') = <br> [ <br>     '/browse/', <br>     '/browse/CONV-6788' <br> ] <br> %%",en:"- The same thing, but without the protocol and host in the result. The / element (root) is not included. Example: <br>  <br> This function is used for implementing tree-view reports by URL in Yandex.Metrica. <br>  <br> %% <br> URLPathHierarchy(&#39;https://example.com/browse/CONV-6788&#39;) = <br> [ <br>     &#39;/browse/&#39;, <br>     &#39;/browse/CONV-6788&#39; <br> ] <br> %%"}},extractURLParameters:{bracket:"(URL)",desc:{ru:"Возвращает массив строк вида name=value, соответствующих параметрам URL. Значения никак не декодируются.",en:"- Gets an array of name=value strings corresponding to the URL parameters. The values are not decoded in any way."}},OSHierarchy:{bracket:"(v)",desc:{ru:"Принимает число типа UInt8 - идентификатор операционной системы из словаря Яндекс.Метрики. Возвращает массив с иерархией операционных систем. Аналогично функции regionHierarchy.",en:"Accepts a UInt8 number - the ID of the operating system from the Yandex.Metrica dictionary. Returns an array with a hierarchy of operating systems. Similar to the &#39;regionHierarchy&#39; function."}},cutQueryStringAndFragment:{bracket:"(v)",desc:{ru:"Удаляет query string и fragment identifier. Знак вопроса и символ решётки тоже удаляются.",en:"Removes the query-string and fragment identifier. The question mark and number sign are also removed."}},timeSlots:{bracket:"(StartTime, Duration)",desc:{ru:"Для интервала времени, начинающегося в StartTime и продолжающегося Duration секунд, возвращает массив моментов времени, состоящий из округлений вниз до получаса точек из этого интервала. <br> Например, %%timeSlots(toDateTime('2012-01-01 12:20:00'), toUInt32(600)) = [toDateTime('2012-01-01 12:00:00'), toDateTime('2012-01-01 12:30:00')]%%. <br> Это нужно для поиска хитов, входящих в соответствующий визит.",en:"For a time interval starting at &#39;StartTime&#39; and continuing for &#39;Duration&#39; seconds, it returns an array of moments in time, consisting of points from this interval rounded down to the half hour. <br> For example, %%timeSlots(toDateTime(&#39;2012-01-01 12:20:00&#39;), toUInt32(600)) = [toDateTime(&#39;2012-01-01 12:00:00&#39;), toDateTime(&#39;2012-01-01 12:30:00&#39;)]%%. <br> This is necessary for searching for pageviews in the corresponding session."}},toUInt32:{bracket:"(v)",desc:{ru:"Функции преобразования между числами, строками (но не фиксированными строками), датами и датами-с-временем. <br> Все эти функции принимают один аргумент. <br>  <br> При преобразовании в строку или из строки, производится форматирование или парсинг значения по тем же правилам, что и для формата TabSeparated (и почти всех остальных текстовых форматов). Если распарсить строку не удаётся - кидается исключение и выполнение запроса прерывается. <br>  <br> При преобразовании даты в число или наоборот, дате соответствует число дней от начала unix эпохи. <br> При преобразовании даты-с-временем в число или наоборот, дате-с-временем соответствует число секунд от начала unix эпохи. <br>  <br> Форматы даты и даты-с-временем для функций toDate/toDateTime определены следующим образом: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> В качестве исключения, если делается преобразование из числа типа UInt32, Int32, UInt64, Int64 в Date, и если число больше или равно 65536, то число рассматривается как unix timestamp (а не как число дней) и округляется до даты. Это позволяет поддержать распространённый случай, когда пишут toDate(unix_timestamp), что иначе было бы ошибкой и требовало бы написания более громоздкого toDate(toDateTime(unix_timestamp)) <br>  <br> Преобразование между датой и датой-с-временем производится естественным образом: добавлением нулевого времени или отбрасыванием времени. <br>  <br> Преобразование между чи",en:"Functions for converting between numbers, strings (but not fixed strings), dates, and dates with times. All these functions accept one argument. <br>  <br> When converting to or from a string, the value is formatted or parsed using the same rules as for the TabSeparated format (and almost all other text formats). If the string can&#39;t be parsed, an exception is thrown and the request is canceled. <br>  <br> When converting dates to numbers or vice versa, the date corresponds to the number of days since the beginning of the Unix epoch. <br> When converting dates with times to numbers or vice versa, the date with time corresponds to the number of seconds since the beginning of the Unix epoch. <br>  <br> Formats of date and date with time for toDate/toDateTime functions are defined as follows: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> As an exception, if converting from UInt32, Int32, UInt64, or Int64 type numbers to Date, and if the number is greater than or equal to 65536, the number is interpreted as a Unix timestamp (and not as the number of days) and is rounded to the date. This allows support for the common occurrence of writing &#39;toDate(unix_timestamp)&#39;, which otherwise would be an error and would require writing the more cumbersome &#39;toDate(toDateTime(unix_timestamp))&#39;. <br>  <br> Conversion between a date and date with time is performed the natural way: by adding a null time or d"}},toStartOfMinute:{bracket:"(v)",desc:{ru:"Округляет дату-с-временем вниз до начала минуты.",en:"Rounds down a date with time to the start of the minute."}},version:{bracket:"()",desc:{ru:"Возвращает версию сервера в виде строки.",en:"Returns server's version as a string."}},toUInt64:{bracket:"(v)",desc:{ru:"Функции преобразования между числами, строками (но не фиксированными строками), датами и датами-с-временем. <br> Все эти функции принимают один аргумент. <br>  <br> При преобразовании в строку или из строки, производится форматирование или парсинг значения по тем же правилам, что и для формата TabSeparated (и почти всех остальных текстовых форматов). Если распарсить строку не удаётся - кидается исключение и выполнение запроса прерывается. <br>  <br> При преобразовании даты в число или наоборот, дате соответствует число дней от начала unix эпохи. <br> При преобразовании даты-с-временем в число или наоборот, дате-с-временем соответствует число секунд от начала unix эпохи. <br>  <br> Форматы даты и даты-с-временем для функций toDate/toDateTime определены следующим образом: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> В качестве исключения, если делается преобразование из числа типа UInt32, Int32, UInt64, Int64 в Date, и если число больше или равно 65536, то число рассматривается как unix timestamp (а не как число дней) и округляется до даты. Это позволяет поддержать распространённый случай, когда пишут toDate(unix_timestamp), что иначе было бы ошибкой и требовало бы написания более громоздкого toDate(toDateTime(unix_timestamp)) <br>  <br> Преобразование между датой и датой-с-временем производится естественным образом: добавлением нулевого времени или отбрасыванием времени. <br>  <br> Преобразование между чи",en:"Functions for converting between numbers, strings (but not fixed strings), dates, and dates with times. All these functions accept one argument. <br>  <br> When converting to or from a string, the value is formatted or parsed using the same rules as for the TabSeparated format (and almost all other text formats). If the string can&#39;t be parsed, an exception is thrown and the request is canceled. <br>  <br> When converting dates to numbers or vice versa, the date corresponds to the number of days since the beginning of the Unix epoch. <br> When converting dates with times to numbers or vice versa, the date with time corresponds to the number of seconds since the beginning of the Unix epoch. <br>  <br> Formats of date and date with time for toDate/toDateTime functions are defined as follows: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> As an exception, if converting from UInt32, Int32, UInt64, or Int64 type numbers to Date, and if the number is greater than or equal to 65536, the number is interpreted as a Unix timestamp (and not as the number of days) and is rounded to the date. This allows support for the common occurrence of writing &#39;toDate(unix_timestamp)&#39;, which otherwise would be an error and would require writing the more cumbersome &#39;toDate(toDateTime(unix_timestamp))&#39;. <br>  <br> Conversion between a date and date with time is performed the natural way: by adding a null time or d"}},toInt16:{bracket:"(v)",desc:{ru:"Функции преобразования между числами, строками (но не фиксированными строками), датами и датами-с-временем. <br> Все эти функции принимают один аргумент. <br>  <br> При преобразовании в строку или из строки, производится форматирование или парсинг значения по тем же правилам, что и для формата TabSeparated (и почти всех остальных текстовых форматов). Если распарсить строку не удаётся - кидается исключение и выполнение запроса прерывается. <br>  <br> При преобразовании даты в число или наоборот, дате соответствует число дней от начала unix эпохи. <br> При преобразовании даты-с-временем в число или наоборот, дате-с-временем соответствует число секунд от начала unix эпохи. <br>  <br> Форматы даты и даты-с-временем для функций toDate/toDateTime определены следующим образом: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> В качестве исключения, если делается преобразование из числа типа UInt32, Int32, UInt64, Int64 в Date, и если число больше или равно 65536, то число рассматривается как unix timestamp (а не как число дней) и округляется до даты. Это позволяет поддержать распространённый случай, когда пишут toDate(unix_timestamp), что иначе было бы ошибкой и требовало бы написания более громоздкого toDate(toDateTime(unix_timestamp)) <br>  <br> Преобразование между датой и датой-с-временем производится естественным образом: добавлением нулевого времени или отбрасыванием времени. <br>  <br> Преобразование между чи",en:"Functions for converting between numbers, strings (but not fixed strings), dates, and dates with times. All these functions accept one argument. <br>  <br> When converting to or from a string, the value is formatted or parsed using the same rules as for the TabSeparated format (and almost all other text formats). If the string can&#39;t be parsed, an exception is thrown and the request is canceled. <br>  <br> When converting dates to numbers or vice versa, the date corresponds to the number of days since the beginning of the Unix epoch. <br> When converting dates with times to numbers or vice versa, the date with time corresponds to the number of seconds since the beginning of the Unix epoch. <br>  <br> Formats of date and date with time for toDate/toDateTime functions are defined as follows: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> As an exception, if converting from UInt32, Int32, UInt64, or Int64 type numbers to Date, and if the number is greater than or equal to 65536, the number is interpreted as a Unix timestamp (and not as the number of days) and is rounded to the date. This allows support for the common occurrence of writing &#39;toDate(unix_timestamp)&#39;, which otherwise would be an error and would require writing the more cumbersome &#39;toDate(toDateTime(unix_timestamp))&#39;. <br>  <br> Conversion between a date and date with time is performed the natural way: by adding a null time or d"}},reinterpretAsInt16:{bracket:"(v)",desc:{ru:"Функции принимают строку и интерпретируют байты, расположенные в начале строки, как число в host order (little endian). Если строка имеет недостаточную длину, то функции работают так, как будто строка дополнена необходимым количеством нулевых байт. Если строка длиннее, чем нужно, то лишние байты игнорируются. Дата интерпретируется, как число дней с начала unix-эпохи, а дата-с-временем - как число секунд с начала unix-эпохи.",en:"These functions accept a string and interpret the bytes placed at the beginning of the string as a number in host order (little endian). If the string isn&#39;t long enough, the functions work as if the string is padded with the necessary number of null bytes. If the string is longer than needed, the extra bytes are ignored. A date is interpreted as the number of days since the beginning of the Unix Epoch, and a date with time is interpreted as the number of seconds since the beginning of the Unix Epoch."}},toInt64:{bracket:"(v)",desc:{ru:"Функции преобразования между числами, строками (но не фиксированными строками), датами и датами-с-временем. <br> Все эти функции принимают один аргумент. <br>  <br> При преобразовании в строку или из строки, производится форматирование или парсинг значения по тем же правилам, что и для формата TabSeparated (и почти всех остальных текстовых форматов). Если распарсить строку не удаётся - кидается исключение и выполнение запроса прерывается. <br>  <br> При преобразовании даты в число или наоборот, дате соответствует число дней от начала unix эпохи. <br> При преобразовании даты-с-временем в число или наоборот, дате-с-временем соответствует число секунд от начала unix эпохи. <br>  <br> Форматы даты и даты-с-временем для функций toDate/toDateTime определены следующим образом: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> В качестве исключения, если делается преобразование из числа типа UInt32, Int32, UInt64, Int64 в Date, и если число больше или равно 65536, то число рассматривается как unix timestamp (а не как число дней) и округляется до даты. Это позволяет поддержать распространённый случай, когда пишут toDate(unix_timestamp), что иначе было бы ошибкой и требовало бы написания более громоздкого toDate(toDateTime(unix_timestamp)) <br>  <br> Преобразование между датой и датой-с-временем производится естественным образом: добавлением нулевого времени или отбрасыванием времени. <br>  <br> Преобразование между чи",en:"Functions for converting between numbers, strings (but not fixed strings), dates, and dates with times. All these functions accept one argument. <br>  <br> When converting to or from a string, the value is formatted or parsed using the same rules as for the TabSeparated format (and almost all other text formats). If the string can&#39;t be parsed, an exception is thrown and the request is canceled. <br>  <br> When converting dates to numbers or vice versa, the date corresponds to the number of days since the beginning of the Unix epoch. <br> When converting dates with times to numbers or vice versa, the date with time corresponds to the number of seconds since the beginning of the Unix epoch. <br>  <br> Formats of date and date with time for toDate/toDateTime functions are defined as follows: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> As an exception, if converting from UInt32, Int32, UInt64, or Int64 type numbers to Date, and if the number is greater than or equal to 65536, the number is interpreted as a Unix timestamp (and not as the number of days) and is rounded to the date. This allows support for the common occurrence of writing &#39;toDate(unix_timestamp)&#39;, which otherwise would be an error and would require writing the more cumbersome &#39;toDate(toDateTime(unix_timestamp))&#39;. <br>  <br> Conversion between a date and date with time is performed the natural way: by adding a null time or d"}},toFixedString:{bracket:"(s, N)",desc:{ru:"Преобразует аргумент типа String в тип FixedString(N) (строку фиксированной длины N). N должно быть константой. <br> Если строка имеет меньше байт, чем N, то она дополняется нулевыми байтами справа. Если строка имеет больше байт, чем N - кидается исключение.",en:"Converts a String type argument to a FixedString(N) type (a string with fixed length N). N must be a constant. If the string has fewer bytes than N, it is passed with null bytes to the right. If the string has more bytes than N, an exception is thrown."}},toFloat32:{bracket:"(v)",desc:{ru:"Функции преобразования между числами, строками (но не фиксированными строками), датами и датами-с-временем. <br> Все эти функции принимают один аргумент. <br>  <br> При преобразовании в строку или из строки, производится форматирование или парсинг значения по тем же правилам, что и для формата TabSeparated (и почти всех остальных текстовых форматов). Если распарсить строку не удаётся - кидается исключение и выполнение запроса прерывается. <br>  <br> При преобразовании даты в число или наоборот, дате соответствует число дней от начала unix эпохи. <br> При преобразовании даты-с-временем в число или наоборот, дате-с-временем соответствует число секунд от начала unix эпохи. <br>  <br> Форматы даты и даты-с-временем для функций toDate/toDateTime определены следующим образом: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> В качестве исключения, если делается преобразование из числа типа UInt32, Int32, UInt64, Int64 в Date, и если число больше или равно 65536, то число рассматривается как unix timestamp (а не как число дней) и округляется до даты. Это позволяет поддержать распространённый случай, когда пишут toDate(unix_timestamp), что иначе было бы ошибкой и требовало бы написания более громоздкого toDate(toDateTime(unix_timestamp)) <br>  <br> Преобразование между датой и датой-с-временем производится естественным образом: добавлением нулевого времени или отбрасыванием времени. <br>  <br> Преобразование между чи",en:"Functions for converting between numbers, strings (but not fixed strings), dates, and dates with times. All these functions accept one argument. <br>  <br> When converting to or from a string, the value is formatted or parsed using the same rules as for the TabSeparated format (and almost all other text formats). If the string can&#39;t be parsed, an exception is thrown and the request is canceled. <br>  <br> When converting dates to numbers or vice versa, the date corresponds to the number of days since the beginning of the Unix epoch. <br> When converting dates with times to numbers or vice versa, the date with time corresponds to the number of seconds since the beginning of the Unix epoch. <br>  <br> Formats of date and date with time for toDate/toDateTime functions are defined as follows: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> As an exception, if converting from UInt32, Int32, UInt64, or Int64 type numbers to Date, and if the number is greater than or equal to 65536, the number is interpreted as a Unix timestamp (and not as the number of days) and is rounded to the date. This allows support for the common occurrence of writing &#39;toDate(unix_timestamp)&#39;, which otherwise would be an error and would require writing the more cumbersome &#39;toDate(toDateTime(unix_timestamp))&#39;. <br>  <br> Conversion between a date and date with time is performed the natural way: by adding a null time or d"
}},dictGetHierarchy:{bracket:"(v)",desc:{ru:"%%dictGetHierarchy('dict_name', id)%% <br> - для иерархического словаря dict_name - вернуть массив ключей словаря, начиная с id и продолжая цепочкой родительских элементов. Возвращает Array(UInt64).",en:"%%dictGetHierarchy(&#39;dict_name&#39;, id)%% <br> - For the &#39;dict_name&#39; hierarchical dictionary, returns an array of dictionary keys starting from &#39;id&#39; and continuing along the chain of parent elements. Returns Array(UInt64)."}},dictGetInt64:{bracket:"(v)",desc:{ru:"%%dictGet<i>T</i>('dict_name', 'attr_name', id)%% <br> - получить из словаря dict_name значение атрибута attr_name по ключу id. <br> dict_name и attr_name - константные строки. <br> id должен иметь тип UInt64. <br> Если ключа id нет в словаре - вернуть значение по умолчанию, заданное в описании словаря.",en:'<span class="inline-example">dictGet<i>T</i>(&#39;dict_name&#39;, &#39;attr_name&#39;, id)</span> <br> - Gets the value of the &#39;attr_name&#39; attribute from the &#39;dict_name&#39; dictionary by the &#39;id&#39; key. <br> &#39;dict_name&#39; and &#39;attr_name&#39; are constant strings. <br> &#39;id&#39; must be UInt64. <br> If the &#39;id&#39; key is not in the dictionary, it returns the default value set in the dictionary definition.'}},CAST:{bracket:"(x, t)",desc:{ru:"Преобразует <i>x</i> в тип данных <i>t</i>. <br> Поддерживается также синтаксис %%CAST(x AS t)%%. <br>  <br> Пример: <br> %% <br> SELECT <br>     '2016-06-15 23:00:00' AS timestamp, <br>     CAST(timestamp AS DateTime) AS datetime, <br>     CAST(timestamp AS Date) AS date, <br>     CAST(timestamp, 'String') AS string, <br>     CAST(timestamp, 'FixedString(22)') AS fixed_string <br>  <br> ┌─timestamp───────────┬────────────datetime─┬───────date─┬─string──────────────┬─fixed_string──────────────┐ <br> │ 2016-06-15 23:00:00 │ 2016-06-15 23:00:00 │ 2016-06-15 │ 2016-06-15 23:00:00 │ 2016-06-15 23:00:00\\0\\0\\0 │ <br> └─────────────────────┴─────────────────────┴────────────┴─────────────────────┴───────────────────────────┘ <br> %% <br>  <br> Преобразование в FixedString(N) работает только для аргументов типа String или FixedString(N).",en:"Casts <i>x</i> to the <i>t</i> data type. <br> The syntax %%CAST(x AS t)%% is also supported. <br>  <br> Example: <br> %% <br> SELECT <br>     '2016-06-15 23:00:00' AS timestamp, <br>     CAST(timestamp AS DateTime) AS datetime, <br>     CAST(timestamp AS Date) AS date, <br>     CAST(timestamp, 'String') AS string, <br>     CAST(timestamp, 'FixedString(22)') AS fixed_string <br>  <br> ┌─timestamp───────────┬────────────datetime─┬───────date─┬─string──────────────┬─fixed_string──────────────┐ <br> │ 2016-06-15 23:00:00 │ 2016-06-15 23:00:00 │ 2016-06-15 │ 2016-06-15 23:00:00 │ 2016-06-15 23:00:00\\0\\0\\0 │ <br> └─────────────────────┴─────────────────────┴────────────┴─────────────────────┴───────────────────────────┘ <br> %% <br>  <br> Casting to FixedString(N) works only for String and FixedString(N)."}},toRelativeSecondNum:{bracket:"(v)",desc:{ru:"Переводит дату-с-временем в номер секунды, начиная с некоторого фиксированного момента в прошлом.",en:"Converts a date with time or date to the number of the second, starting from a certain fixed point in the past."}},toUInt8OrZero:{bracket:"(v)",desc:{ru:"Функции преобразования между числами, строками (но не фиксированными строками), датами и датами-с-временем. <br> Все эти функции принимают один аргумент. <br>  <br> При преобразовании в строку или из строки, производится форматирование или парсинг значения по тем же правилам, что и для формата TabSeparated (и почти всех остальных текстовых форматов). Если распарсить строку не удаётся - кидается исключение и выполнение запроса прерывается. <br>  <br> При преобразовании даты в число или наоборот, дате соответствует число дней от начала unix эпохи. <br> При преобразовании даты-с-временем в число или наоборот, дате-с-временем соответствует число секунд от начала unix эпохи. <br>  <br> Форматы даты и даты-с-временем для функций toDate/toDateTime определены следующим образом: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> В качестве исключения, если делается преобразование из числа типа UInt32, Int32, UInt64, Int64 в Date, и если число больше или равно 65536, то число рассматривается как unix timestamp (а не как число дней) и округляется до даты. Это позволяет поддержать распространённый случай, когда пишут toDate(unix_timestamp), что иначе было бы ошибкой и требовало бы написания более громоздкого toDate(toDateTime(unix_timestamp)) <br>  <br> Преобразование между датой и датой-с-временем производится естественным образом: добавлением нулевого времени или отбрасыванием времени. <br>  <br> Преобразование между чи",en:"Functions for converting between numbers, strings (but not fixed strings), dates, and dates with times. All these functions accept one argument. <br>  <br> When converting to or from a string, the value is formatted or parsed using the same rules as for the TabSeparated format (and almost all other text formats). If the string can&#39;t be parsed, an exception is thrown and the request is canceled. <br>  <br> When converting dates to numbers or vice versa, the date corresponds to the number of days since the beginning of the Unix epoch. <br> When converting dates with times to numbers or vice versa, the date with time corresponds to the number of seconds since the beginning of the Unix epoch. <br>  <br> Formats of date and date with time for toDate/toDateTime functions are defined as follows: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> As an exception, if converting from UInt32, Int32, UInt64, or Int64 type numbers to Date, and if the number is greater than or equal to 65536, the number is interpreted as a Unix timestamp (and not as the number of days) and is rounded to the date. This allows support for the common occurrence of writing &#39;toDate(unix_timestamp)&#39;, which otherwise would be an error and would require writing the more cumbersome &#39;toDate(toDateTime(unix_timestamp))&#39;. <br>  <br> Conversion between a date and date with time is performed the natural way: by adding a null time or d"}},toStartOfMonth:{bracket:"(v)",desc:{ru:"Округляет дату или дату-с-временем вниз до первого дня месяца. <br> Возвращается дата.",en:"Rounds down a date or date with time to the first day of the month. <br> Returns the date."}},rand64:{bracket:"(v)",desc:{ru:"Возвращает псевдослучайное число типа UInt64, равномерно распределённое среди всех чисел типа UInt64. <br> Используется linear congruential generator.",en:"Returns a pseudo-random UInt64 number, evenly distributed among all UInt64-type numbers. <br> Uses a linear congruential generator."}},toInt8OrZero:{bracket:"(v)",desc:{ru:"Функции преобразования между числами, строками (но не фиксированными строками), датами и датами-с-временем. <br> Все эти функции принимают один аргумент. <br>  <br> При преобразовании в строку или из строки, производится форматирование или парсинг значения по тем же правилам, что и для формата TabSeparated (и почти всех остальных текстовых форматов). Если распарсить строку не удаётся - кидается исключение и выполнение запроса прерывается. <br>  <br> При преобразовании даты в число или наоборот, дате соответствует число дней от начала unix эпохи. <br> При преобразовании даты-с-временем в число или наоборот, дате-с-временем соответствует число секунд от начала unix эпохи. <br>  <br> Форматы даты и даты-с-временем для функций toDate/toDateTime определены следующим образом: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> В качестве исключения, если делается преобразование из числа типа UInt32, Int32, UInt64, Int64 в Date, и если число больше или равно 65536, то число рассматривается как unix timestamp (а не как число дней) и округляется до даты. Это позволяет поддержать распространённый случай, когда пишут toDate(unix_timestamp), что иначе было бы ошибкой и требовало бы написания более громоздкого toDate(toDateTime(unix_timestamp)) <br>  <br> Преобразование между датой и датой-с-временем производится естественным образом: добавлением нулевого времени или отбрасыванием времени. <br>  <br> Преобразование между чи",en:"Functions for converting between numbers, strings (but not fixed strings), dates, and dates with times. All these functions accept one argument. <br>  <br> When converting to or from a string, the value is formatted or parsed using the same rules as for the TabSeparated format (and almost all other text formats). If the string can&#39;t be parsed, an exception is thrown and the request is canceled. <br>  <br> When converting dates to numbers or vice versa, the date corresponds to the number of days since the beginning of the Unix epoch. <br> When converting dates with times to numbers or vice versa, the date with time corresponds to the number of seconds since the beginning of the Unix epoch. <br>  <br> Formats of date and date with time for toDate/toDateTime functions are defined as follows: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> As an exception, if converting from UInt32, Int32, UInt64, or Int64 type numbers to Date, and if the number is greater than or equal to 65536, the number is interpreted as a Unix timestamp (and not as the number of days) and is rounded to the date. This allows support for the common occurrence of writing &#39;toDate(unix_timestamp)&#39;, which otherwise would be an error and would require writing the more cumbersome &#39;toDate(toDateTime(unix_timestamp))&#39;. <br>  <br> Conversion between a date and date with time is performed the natural way: by adding a null time or d"}},toFloat32OrZero:{bracket:"(v)",desc:{ru:"Функции преобразования между числами, строками (но не фиксированными строками), датами и датами-с-временем. <br> Все эти функции принимают один аргумент. <br>  <br> При преобразовании в строку или из строки, производится форматирование или парсинг значения по тем же правилам, что и для формата TabSeparated (и почти всех остальных текстовых форматов). Если распарсить строку не удаётся - кидается исключение и выполнение запроса прерывается. <br>  <br> При преобразовании даты в число или наоборот, дате соответствует число дней от начала unix эпохи. <br> При преобразовании даты-с-временем в число или наоборот, дате-с-временем соответствует число секунд от начала unix эпохи. <br>  <br> Форматы даты и даты-с-временем для функций toDate/toDateTime определены следующим образом: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> В качестве исключения, если делается преобразование из числа типа UInt32, Int32, UInt64, Int64 в Date, и если число больше или равно 65536, то число рассматривается как unix timestamp (а не как число дней) и округляется до даты. Это позволяет поддержать распространённый случай, когда пишут toDate(unix_timestamp), что иначе было бы ошибкой и требовало бы написания более громоздкого toDate(toDateTime(unix_timestamp)) <br>  <br> Преобразование между датой и датой-с-временем производится естественным образом: добавлением нулевого времени или отбрасыванием времени. <br>  <br> Преобразование между чи",en:"Functions for converting between numbers, strings (but not fixed strings), dates, and dates with times. All these functions accept one argument. <br>  <br> When converting to or from a string, the value is formatted or parsed using the same rules as for the TabSeparated format (and almost all other text formats). If the string can&#39;t be parsed, an exception is thrown and the request is canceled. <br>  <br> When converting dates to numbers or vice versa, the date corresponds to the number of days since the beginning of the Unix epoch. <br> When converting dates with times to numbers or vice versa, the date with time corresponds to the number of seconds since the beginning of the Unix epoch. <br>  <br> Formats of date and date with time for toDate/toDateTime functions are defined as follows: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> As an exception, if converting from UInt32, Int32, UInt64, or Int64 type numbers to Date, and if the number is greater than or equal to 65536, the number is interpreted as a Unix timestamp (and not as the number of days) and is rounded to the date. This allows support for the common occurrence of writing &#39;toDate(unix_timestamp)&#39;, which otherwise would be an error and would require writing the more cumbersome &#39;toDate(toDateTime(unix_timestamp))&#39;. <br>  <br> Conversion between a date and date with time is performed the natural way: by adding a null time or d"}},toYear:{bracket:"(v)",desc:{ru:"Переводит дату или дату-с-временем в число типа UInt16, содержащее номер года (AD).",en:"Converts a date or date with time to a UInt16 number containing the year number (AD)."}},atan:{bracket:"(x)",desc:{ru:"Арктангенс.",en:"The arc tangent."}},toFloat64OrZero:{bracket:"(v)",desc:{ru:"Функции преобразования между числами, строками (но не фиксированными строками), датами и датами-с-временем. <br> Все эти функции принимают один аргумент. <br>  <br> При преобразовании в строку или из строки, производится форматирование или парсинг значения по тем же правилам, что и для формата TabSeparated (и почти всех остальных текстовых форматов). Если распарсить строку не удаётся - кидается исключение и выполнение запроса прерывается. <br>  <br> При преобразовании даты в число или наоборот, дате соответствует число дней от начала unix эпохи. <br> При преобразовании даты-с-временем в число или наоборот, дате-с-временем соответствует число секунд от начала unix эпохи. <br>  <br> Форматы даты и даты-с-временем для функций toDate/toDateTime определены следующим образом: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> В качестве исключения, если делается преобразование из числа типа UInt32, Int32, UInt64, Int64 в Date, и если число больше или равно 65536, то число рассматривается как unix timestamp (а не как число дней) и округляется до даты. Это позволяет поддержать распространённый случай, когда пишут toDate(unix_timestamp), что иначе было бы ошибкой и требовало бы написания более громоздкого toDate(toDateTime(unix_timestamp)) <br>  <br> Преобразование между датой и датой-с-временем производится естественным образом: добавлением нулевого времени или отбрасыванием времени. <br>  <br> Преобразование между чи",en:"Functions for converting between numbers, strings (but not fixed strings), dates, and dates with times. All these functions accept one argument. <br>  <br> When converting to or from a string, the value is formatted or parsed using the same rules as for the TabSeparated format (and almost all other text formats). If the string can&#39;t be parsed, an exception is thrown and the request is canceled. <br>  <br> When converting dates to numbers or vice versa, the date corresponds to the number of days since the beginning of the Unix epoch. <br> When converting dates with times to numbers or vice versa, the date with time corresponds to the number of seconds since the beginning of the Unix epoch. <br>  <br> Formats of date and date with time for toDate/toDateTime functions are defined as follows: <br> %% <br> YYYY-MM-DD <br> YYYY-MM-DD hh:mm:ss <br> %% <br>  <br> As an exception, if converting from UInt32, Int32, UInt64, or Int64 type numbers to Date, and if the number is greater than or equal to 65536, the number is interpreted as a Unix timestamp (and not as the number of days) and is rounded to the date. This allows support for the common occurrence of writing &#39;toDate(unix_timestamp)&#39;, which otherwise would be an error and would require writing the more cumbersome &#39;toDate(toDateTime(unix_timestamp))&#39;. <br>  <br> Conversion between a date and date with time is performed the natural way: by adding a null time or d"}},arrayEnumerate:{bracket:"(arr, ...)",desc:{ru:"Возвращает массив, такого же размера, как исходный, где для каждого элемента указано, какой он по счету среди элементов с таким же значением. <br> Например: %%arrayEnumerateUniq([10, 20, 10, 30]) = [1,  1,  2,  1]%%. <br>  <br> Эта функция полезна при использовании ARRAY JOIN и агрегации по элементам массива. Пример: <br>  <br> %% <br> SELECT <br>     Goals.ID AS GoalID, <br>     sum(Sign) AS Reaches, <br>     sumIf(Sign, num = 1) AS Visits <br> FROM test.visits <br> ARRAY JOIN <br>     Goals, <br>     arrayEnumerateUniq(Goals.ID) AS num <br> WHERE CounterID = 160656 <br> GROUP BY GoalID <br> ORDER BY Reaches DESC <br> LIMIT 10 <br>  <br> ┌──GoalID─┬─Reaches─┬─Visits─┐ <br> │   53225 │    3214 │   1097 │ <br> │ 2825062 │    3188 │   1097 │ <br> │   56600 │    2803 │    488 │ <br> │ 1989037 │    2401 │    365 │ <br> │ 2830064 │    2396 │    910 │ <br> │ 1113562 │    2372 │    373 │ <br> │ 3270895 │    2262 │    812 │ <br> │ 1084657 │    2262 │    345 │ <br> │   56599 │    2260 │    799 │ <br> │ 3271094 │    2256 │    812 │ <br> └─────────┴─────────┴────────┘ <br> %% <br>  <br> В этом примере, для каждого идентификатора цели, посчитано количество достижений целей (каждый элемент вложенной структуры данных Goals является достижением целей) и количество визитов. Если бы не было ARRAY JOIN, мы бы считали количество визитов как %%sum(Sign)%%. Но в данном случае, строчки были размножены по вложенной структуре Goals, и чтобы после это",en:"Returns an array the same size as the source array, indicating for each element what its position is among elements with the same value. <br> For example: %%arrayEnumerateUniq([10, 20, 10, 30]) = [1,  1,  2,  1]%%. <br>  <br> This function is useful when using ARRAY JOIN and aggregation of array elements. Example: <br>  <br> %% <br> SELECT <br>     Goals.ID AS GoalID, <br>     sum(Sign) AS Reaches, <br>     sumIf(Sign, num = 1) AS Visits <br> FROM test.visits <br> ARRAY JOIN <br>     Goals, <br>     arrayEnumerateUniq(Goals.ID) AS num <br> WHERE CounterID = 160656 <br> GROUP BY GoalID <br> ORDER BY Reaches DESC <br> LIMIT 10 <br>  <br> ┌──GoalID─┬─Reaches─┬─Visits─┐ <br> │   53225 │    3214 │   1097 │ <br> │ 2825062 │    3188 │   1097 │ <br> │   56600 │    2803 │    488 │ <br> │ 1989037 │    2401 │    365 │ <br> │ 2830064 │    2396 │    910 │ <br> │ 1113562 │    2372 │    373 │ <br> │ 3270895 │    2262 │    812 │ <br> │ 1084657 │    2262 │    345 │ <br> │   56599 │    2260 │    799 │ <br> │ 3271094 │    2256 │    812 │ <br> └─────────┴─────────┴────────┘ <br> %% <br>  <br> In this example, each goal ID has a calculation of the number of conversions (each element in the Goals nested data structure is a goal that was reached, which we refer to as a conversion) and the number of sessions. Without ARRAY JOIN, we would have counted the number of sessions as %%sum(Sign)%%. But in this particular case, the rows were multiplied by the"}},toDayOfMonth:{bracket:"(v)",desc:{ru:"Переводит дату или дату-с-временем в число типа UInt8, содержащее номер дня в месяце (1-31).",en:"Converts a date or date with time to a UInt8 number containing the number of the day of the month (1-31)."}},dictGetUInt64:{bracket:"(v)",desc:{ru:"%%dictGet<i>T</i>('dict_name', 'attr_name', id)%% <br> - получить из словаря dict_name значение атрибута attr_name по ключу id. <br> dict_name и attr_name - константные строки. <br> id должен иметь тип UInt64. <br> Если ключа id нет в словаре - вернуть значение по умолчанию, заданное в описании словаря.",en:'<span class="inline-example">dictGet<i>T</i>(&#39;dict_name&#39;, &#39;attr_name&#39;, id)</span> <br> - Gets the value of the &#39;attr_name&#39; attribute from the &#39;dict_name&#39; dictionary by the &#39;id&#39; key. <br> &#39;dict_name&#39; and &#39;attr_name&#39; are constant strings. <br> &#39;id&#39; must be UInt64. <br> If the &#39;id&#39; key is not in the dictionary, it returns the default value set in the dictionary definition.'}},IPv4NumToStringClassC:{bracket:"(num)",desc:{ru:"Похоже на IPv4NumToString, но вместо последнего октета используется %%xxx%%. Пример: <br>  <br> %% <br> SELECT <br>     IPv4NumToStringClassC(ClientIP) AS k, <br>     count() AS c <br> FROM test.hits <br> GROUP BY k <br> ORDER BY c DESC <br> LIMIT 10 <br>  <br> ┌─k──────────────┬─────c─┐ <br> │ 83.149.9.xxx   │ 26238 │ <br> │ 217.118.81.xxx │ 26074 │ <br> │ 213.87.129.xxx │ 25481 │ <br> │ 83.149.8.xxx   │ 24984 │ <br> │ 217.118.83.xxx │ 22797 │ <br> │ 78.25.120.xxx  │ 22354 │ <br> │ 213.87.131.xxx │ 21285 │ <br> │ 78.25.121.xxx  │ 20887 │ <br> │ 188.162.65.xxx │ 19694 │ <br> │ 83.149.48.xxx  │ 17406 │ <br> └────────────────┴───────┘ <br> %% <br>  <br> В связи с тем, что использование xxx весьма необычно, это может быть изменено в дальнейшем, и вам не следует полагаться на конкретный вид этого фрагмента.",en:"Similar to IPv4NumToString, but using %%xxx%% instead of the last octet. Example: <br>  <br> %% <br> SELECT <br>     IPv4NumToStringClassC(ClientIP) AS k, <br>     count() AS c <br> FROM test.hits <br> GROUP BY k <br> ORDER BY c DESC <br> LIMIT 10 <br>  <br> ┌─k──────────────┬─────c─┐ <br> │ 83.149.9.xxx   │ 26238 │ <br> │ 217.118.81.xxx │ 26074 │ <br> │ 213.87.129.xxx │ 25481 │ <br> │ 83.149.8.xxx   │ 24984 │ <br> │ 217.118.83.xxx │ 22797 │ <br> │ 78.25.120.xxx  │ 22354 │ <br> │ 213.87.131.xxx │ 21285 │ <br> │ 78.25.121.xxx  │ 20887 │ <br> │ 188.162.65.xxx │ 19694 │ <br> │ 83.149.48.xxx  │ 17406 │ <br> └────────────────┴───────┘ <br> %% <br>  <br> Since using &#39;xxx&#39; is highly unusual, this may be changed in the future. We recommend that you don&#39;t rely on the exact format of this fragment."}},reinterpretAsString:{bracket:"(v)",desc:{ru:"Функция принимает число или дату или дату-с-временем и возвращает строку, содержащую байты, представляющие соответствующее значение в host order (little endian). При этом, отбрасываются нулевые байты с конца. Например, значение 255 типа UInt32 будет строкой длины 1 байт.",en:"This function accepts a number or date or date with time, and returns a string containing bytes representing the corresponding value in host order (little endian). Null bytes are dropped from the end. For example, a UInt32 type value of 255 is a string that is one byte long."}},toHour:{bracket:"(v)",desc:{ru:"Переводит дату-с-временем в число типа UInt8, содержащее номер часа в сутках (0-23). <br> Функция исходит из допущения, что перевод стрелок вперёд, если осуществляется, то на час, в два часа ночи, а перевод стрелок назад, если осуществляется, то на час, в три часа ночи (что, в общем, не верно - даже в Москве два раза перевод стрелок был осуществлён в другое время).",en:"Converts a date with time to a UInt8 number containing the number of the hour in 24-hour time (0-23). <br> This function assumes that if clocks are moved ahead, it is by one hour and occurs at 2 a.m., and if clocks are moved back, it is by one hour and occurs at 3 a.m. (which is not always true - even in Moscow the clocks were once changed at a different time)."}},ignore:{bracket:"(...)",desc:{ru:"Принимает любые аргументы, всегда возвращает 0. <br> При этом, аргумент всё равно вычисляется. Это может использоваться для бенчмарков.",en:"A function that accepts any arguments and always returns 0. <br> However, the argument is still calculated. This can be used for benchmarks."}},arrayJoin:{bracket:"(v)",desc:{ru:"Это совсем необычная функция. <br>  <br> Обычные функции не изменяют множество строк, а лишь изменяют значения в каждой строке (map). <br> Агрегатные функции выполняют свёртку множества строк (fold, reduce). <br> Функция arrayJoin выполняет размножение каждой строки в множество строк (unfold). <br>  <br> Функция принимает в качестве аргумента массив, и размножает исходную строку в несколько строк - по числу элементов массива. <br> Все значения в столбцах просто копируются, кроме значения в столбце с применением этой функции - он заменяется на соответствующее значение массива. <br>  <br> В запросе может быть использовано несколько функций arrayJoin. В этом случае, соответствующее преобразование делается несколько раз. <br>  <br> Обратите внимание на синтаксис ARRAY JOIN в запросе SELECT, который предоставляет более широкие возможности. <br>  <br> Пример: <br>  <br> %% <br> :) SELECT arrayJoin([1, 2, 3] AS src) AS dst, 'Hello', src <br>  <br> SELECT <br>     arrayJoin([1, 2, 3] AS src) AS dst, <br>     'Hello', <br>     src <br>  <br> ┌─dst─┬─\\'Hello\\'─┬─src─────┐ <br> │   1 │ Hello     │ [1,2,3] │ <br> │   2 │ Hello     │ [1,2,3] │ <br> │   3 │ Hello     │ [1,2,3] │ <br> └─────┴───────────┴─────────┘ <br> %% <br>  <br> </div> <br> <div class=\"island\"> <br> <h1>Агрегатные функции</h1> <br> </div> <br> <div class=\"island content\">",en:'This is a very unusual function. <br>  <br> Normal functions don&#39;t change a set of rows, but just change the values in each row (map). Aggregate functions compress a set of rows (fold or reduce). <br> The &#39;arrayJoin&#39; function takes each row and generates a set of rows (unfold). <br>  <br> This function takes an array as an argument, and propagates the source row to multiple rows for the number of elements in the array. <br> All the values in columns are simply copied, except the values in the column where this function is applied - it is replaced with the corresponding array value. <br>  <br> A query can use multiple &#39;arrayJoin&#39; functions. In this case, the transformation is performed multiple times. <br>  <br> Note the ARRAY JOIN syntax in the SELECT query, which provides broader possibilities. <br>  <br> Example: <br>  <br> %% <br> :) SELECT arrayJoin([1, 2, 3] AS src) AS dst, &#39;Hello&#39;, src <br>  <br> SELECT <br>     arrayJoin([1, 2, 3] AS src) AS dst, <br>     &#39;Hello&#39;, <br>     src <br>  <br> ┌─dst─┬─\\&#39;Hello\\&#39;─┬─src─────┐ <br> │   1 │ Hello     │ [1,2,3] │ <br> │   2 │ Hello     │ [1,2,3] │ <br> │   3 │ Hello     │ [1,2,3] │ <br> └─────┴───────────┴─────────┘ <br> %% <br>  <br> </div> <br> <div class="island"> <br> <h1>Aggregate functions</h1> <br> </div> <br> <div class="island content">'}},length:{bracket:"(v)",desc:{ru:"Возвращает длину строки в кодовых точках Unicode (не символах), при допущении, что строка содержит набор байт, являющийся текстом в кодировке UTF-8. Если допущение не выполнено - то возвращает какой-нибудь результат (не кидает исключение). <br> Тип результата - UInt64.",en:"Returns the length of a string in Unicode code points (not in characters), assuming that the string contains a set of bytes that make up UTF-8 encoded text. If this assumption is not met, it returns some result (it doesn&#39;t throw an exception). <br> The result type is UInt64."}},tuple:{bracket:"(tuple, n), operator x.N",desc:{ru:"Функция, позволяющая достать столбец из кортежа. <br> N - индекс столбца начиная с 1. N должно быть константой. N должно быть целым строго положительным числом не большим размера кортежа. <br> Выполнение функции ничего не стоит.",en:"A function that allows getting columns from a tuple. <br> &#39;N&#39; is the column index, starting from 1. &#39;N&#39; must be a constant. &#39;N&#39; must be a strict postive integer no greater than the size of the tuple. <br> There is no cost to execute the function."}},extractURLParameterNames:{bracket:"(URL)",desc:{ru:"Возвращает массив строк вида name, соответствующих именам параметров URL. Значения никак не декодируются.",en:"- Gets an array of name=value strings corresponding to the names of URL parameters. The values are not decoded in any way."}},tupleElement:{bracket:"(tuple, n), operator x.N",desc:{ru:"Функция, позволяющая достать столбец из кортежа. <br> N - индекс столбца начиная с 1. N должно быть константой. N должно быть целым строго положительным числом не большим размера кортежа. <br> Выполнение функции ничего не стоит.",en:"A function that allows getting columns from a tuple. <br> &#39;N&#39; is the column index, starting from 1. &#39;N&#39; must be a constant. &#39;N&#39; must be a strict postive integer no greater than the size of the tuple. <br> There is no cost to execute the function."}},"in":{bracket:"(v)",desc:{ru:"Что делать, когда количество данных превысило одно из ограничений: throw или break. По умолчанию: throw.",en:"What to do when the amount of data exceeds one of the limits: &#39;throw&#39; or &#39;break&#39;. By default, throw."}},globalIn:{bracket:"(v)",desc:{ru:'Смотрите раздел "Операторы IN".',en:"See the section &quot;IN operators&quot;."}},isFinite:{bracket:"(x)",desc:{ru:"Принимает Float32 или Float64 и возвращает UInt8, равный 1, если аргумент не бесконечный и не NaN, иначе 0.",en:"Accepts Float32 and Float64 and returns UInt8 equal to 1 if the argument is not infinite and not a NaN, otherwise 0."}},isNaN:{bracket:"(x)",desc:{ru:"Принимает Float32 или Float64 и возвращает UInt8, равный 1, если аргумент является NaN, иначе 0.",en:"Accepts Float32 and Float64 and returns UInt8 equal to 1 if the argument is a NaN, otherwise 0."}},isInfinite:{bracket:"(x)",desc:{ru:"Принимает Float32 или Float64 и возвращает UInt8, равный 1, если аргумент бесконечный, иначе 0. Отметим, что в случае NaN возвращается 0.",en:"Accepts Float32 and Float64 and returns UInt8 equal to 1 if the argument is infinite, otherwise 0. <br> Note that 0 is returned for a NaN."}},transform:{bracket:"(v)",desc:{ru:"Преобразовать значение согласно явно указанному отображению одних элементов на другие. <br> Имеется два варианта функции: <br>  <br> 1. %%transform(x, array_from, array_to, default)%% <br>  <br> %%x%% - что преобразовывать. <br> %%array_from%% - константный массив значений для преобразования. <br> %%array_to%% - константный массив значений, в которые должны быть преобразованы значения из from. <br> %%default%% - какое значение использовать, если x не равен ни одному из значений во from. <br>  <br> array_from и array_to - массивы одинаковых размеров. <br>  <br> Типы: <br> <span class=\"inline-example\">transform(T, Array(T), Array(U), U) -> U</span> <br>  <br> T и U - могут быть числовыми, строковыми, или Date или DateTime типами. <br> При этом, где обозначена одна и та же буква (T или U), могут быть, в случае числовых типов, не совпадающие типы, а типы, для которых есть общий тип. <br> Например, первый аргумент может иметь тип Int64, а второй - Array(UInt16). <br>  <br> Если значение x равно одному из элементов массива array_from, то возвращает соответствующий (такой же по номеру) элемент массива array_to; иначе возвращает default. Если имеется несколько совпадающих элементов в array_from, то возвращает какой-нибудь из соответствующих. <br>  <br> Пример: <br>  <br> %% <br>  <br> SELECT <br>     transform(SearchEngineID, [2, 3], ['Яндекс', 'Google'], 'Остальные') AS title, <br>     count() AS c <br> FROM test.hits <br> WHERE Sear",en:'Transforms a value according to the explicitly defined mapping of some elements to other ones. <br> There are two variations of this function: <br>  <br> 1. %%transform(x, array_from, array_to, default)%% <br>  <br> %%x%% - What to transform. <br> %%array_from%% - Constant array of values for converting. <br> %%array_to%% - Constant array of values to convert the values in &#39;from&#39; to. <br> %%default%% - Constant. Which value to use if &#39;x&#39; is not equal to one of the values in &#39;from&#39;. <br>  <br> &#39;array_from&#39; and &#39;array_to&#39; are arrays of the same size. <br>  <br> Types: <br> <span class="inline-example">transform(T, Array(T), Array(U), U) -> U</span> <br>  <br> &#39;T&#39; and &#39;U&#39; can be numeric, string, or Date or DateTime types. <br> Where the same letter is indicated (T or U), for numeric types these might not be matching types, but types that have a common type. <br> For example, the first argument can have the Int64 type, while the second has the Array(Uint16) type. <br>  <br> If the &#39;x&#39; value is equal to one of the elements in the &#39;array_from&#39; array, it returns the existing element (that is numbered the same) from the &#39;array_to&#39; array. Otherwise, it returns &#39;default&#39;. If there are multiple matching elements in &#39;array_from&#39;, it returns one of the matches. <br>  <br> Example: <br>  <br> %% <br>  <br> SELECT <br>     transform(SearchEngineID'
}},rand:{bracket:"(v)",desc:{ru:"Возвращает псевдослучайное число типа UInt64, равномерно распределённое среди всех чисел типа UInt64. <br> Используется linear congruential generator.",en:"Returns a pseudo-random UInt64 number, evenly distributed among all UInt64-type numbers. <br> Uses a linear congruential generator."}},reinterpretAsUInt16:{bracket:"(v)",desc:{ru:"Функции принимают строку и интерпретируют байты, расположенные в начале строки, как число в host order (little endian). Если строка имеет недостаточную длину, то функции работают так, как будто строка дополнена необходимым количеством нулевых байт. Если строка длиннее, чем нужно, то лишние байты игнорируются. Дата интерпретируется, как число дней с начала unix-эпохи, а дата-с-временем - как число секунд с начала unix-эпохи.",en:"These functions accept a string and interpret the bytes placed at the beginning of the string as a number in host order (little endian). If the string isn&#39;t long enough, the functions work as if the string is padded with the necessary number of null bytes. If the string is longer than needed, the extra bytes are ignored. A date is interpreted as the number of days since the beginning of the Unix Epoch, and a date with time is interpreted as the number of seconds since the beginning of the Unix Epoch."}},pi:{bracket:"(v)",desc:{ru:"Максимальная глубина конвейера выполнения запроса. Соответствует количеству преобразований, которое проходит каждый блок данных в процессе выполнения запроса. Считается в пределах одного сервера. Если глубина конвейера больше - кидается исключение. По умолчанию: 1000.",en:"Maximum pipeline depth. Corresponds to the number of transformations that each data block goes through during query processing. Counted within the limits of a single server. If the pipeline depth is greater, an exception is thrown. By default, 1000."}},reinterpretAsUInt32:{bracket:"(v)",desc:{ru:"Функции принимают строку и интерпретируют байты, расположенные в начале строки, как число в host order (little endian). Если строка имеет недостаточную длину, то функции работают так, как будто строка дополнена необходимым количеством нулевых байт. Если строка длиннее, чем нужно, то лишние байты игнорируются. Дата интерпретируется, как число дней с начала unix-эпохи, а дата-с-временем - как число секунд с начала unix-эпохи.",en:"These functions accept a string and interpret the bytes placed at the beginning of the string as a number in host order (little endian). If the string isn&#39;t long enough, the functions work as if the string is padded with the necessary number of null bytes. If the string is longer than needed, the extra bytes are ignored. A date is interpreted as the number of days since the beginning of the Unix Epoch, and a date with time is interpreted as the number of seconds since the beginning of the Unix Epoch."}},reinterpretAsUInt64:{bracket:"(v)",desc:{ru:"Функции принимают строку и интерпретируют байты, расположенные в начале строки, как число в host order (little endian). Если строка имеет недостаточную длину, то функции работают так, как будто строка дополнена необходимым количеством нулевых байт. Если строка длиннее, чем нужно, то лишние байты игнорируются. Дата интерпретируется, как число дней с начала unix-эпохи, а дата-с-временем - как число секунд с начала unix-эпохи.",en:"These functions accept a string and interpret the bytes placed at the beginning of the string as a number in host order (little endian). If the string isn&#39;t long enough, the functions work as if the string is padded with the necessary number of null bytes. If the string is longer than needed, the extra bytes are ignored. A date is interpreted as the number of days since the beginning of the Unix Epoch, and a date with time is interpreted as the number of seconds since the beginning of the Unix Epoch."}},reinterpretAsInt8:{bracket:"(v)",desc:{ru:"Функции принимают строку и интерпретируют байты, расположенные в начале строки, как число в host order (little endian). Если строка имеет недостаточную длину, то функции работают так, как будто строка дополнена необходимым количеством нулевых байт. Если строка длиннее, чем нужно, то лишние байты игнорируются. Дата интерпретируется, как число дней с начала unix-эпохи, а дата-с-временем - как число секунд с начала unix-эпохи.",en:"These functions accept a string and interpret the bytes placed at the beginning of the string as a number in host order (little endian). If the string isn&#39;t long enough, the functions work as if the string is padded with the necessary number of null bytes. If the string is longer than needed, the extra bytes are ignored. A date is interpreted as the number of days since the beginning of the Unix Epoch, and a date with time is interpreted as the number of seconds since the beginning of the Unix Epoch."}},upperUTF8:{bracket:"(v)",desc:{ru:"Переводит строку в верхний регистр, при допущении, что строка содержит набор байт, представляющий текст в кодировке UTF-8. <br> Не учитывает язык. То есть, для турецкого языка, результат может быть не совсем верным. <br> Если длина UTF-8 последовательности байт различна для верхнего и нижнего регистра кодовой точки, то для этой кодовой точки, результат работы может быть некорректным. <br> Если строка содержит набор байт, не являющийся UTF-8, то поведение не определено.",en:"Converts a string to uppercase, assuming the string contains a set of bytes that make up a UTF-8 encoded text. It doesn&#39;t detect the language. So for Turkish the result might not be exactly correct. <br> If length of UTF-8 sequence is different for upper and lower case of code point, then result for that code point could be incorrect. <br> If value contains invalid UTF-8, the behavior is unspecified."}},reinterpretAsInt32:{bracket:"(v)",desc:{ru:"Функции принимают строку и интерпретируют байты, расположенные в начале строки, как число в host order (little endian). Если строка имеет недостаточную длину, то функции работают так, как будто строка дополнена необходимым количеством нулевых байт. Если строка длиннее, чем нужно, то лишние байты игнорируются. Дата интерпретируется, как число дней с начала unix-эпохи, а дата-с-временем - как число секунд с начала unix-эпохи.",en:"These functions accept a string and interpret the bytes placed at the beginning of the string as a number in host order (little endian). If the string isn&#39;t long enough, the functions work as if the string is padded with the necessary number of null bytes. If the string is longer than needed, the extra bytes are ignored. A date is interpreted as the number of days since the beginning of the Unix Epoch, and a date with time is interpreted as the number of seconds since the beginning of the Unix Epoch."}},reinterpretAsFloat32:{bracket:"(v)",desc:{ru:"Функции принимают строку и интерпретируют байты, расположенные в начале строки, как число в host order (little endian). Если строка имеет недостаточную длину, то функции работают так, как будто строка дополнена необходимым количеством нулевых байт. Если строка длиннее, чем нужно, то лишние байты игнорируются. Дата интерпретируется, как число дней с начала unix-эпохи, а дата-с-временем - как число секунд с начала unix-эпохи.",en:"These functions accept a string and interpret the bytes placed at the beginning of the string as a number in host order (little endian). If the string isn&#39;t long enough, the functions work as if the string is padded with the necessary number of null bytes. If the string is longer than needed, the extra bytes are ignored. A date is interpreted as the number of days since the beginning of the Unix Epoch, and a date with time is interpreted as the number of seconds since the beginning of the Unix Epoch."}},reinterpretAsFloat64:{bracket:"(v)",desc:{ru:"Функции принимают строку и интерпретируют байты, расположенные в начале строки, как число в host order (little endian). Если строка имеет недостаточную длину, то функции работают так, как будто строка дополнена необходимым количеством нулевых байт. Если строка длиннее, чем нужно, то лишние байты игнорируются. Дата интерпретируется, как число дней с начала unix-эпохи, а дата-с-временем - как число секунд с начала unix-эпохи.",en:"These functions accept a string and interpret the bytes placed at the beginning of the string as a number in host order (little endian). If the string isn&#39;t long enough, the functions work as if the string is padded with the necessary number of null bytes. If the string is longer than needed, the extra bytes are ignored. A date is interpreted as the number of days since the beginning of the Unix Epoch, and a date with time is interpreted as the number of seconds since the beginning of the Unix Epoch."}},reinterpretAsDate:{bracket:"(v)",desc:{ru:"Функции принимают строку и интерпретируют байты, расположенные в начале строки, как число в host order (little endian). Если строка имеет недостаточную длину, то функции работают так, как будто строка дополнена необходимым количеством нулевых байт. Если строка длиннее, чем нужно, то лишние байты игнорируются. Дата интерпретируется, как число дней с начала unix-эпохи, а дата-с-временем - как число секунд с начала unix-эпохи.",en:"These functions accept a string and interpret the bytes placed at the beginning of the string as a number in host order (little endian). If the string isn&#39;t long enough, the functions work as if the string is padded with the necessary number of null bytes. If the string is longer than needed, the extra bytes are ignored. A date is interpreted as the number of days since the beginning of the Unix Epoch, and a date with time is interpreted as the number of seconds since the beginning of the Unix Epoch."}},reinterpretAsDateTime:{bracket:"(v)",desc:{ru:"Функции принимают строку и интерпретируют байты, расположенные в начале строки, как число в host order (little endian). Если строка имеет недостаточную длину, то функции работают так, как будто строка дополнена необходимым количеством нулевых байт. Если строка длиннее, чем нужно, то лишние байты игнорируются. Дата интерпретируется, как число дней с начала unix-эпохи, а дата-с-временем - как число секунд с начала unix-эпохи.",en:"These functions accept a string and interpret the bytes placed at the beginning of the string as a number in host order (little endian). If the string isn&#39;t long enough, the functions work as if the string is padded with the necessary number of null bytes. If the string is longer than needed, the extra bytes are ignored. A date is interpreted as the number of days since the beginning of the Unix Epoch, and a date with time is interpreted as the number of seconds since the beginning of the Unix Epoch."}},roundToExp2:{bracket:"(num)",desc:{ru:"Принимает число. Если число меньше единицы - возвращает 0. Иначе округляет число вниз до ближайшей (целой неотрицательной) степени двух.",en:"Accepts a number. If the number is less than one, it returns 0. Otherwise, it rounds the number down to the nearest (whole non-negative) degree of two."}},upper:{bracket:"(v)",desc:{ru:"Переводит строку в верхний регистр, при допущении, что строка содержит набор байт, представляющий текст в кодировке UTF-8. <br> Не учитывает язык. То есть, для турецкого языка, результат может быть не совсем верным. <br> Если длина UTF-8 последовательности байт различна для верхнего и нижнего регистра кодовой точки, то для этой кодовой точки, результат работы может быть некорректным. <br> Если строка содержит набор байт, не являющийся UTF-8, то поведение не определено.",en:"Converts a string to uppercase, assuming the string contains a set of bytes that make up a UTF-8 encoded text. It doesn&#39;t detect the language. So for Turkish the result might not be exactly correct. <br> If length of UTF-8 sequence is different for upper and lower case of code point, then result for that code point could be incorrect. <br> If value contains invalid UTF-8, the behavior is unspecified."}},positionUTF8:{bracket:"(haystack, needle)",desc:{ru:"Так же, как position, но позиция возвращается в кодовых точках Unicode. Работает при допущении, что строка содержит набор байт, представляющий текст в кодировке UTF-8. Если допущение не выполнено - то возвращает какой-нибудь результат (не кидает исключение). <br> Есть также функция positionCaseInsensitiveUTF8.",en:"The same as &#39;position&#39;, but the position is returned in Unicode code points. Works under the assumption that the string contains a set of bytes representing a UTF-8 encoded text. If this assumption is not met, it returns some result (it doesn&#39;t throw an exception). <br> There's also positionCaseInsensitiveUTF8 function."}},roundDuration:{bracket:"(num)",desc:{ru:"Принимает число. Если число меньше единицы - возвращает 0. Иначе округляет число вниз до чисел из набора: 1, 10, 30, 60, 120, 180, 240, 300, 600, 1200, 1800, 3600, 7200, 18000, 36000. Эта функция специфична для Яндекс.Метрики и предназначена для реализации отчёта по длительности визита.",en:"Accepts a number. If the number is less than one, it returns 0. Otherwise, it rounds the number down to numbers from the set: 1, 10, 30, 60, 120, 180, 240, 300, 600, 1200, 1800, 3600, 7200, 18000, 36000. This function is specific to Yandex.Metrica and used for implementing the report on session length."}},roundAge:{bracket:"(num)",desc:{ru:"Принимает число. Если число меньше 18 - возвращает 0. Иначе округляет число вниз до чисел из набора: 18, 25, 35, 45. Эта функция специфична для Яндекс.Метрики и предназначена для реализации отчёта по возрасту посетителей.",en:"Accepts a number. If the number is less than 18, it returns 0. Otherwise, it rounds the number down to numbers from the set: 18, 25, 35, 45. This function is specific to Yandex.Metrica and used for implementing the report on user age."}},round:{bracket:"(num)",desc:{ru:"Принимает число. Если число меньше 18 - возвращает 0. Иначе округляет число вниз до чисел из набора: 18, 25, 35, 45. Эта функция специфична для Яндекс.Метрики и предназначена для реализации отчёта по возрасту посетителей.",en:"Accepts a number. If the number is less than 18, it returns 0. Otherwise, it rounds the number down to numbers from the set: 18, 25, 35, 45. This function is specific to Yandex.Metrica and used for implementing the report on user age."}},floor:{bracket:"(x[, N])",desc:{ru:'Возвращает наибольшее круглое число, которое меньше или равно, чем x. <br> Круглым называется число, кратное <span class="inline-example">1 / 10<sup>N</sup></span> или ближайшее к нему число соответствующего типа данных, если <span class="inline-example">1 / 10<sup>N</sup></span> не представимо точно. <br> N - целочисленная константа, не обязательный параметр. По умолчанию - ноль, что означает - округлять до целого числа. <br> N может быть отрицательным. <br> Примеры: %%floor(123.45, 1) = 123.4%%, %%floor(123.45, -1) = 120%%. <br> x - любой числовой тип. Результат - число того же типа. <br> Для целочисленных аргументов имеет смысл округление с отрицательным значением N (для неотрицательных N, функция ничего не делает). <br> В случае переполнения при округлении (например, %%floor(-128, -1)%%), возвращается implementation specific результат.',en:'Returns a rounder number that is less than or equal to &#39;x&#39;. <br> A round number is a multiple of <span class="inline-example">1 / 10<sup>N</sup></span>, or the nearest number of the appropriate data type if <span class="inline-example">1 / 10<sup>N</sup></span> isn&#39;t exact. <br> &#39;N&#39; is an integer constant, optional parameter. By default it is zero, which means to round to an integer. <br> &#39;N&#39; may be negative. <br> Examples: %%floor(123.45, 1) = 123.4%%, %%floor(123.45, -1) = 120%%. <br> &#39;x&#39; is any numeric type. The result is a number of the same type. <br> For integer arguments, it makes sense to round with a negative &#39;N&#39; value (for non-negative &#39;N&#39;, the function doesn&#39;t do anything). <br> If rounding causes overflow (for example, %%floor(-128, -1)%%), an implementation-specific result is returned.'}},notEmpty:{bracket:"(v)",desc:{ru:"Возвращает 0 для пустого массива, и 1 для непустого массива. <br> Тип результата - UInt8. <br> Функция также работает для строк.",en:"Returns 0 for an empty array, or 1 for a non-empty array. <br> The result type is UInt8. <br> The function also works for strings."}},lengthUTF8:{bracket:"(v)",desc:{ru:"Возвращает длину строки в кодовых точках Unicode (не символах), при допущении, что строка содержит набор байт, являющийся текстом в кодировке UTF-8. Если допущение не выполнено - то возвращает какой-нибудь результат (не кидает исключение). <br> Тип результата - UInt64.",en:"Returns the length of a string in Unicode code points (not in characters), assuming that the string contains a set of bytes that make up UTF-8 encoded text. If this assumption is not met, it returns some result (it doesn&#39;t throw an exception). <br> The result type is UInt64."}},lower:{bracket:"(v)",desc:{ru:"Переводит строку в нижний регистр, при допущении, что строка содержит набор байт, представляющий текст в кодировке UTF-8. <br> Не учитывает язык. То есть, для турецкого языка, результат может быть не совсем верным. <br> Если длина UTF-8 последовательности байт различна для верхнего и нижнего регистра кодовой точки, то для этой кодовой точки, результат работы может быть некорректным. <br> Если строка содержит набор байт, не являющийся UTF-8, то поведение не определено.",en:"Converts a string to lowercase, assuming the string contains a set of bytes that make up a UTF-8 encoded text. It doesn&#39;t detect the language. So for Turkish the result might not be exactly correct. <br> If length of UTF-8 sequence is different for upper and lower case of code point, then result for that code point could be incorrect. <br> If value contains invalid UTF-8, the behavior is unspecified."}},lowerUTF8:{bracket:"(v)",desc:{ru:"Переводит строку в нижний регистр, при допущении, что строка содержит набор байт, представляющий текст в кодировке UTF-8. <br> Не учитывает язык. То есть, для турецкого языка, результат может быть не совсем верным. <br> Если длина UTF-8 последовательности байт различна для верхнего и нижнего регистра кодовой точки, то для этой кодовой точки, результат работы может быть некорректным. <br> Если строка содержит набор байт, не являющийся UTF-8, то поведение не определено.",en:"Converts a string to lowercase, assuming the string contains a set of bytes that make up a UTF-8 encoded text. It doesn&#39;t detect the language. So for Turkish the result might not be exactly correct. <br> If length of UTF-8 sequence is different for upper and lower case of code point, then result for that code point could be incorrect. <br> If value contains invalid UTF-8, the behavior is unspecified."}},reverse:{bracket:"(v)",desc:{ru:"Разворачивает последовательность кодовых точек Unicode, при допущении, что строка содержит набор байт, представляющий текст в кодировке UTF-8. Иначе - что-то делает (не кидает исключение).",en:"Reverses a sequence of Unicode code points, assuming that the string contains a set of bytes representing a UTF-8 text. Otherwise, it does something else (it doesn&#39;t throw an exception)."}},URLPathHierarchy:{bracket:"(URL)",desc:{ru:"То же самое, но без протокола и хоста в результате. Элемент / (корень) не включается. Пример: <br>  <br> Функция используется для реализации древовидных отчётов по URL в Яндекс.Метрике. <br>  <br> %% <br> URLPathHierarchy('https://example.com/browse/CONV-6788') = <br> [ <br>     '/browse/', <br>     '/browse/CONV-6788' <br> ] <br> %%",en:"- The same thing, but without the protocol and host in the result. The / element (root) is not included. Example: <br>  <br> This function is used for implementing tree-view reports by URL in Yandex.Metrica. <br>  <br> %% <br> URLPathHierarchy(&#39;https://example.com/browse/CONV-6788&#39;) = <br> [ <br>     &#39;/browse/&#39;, <br>     &#39;/browse/CONV-6788&#39; <br> ] <br> %%"}},substringUTF8:{bracket:"(s, offset, length)",desc:{ru:"Так же, как substring, но для кодовых точек Unicode. Работает при допущении, что строка содержит набор байт, представляющий текст в кодировке UTF-8. Если допущение не выполнено - то возвращает какой-нибудь результат (не кидает исключение).",en:"The same as &#39;substring&#39;, but for Unicode code points. Works under the assumption that the string contains a set of bytes representing a UTF-8 encoded text. If this assumption is not met, it returns some result (it doesn&#39;t throw an exception)."}},appendTrailingCharIfAbsent:{bracket:"(s, c)",desc:{ru:"Если строка %%s%% непустая и не содержит символ %%c%% на конце, то добавляет символ %%c%% в конец.",en:"If the %%s%% string is non-empty and does not contain the %%c%% character at the end, it appends the %%c%% character to the end."}},alphaTokens:{bracket:"(s)",desc:{ru:"Выделяет подстроки из подряд идущих байт из диапазонов a-z и A-Z. <br> Возвращается массив выделенных подстрок.",en:"Selects substrings of consecutive bytes from the range a-z and A-Z. <br> Returns an array of selected substrings."}},splitByChar:{bracket:"(separator, s)",desc:{ru:"Разбивает строку на подстроки, используя в качестве разделителя separator. <br> separator должен быть константной строкой из ровно одного символа. <br> Возвращается массив выделенных подстрок. Могут выделяться пустые подстроки, если разделитель идёт в начале или в конце строки, или если идёт более одного разделителя подряд.",en:"Splits a string into substrings, using &#39;separator&#39; as the separator. <br> &#39;separator&#39; must be a string constant consisting of exactly one character. <br> Returns an array of selected substrings. Empty substrings may be selected if the separator occurs at the beginning or end of the string, or if there are multiple consecutive separators."}},arrayStringConcat:{bracket:"(arr[, separator])",desc:{ru:"Склеивает строки, перечисленные в массиве, с разделителем separator. <br> separator - необязательный параметр, константная строка, по умолчанию равен пустой строке. <br> Возвращается строка.",en:"Concatenates strings from the array elements, using &#39;separator&#39; as the separator. <br> &#39;separator&#39; is a string constant, an optional parameter. By default it is an empty string. <br> Returns a string."}},replaceAll:{bracket:"(haystack, pattern, replacement)",desc:{ru:"Замена всех вхождений подстроки pattern в haystack на подстроку replacement.",en:"Replaces all occurrences of the &#39;pattern&#39; substring in &#39;haystack&#39; with the &#39;replacement&#39; substring."}},replaceRegexpOne:{bracket:"(haystack, pattern, replacement)",desc:{ru:"Замена по регулярному выражению pattern. Регулярное выражение re2. <br> Заменяется только первое вхождение, если есть. <br> В качестве replacement может быть указан шаблон для замен. Этот шаблон может включать в себя подстановки \\0-\\9. <br> Подстановка \\0 - вхождение регулярного выражения целиком. Подстановки \\1-\\9 - соответствующие по номеру subpattern-ы. <br> Для указания символа \\ в шаблоне, он должен быть экранирован с помощью символа \\. <br> Также помните о том, что строковый литерал требует ещё одно экранирование. <br>  <br> Пример 1. Переведём дату в американский формат: <br>  <br> %% <br> SELECT DISTINCT <br>     EventDate, <br>     replaceRegexpOne(toString(EventDate), '(\\\\d{4})-(\\\\d{2})-(\\\\d{2})', '\\\\2/\\\\3/\\\\1') AS res <br> FROM test.hits <br> LIMIT 7 <br> FORMAT TabSeparated <br>  <br> 2014-03-17      03/17/2014 <br> 2014-03-18      03/18/2014 <br> 2014-03-19      03/19/2014 <br> 2014-03-20      03/20/2014 <br> 2014-03-21      03/21/2014 <br> 2014-03-22      03/22/2014 <br> 2014-03-23      03/23/2014 <br> %% <br>  <br> Пример 2. Размножить строку десять раз: <br>  <br> %% <br> SELECT replaceRegexpOne('Hello, World!', '.*', '\\\\0\\\\0\\\\0\\\\0\\\\0\\\\0\\\\0\\\\0\\\\0\\\\0') AS res <br>  <br> ┌─res────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐ <br> │ Hello, World!Hello, World!Hello, World!Hello, World!Hello, World!Hello, World!Hello, World!Hello, World!",en:"Replacement using the &#39;pattern&#39; regular expression. A re2 regular expression. Replaces only the first occurrence, if it exists. <br> A pattern can be specified as &#39;replacement&#39;. This pattern can include substitutions \\0-\\9\\. <br> The substitution \\0 includes the entire regular expression. <br> The substitutions \\1-\\9 include the subpattern corresponding to the number. <br> In order to specify the \\ symbol in a pattern, you must use a \\ symbol to escape it. <br> Also keep in mind that a string literal requires an extra escape. <br>  <br> Example 1. Converting the date to American format: <br>  <br> %% <br> SELECT DISTINCT <br>     EventDate, <br>     replaceRegexpOne(toString(EventDate), &#39;(\\\\d{4})-(\\\\d{2})-(\\\\d{2})&#39;, &#39;\\\\2/\\\\3/\\\\1&#39;) AS res <br> FROM test.hits <br> LIMIT 7 <br> FORMAT TabSeparated <br>  <br> 2014-03-17      03/17/2014 <br> 2014-03-18      03/18/2014 <br> 2014-03-19      03/19/2014 <br> 2014-03-20      03/20/2014 <br> 2014-03-21      03/21/2014 <br> 2014-03-22      03/22/2014 <br> 2014-03-23      03/23/2014 <br> %% <br>  <br> Example 2. Copy the string ten times: <br>  <br> %% <br> SELECT replaceRegexpOne(&#39;Hello, World!&#39;, &#39;.*&#39;, &#39;\\\\0\\\\0\\\\0\\\\0\\\\0\\\\0\\\\0\\\\0\\\\0\\\\0&#39;) AS res <br>  <br> ┌─res────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐ <br> │ Hello, World!Hello, World!Hello, World!He"}},cbrt:{bracket:"(x)",desc:{ru:"Принимает числовой аргумент, возвращает число типа Float64, близкое к кубическому корню от аргумента.",en:"Accepts a numeric argument and returns a Float64 number close to the cubic root of the argument."}},match:{bracket:"(pattern)(time, cond1, cond2, ...)",desc:{ru:"Сопоставление с образцом для цепочки событий. <br>  <br> pattern - строка, содержащая шаблон для сопоставления. Шаблон похож на регулярное выражение. <br> time - время события, тип DateTime <br> cond1, cond2 ... - от одного до 32 аргументов типа UInt8 - признаков, было ли выполнено некоторое условие для события. <br>  <br> Функция собирает в оперативке последовательность событий. Затем производит проверку на соответствие этой последовательности шаблону. <br> Возвращает UInt8 - 0, если шаблон не подходит и 1, если шаблон подходит. <br>  <br> Пример: %%sequenceMatch('(?1).*(?2)')(EventTime, URL LIKE '%company%', URL LIKE '%cart%')%% <br> - была ли цепочка событий, в которой посещение страницы с адресом, содержащим %%company%% было раньше по времени посещения страницы с адресом, содержащим %%cart%%. <br>  <br> Это вырожденный пример. Его можно записать с помощью других агрегатных функций: <br> %%minIf(EventTime, URL LIKE '%company%') &lt; maxIf(EventTime, URL LIKE '%cart%')%%. <br> Но в более сложных случаях, такого решения нет. <br>  <br> Синтаксис шаблонов: <br> %%(?1)%% - ссылка на условие (вместо 1 - любой номер); <br> %%.*%% - произвольное количество любых событий; <br> %%(?t&gt;=1800)%% - условие на время; <br> за указанное время допускается любое количество любых событий; <br> вместо >= могут использоваться операторы &lt;, &gt;, &lt;=; <br> вместо 1800 может быть любое число; <br>  <br> События, произошедшие в одну секунду",en:'Pattern matching for event chains. <br>  <br> &#39;pattern&#39; is a string containing a pattern to match. The pattern is similar to a regular expression. <br> &#39;time&#39; is the event time of the DateTime type. <br> &#39;cond1, cond2 ...&#39; are from one to 32 arguments of the UInt8 type that indicate whether an event condition was met. <br>  <br> The function collects a sequence of events in RAM. Then it checks whether this sequence matches the pattern. <br> It returns UInt8 - 0 if the pattern isn&#39;t matched, or 1 if it matches. <br>  <br> Example: %%sequenceMatch(&#39;(?1).*(?2)&#39;)(EventTime, URL LIKE &#39;%company%&#39;, URL LIKE &#39;%cart%&#39;)%% <br> - whether there was a chain of events in which pages with the address in %%company%% were visited earlier than pages with the address in %%cart%%. <br>  <br> This is a degenerate example. You could write it using other aggregate functions: <br> %%minIf(EventTime, URL LIKE &#39;%company%&#39;) &lt; maxIf(EventTime, URL LIKE &#39;%cart%&#39;)%%. <br> However, there is no such solution for more complex situations. <br>  <br> Pattern syntax: <br> %%(?1)%% - Reference to a condition (any number in place of 1). <br> %%.*%% - Any number of events. <br> <span class="inline-example">(?t>=1800)</span> - Time condition. <br> Any quantity of any type of events is allowed over the specified time. <br> The operators &lt;, >, &lt;= may be used instead of  >=. <br> Any number ma'}},cutURLParameter:{bracket:"(URL, name)",desc:{ru:"Удаляет параметр URL с именем name, если такой есть. Функция работает при допущении, что имя параметра закодировано в URL в точности таким же образом, что и в переданном аргументе.",en:"Removes the URL parameter named &#39;name&#39;, if present. This function works under the assumption that the parameter name is encoded in the URL exactly the same way as in the passed argument."}},like:{bracket:"(haystack, pattern), haystack NOT LIKE pattern operator",desc:{ru:"То же, что like, но с отрицанием.",en:"The same thing as &#39;like&#39;, but negative."}},domain:{bracket:"(v)",desc:{ru:"Возвращает часть домена, включающую поддомены верхнего уровня до \"первого существенного поддомена\" (см. выше). <br> Например, cutToFirstSignificantSubdomain('https://news.yandex.com.tr/') = 'yandex.com.tr'.",en:"- Selects the part of the domain that includes top-level subdomains up to the &quot;first significant subdomain&quot; (see the explanation above). <br> For example, cutToFirstSignificantSubdomain(&#39;https://news.yandex.com.tr/&#39;) = &#39;yandex.com.tr&#39;."}},domainWithoutWWW:{bracket:"(v)",desc:{ru:"Возвращает домен, удалив не более одного 'www.' с начала, если есть.",en:"- Selects the domain and removes no more than one &#39;www.&#39; from the beginning of it, if present."}},firstSignificantSubdomain:{bracket:"(v)",desc:{ru:"Возвращает часть домена, включающую поддомены верхнего уровня до \"первого существенного поддомена\" (см. выше). <br> Например, cutToFirstSignificantSubdomain('https://news.yandex.com.tr/') = 'yandex.com.tr'.",en:"- Selects the part of the domain that includes top-level subdomains up to the &quot;first significant subdomain&quot; (see the explanation above). <br> For example, cutToFirstSignificantSubdomain(&#39;https://news.yandex.com.tr/&#39;) = &#39;yandex.com.tr&#39;."}},queryString:{bracket:"(v)",desc:{ru:"Удаляет query string и fragment identifier. Знак вопроса и символ решётки тоже удаляются.",en:"Removes the query-string and fragment identifier. The question mark and number sign are also removed."}},queryStringAndFragment:{bracket:"(v)",desc:{ru:"Удаляет query string и fragment identifier. Знак вопроса и символ решётки тоже удаляются.",en:"Removes the query-string and fragment identifier. The question mark and number sign are also removed."}},extractURLParameter:{bracket:"(URL)",desc:{ru:"Возвращает массив строк вида name, соответствующих именам параметров URL. Значения никак не декодируются.",en:"- Gets an array of name=value strings corresponding to the names of URL parameters. The values are not decoded in any way."}},URLHierarchy:{bracket:"(URL)",desc:{ru:"Возвращает массив, содержащий URL, обрезанный с конца по символам %%/%%, %%?%% в пути и query-string. Подряд идущие символы-разделители считаются за один. Резка производится в позиции после всех подряд идущих символов-разделителей. Пример:",en:"- Gets an array containing the URL trimmed to the %%/%%, %%?%% characters in the path and query-string.  Consecutive separator characters are counted as one. The cut is made in the position after all the consecutive separator characters. Example:"
}},cutToFirstSignificantSubdomain:{bracket:"(v)",desc:{ru:"Возвращает часть домена, включающую поддомены верхнего уровня до \"первого существенного поддомена\" (см. выше). <br> Например, cutToFirstSignificantSubdomain('https://news.yandex.com.tr/') = 'yandex.com.tr'.",en:"- Selects the part of the domain that includes top-level subdomains up to the &quot;first significant subdomain&quot; (see the explanation above). <br> For example, cutToFirstSignificantSubdomain(&#39;https://news.yandex.com.tr/&#39;) = &#39;yandex.com.tr&#39;."}},cutWWW:{bracket:"(v)",desc:{ru:"Удаляет не более одного 'www.' с начала домена URL-а, если есть.",en:"Removes no more than one &#39;www.&#39; from the beginning of the URL&#39;s domain, if present."}},cutQueryString:{bracket:"(v)",desc:{ru:"Удаляет query string и fragment identifier. Знак вопроса и символ решётки тоже удаляются.",en:"Removes the query-string and fragment identifier. The question mark and number sign are also removed."}},cutFragment:{bracket:"(v)",desc:{ru:"Удаляет fragment identifier. Символ решётки тоже удаляется.",en:"Removes the fragment identifier. The number sign is also removed."}},visitParamHas:{bracket:"(params, name)",desc:{ru:"Проверить наличие поля с именем name.",en:"Checks whether there is a field with the &#39;name&#39; name."}},visitParamExtractFloat:{bracket:"(params, name)",desc:{ru:"Аналогично для Float64.",en:"The same as for Float64."}},visitParamExtractBool:{bracket:"(params, name)",desc:{ru:"Распарсить значение true/false. Результат - UInt8.",en:"Parses a true/false value. The result is UInt8."}},visitParamExtractRaw:{bracket:"(params, name)",desc:{ru:"Вернуть значение поля, включая разделители. Примеры: <br> %%visitParamExtractRaw('{\"abc\":\"\\\\n\\\\u0000\"}', 'abc') = '\"\\\\n\\\\u0000\"'%% <br> %%visitParamExtractRaw('{\"abc\":{\"def\":[1,2,3]}}', 'abc') = '{\"def\":[1,2,3]}'%%",en:"Returns the value of a field, including separators. Examples: <br> %%visitParamExtractRaw(&#39;{&quot;abc&quot;:&quot;\\\\n\\\\u0000&quot;}&#39;, &#39;abc&#39;) = &#39;&quot;\\\\n\\\\u0000&quot;&#39;%% <br> %%visitParamExtractRaw(&#39;{&quot;abc&quot;:{&quot;def&quot;:[1,2,3]}}&#39;, &#39;abc&#39;) = &#39;{&quot;def&quot;:[1,2,3]}&#39;%%"}},exp:{bracket:"(x)",desc:{ru:"Принимает числовой аргумент, возвращает число типа Float64, близкое к 10<sup>x</sup>.",en:"Accepts a numeric argument and returns a Float64 number close to 10<sup>x</sup>."}},exp2:{bracket:"(x)",desc:{ru:"Принимает числовой аргумент, возвращает число типа Float64, близкое к 2<sup>x</sup>.",en:"Accepts a numeric argument and returns a Float64 number close to 2<sup>x</sup>."}},exp10:{bracket:"(x)",desc:{ru:"Принимает числовой аргумент, возвращает число типа Float64, близкое к 10<sup>x</sup>.",en:"Accepts a numeric argument and returns a Float64 number close to 10<sup>x</sup>."}},tgamma:{bracket:"(x)",desc:{ru:"Гамма функция.",en:"Gamma function."}},log10:{bracket:"(x)",desc:{ru:"Принимает числовой аргумент, возвращает число типа Float64, близкое к десятичному логарифму от аргумента.",en:"Accepts a numeric argument and returns a Float64 number close to the decimal logarithm of the argument."}},sqrt:{bracket:"(x)",desc:{ru:"Принимает числовой аргумент, возвращает число типа Float64, близкое к квадратному корню от аргумента.",en:"Accepts a numeric argument and returns a Float64 number close to the square root of the argument."}},erf:{bracket:"(v)",desc:{ru:"Что делать, когда количество данных превысило одно из ограничений: throw или break. По умолчанию: throw.",en:"What to do when the amount of data exceeds one of the limits: &#39;throw&#39; or &#39;break&#39;. By default, throw."}},erfc:{bracket:"(x)",desc:{ru:"Принимает числовой аргумент, возвращает число типа Float64, близкое к 1 - erf(x), но без потери точности для больших x.",en:"Accepts a numeric argument and returns a Float64 number close to 1 - erf(x), but without loss of precision for large &#39;x&#39; values."}},lgamma:{bracket:"(x)",desc:{ru:"Логарифм от гамма функции.",en:"The logarithm of the gamma function."}},sin:{bracket:"(x)",desc:{ru:"Принимает Float32 или Float64 и возвращает UInt8, равный 1, если аргумент бесконечный, иначе 0. Отметим, что в случае NaN возвращается 0.",en:"Accepts Float32 and Float64 and returns UInt8 equal to 1 if the argument is infinite, otherwise 0. <br> Note that 0 is returned for a NaN."}},cos:{bracket:"(x)",desc:{ru:"Арккосинус.",en:"The arc cosine."}},tan:{bracket:"(x)",desc:{ru:"Арктангенс.",en:"The arc tangent."}},pow:{bracket:"(x, y)",desc:{ru:"x<sup>y</sup>.",en:"x<sup>y</sup>."}}}},/*
 * Licensed under the Apache License, Version 2.0 Copyright 2017 Igor Strykhar,Ivan Kudinov,SMI2 LLC and other contributors
 */
function(){angular.module(smi2.app.name).run(["$rootScope","$state",function(e,t){e.breadcrumbs=[],e.currentDatabase=null;var r=e.$on("$stateChangeError",function(e,r,a,n,i,o){"notAuthorized"==o&&t.go("login")});e.$on("$destroy",function(){return r})}])}(),/*
 * Licensed under the Apache License, Version 2.0 Copyright 2017 Igor Strykhar,Ivan Kudinov,SMI2 LLC and other contributors
 */
function(e,t){e.module(t.app.name).config(["$stateProvider",function(t){t.state("base",{"abstract":!0,resolve:{session:["$q","API",function(t,r){window.global_tabix_disable_exit=!1,_.isObject(window.global_tabix_default_settings)&&(_.isUndefined(window.global_tabix_default_settings.host)||_.isUndefined(window.global_tabix_default_settings.login)||(window.global_tabix_disable_exit=!0,r.setConnection(window.global_tabix_default_settings)));var a=t.defer();return e.isDefined(r.getConnectionInfo().host)?a.resolve():a.reject("notAuthorized"),a.promise}]},templateUrl:"app/base/base.html"}).state("layout",{parent:"base","abstract":!0,views:{header:{templateUrl:"app/base/header.html",controller:"HeaderController"},sidebar:{templateUrl:"app/base/sidebar.html",controller:"SidebarController"},main:{template:"<ui-view/>"}}}).state("dashboard",{parent:"layout",url:"",controller:["$state",function(e){e.go("sql")}]}).state("login",{url:"/login",templateUrl:"app/login/login.html",controller:"LoginController"}).state("sql",{parent:"layout",url:"/sql",templateUrl:"app/sql/sql.html",controller:"SqlController"}).state("table",{parent:"layout",url:"/database/{dbName}/table/{tableName}",templateUrl:"app/table/table.html",controller:"TableController"}).state("processes",{parent:"layout",url:"/processes",templateUrl:"app/processes/processes.html",controller:"ProcessesController"}).state("metrics",{parent:"layout",url:"/metrics",templateUrl:"app/metrics/metrics.html",controller:"MetricsController"}).state("404",{parent:"layout",templateUrl:"app/base/404.html"})}])}(angular,smi2),/*
 * Licensed under the Apache License, Version 2.0 Copyright 2017 Igor Strykhar,Ivan Kudinov,SMI2 LLC and other contributors
 */
function(e,t){e.module(t.app.name).config(["$locationProvider","$httpProvider","$sceProvider","$urlRouterProvider","$mdThemingProvider","ThemeServiceProvider","$translateProvider",function(e,t,r,a,n,i,o){t.interceptors.push("HttpInterceptor"),r.enabled(!1),a.otherwise(function(e){var t=e.get("$state");t.transitionTo("404")}),i.$get().isDark()&&n.theme("default").dark().primaryPalette("blue").accentPalette("blue",{"default":"500"})}]).config(["$translateProvider",function(e){e.translations("en",{"Подключение":"Connection","Неверные данные":"some data is wrong","Название":"name","Хост:порт":"host:port","Логин":"login","Пароль":"password","Удалить":"Delete","Войти":"Sign in","не найдено":"not found","нет данных":"no data","Назад":"Back","Выход":"Sign out","Шрифт":"Font","История запросов пуста":"Request history is empty","Структура":"Structure","Данные":"Data","Параметры":"Params","Информация":"Information","Размер":"Size","Размер, байт":"Size, bytes","Первая запись":"First record","Последняя запись":"Last record","Тип":"Type","Default тип":"Default type","Значение":"Default value","Рабочий стол":"Dashboard","База":"Database","Выполнить ⌘ + ⏎":"Run ⌘ + ⏎","Таблица":"Table","Таблица ":"Table ","Хотите покинуть страницу?":"Do you want to leave this page?","Ошибка":"Error","Не введен SQL":"SQL query is empty","Выполнить выделенное ⌘ + ⏎":"Run selected ⌘ + ⏎","Выполнить все ⇧ + ⌘ + ⏎":"Run all ⇧ + ⌘ + ⏎","Просмотр":"Preview","Ошибка ":"Error ","Сохранить":"Save","Лог запросов":"Request's log","Тема интерфейса":"Theme","Тема":"Theme","Максимум строк":"Maximum lines","Настройки редактора":"Editor settings","Закрыть":"Close","Размер шрифта":"Font size","Формат результатов":"Result's format","Тема редактора":"Editor theme","Сохранять сессию":"Save session","На весь экран":"Full screen","Словари":"Dictionaries","CSV с заголовком":"CSV with headers","CSV без заголовка":"CSV without headers","Табулированный текст с заголовками":"Tabulated text with headers","Табулированный текст без заголовков":"Tabulated text without headers","время":"time","строк прочитано":"rows read","прочитано":"read","SQL изменен. Сохранить перед закрытием?":"SQL was changed. Save it before exit?","Да":"Yes","Нет":"No","Светлая тема":"Light theme","Темная тема":"Dark theme","с":"from","по":"to","Открыть таблицу":"Open table","Метрики":"Metrics","Метрики и список процессов":"Metrics & Processes","Поиск":"Search","Справка":"Help","Список процессов":"Processes","История зарпросов":"Query log",";; Двойной":";; Double","; Одинарный":"; Single","Разделитель запросов":"Query delimiter","Сборка":"Build","СМИ2":"Smi2","Сервер":"Server",Config:"Config","Config Key":"Config Key","все права защищены":"all rights reserved","Привязка":"Pinned","Обновить":"Refresh","Очистить":"Reset","Максимально точек":"Max points","Частота обновления":"Frequency","сек":"sec","Обновление отключено":"Refresh is disabled","Логирование":"Logs","Перенос строк":"Word wrap","Искать на сервере":"Search on server","Обзор":"Overview"}).translations("ru",{}).useMissingTranslationHandlerLog().registerAvailableLanguageKeys(["en"],{"*":"en"}).determinePreferredLanguage()}])}(angular,smi2);